function showStats(t){function e(t){return Math.max.apply(null,t)}for(var n=[],i=[],r=[],o=[],a="string"==typeof t.speciesCounts?JSON.parse(t.speciesCounts):t.speciesCounts,s="string"==typeof t.groupCounts?JSON.parse(t.groupCounts):t.groupCounts,u=minYear;maxYear>u;u++){if(n.push(u),a.hasOwnProperty(u.toString())){var l=a[u],c=s[u],h=l/c;i.push(h)}else i.push(null);r.push(t.slope*u+t.intercept)}for(var u=minYear;maxYear>u;u++)if(s.hasOwnProperty(u.toString())){var c=s[u];o.push(c)}else o.push(null);var f=e(i),d=e(o);o=o.map(function(t){return f*t/d});var p=maxYear-minYear>100?25:10;new Chartist.Line(".ct-chart",{labels:n,series:[{name:"points",data:i},{name:"line",data:r},{name:"groupLine",data:o}]},{fullWidth:!0,axisX:{labelInterpolationFnc:function(t,e){return e%p===0?t:""},showGrid:!1},low:0,series:{line:{lineSmooth:Chartist.Interpolation.none({fillHoles:!0}),showLine:!0,showArea:!1,showPoint:!1},points:{showLine:!1,showArea:!1,showPoint:!0},groupLine:{lineSmooth:Chartist.Interpolation.none({fillHoles:!0}),showArea:!0,showLine:!1,showPoint:!1}},plugins:[Chartist.plugins.tooltip({})]});if($(".charts").show(),$("#stats").show(),$(".statsHighlight .statsHighlight__year>div").html(Math.round(1e5*t.slope)/100+" ‱"),t.slope<0?$(".statsHighlight .statsHighlight__year").addClass("negative"):$(".statsHighlight .statsHighlight__year").removeClass("negative"),r[0]>0&&r[r.length-1]>0){var m=Math.round(100*r[r.length-1]/r[0]);$(".statsHighlight .statsHighlight__yearspan>div").html(m+" %"),t.slope<0?$(".statsHighlight .statsHighlight__yearspan").addClass("negative"):$(".statsHighlight .statsHighlight__yearspan").removeClass("negative"),$(".statsHighlight .statsHighlight__yearspan").show()}else $(".statsHighlight .statsHighlight__yearspan").hide()}function initMap(){$(".charts").hide(),removeStatLayers(),setStatLayers(key,mapType,hexRadius,yearThreshold),lastClickedPoint&&setTimeout(function(){selectFeatureAtPoint(lastClickedPoint)},500)}function removeStatLayers(){for(var t=0;11>t;t++)map.getLayer("regression-"+t)&&map.removeLayer("regression-"+t);map.getLayer("regression-fill-hover")&&map.removeLayer("regression-fill-hover"),map.getSource("regression")&&map.removeSource("regression")}function setStatLayers(t,e,n,i){removeStatLayers();var r=["#a50f15","#de2d26","#fb6a4a","#fcae91","#fee5d9","#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],e=e||"points",i=i||2,n=n||5,o="regression",a=e,s="points"==e?"circle":"fill",u={"fill-color":"#0F0","fill-opacity":.4},l={"circle-radius":5,"circle-color":"#0F0","circle-opacity":.5},c="http://tiletest.gbif.org/"+t+"/{z}/{x}/{y}/"+e+".pbf?minYear="+minYear+"&maxYear="+maxYear+"&yearThreshold="+i+"&radius="+n;map.addSource("regression",{type:"vector",tiles:[c]}),"fill"==s&&map.addLayer({id:"regression",type:"line",interactive:!0,source:o,"source-layer":a,paint:{"line-color":"#7b7b7b","line-width":.5,"line-opacity":1}}),"circle"==s&&map.addLayer({id:"regression",type:"circle",interactive:!0,source:o,"source-layer":a,paint:{"circle-radius":5,"circle-color":"#888","circle-opacity":.1}});var h=r.reverse().map(function(t,e){return[2e-4*(r.length-6-e),t]});h.forEach(function(t,e){var n={"fill-color":t[1],"fill-opacity":.4},i={"circle-radius":5,"circle-color":t[1],"circle-opacity":.4},r="fill"==s?n:i,u=0==e?[">=","slope",t[0]]:["all",[">=","slope",t[0]],["<","slope",h[e-1][0]]];e==h.length-1&&(u=["<","slope",h[e-1][0]]),map.addLayer({id:"regression-"+e,type:s,interactive:!0,source:o,"source-layer":a,paint:r,filter:u})}),"fill"==s&&map.addLayer({id:"regression-fill-hover",type:"fill",source:o,"source-layer":a,paint:{"fill-color":"#FCA107","fill-opacity":.6},filter:["==","id",""]})}function selectFeatureAtPoint(t){map.getLayer("regression")&&map.featuresAt(t.point,{radius:3,includeGeometry:!0,layer:"regression"},function(t,e){if(!t&&e.length){$("main").removeClass("mapFocus");var n=e[0].properties;showStats(n)}})}function updateMap(t){mapType=t.value,"hex"==mapType?$("#hexSizeCtrl").show():$("#hexSizeCtrl").hide(),initMap(key)}function updateYearThreshold(t){yearThreshold=t.value,initMap()}function updateHexThreshold(t){hexRadius=t.value,initMap()}function updateSpecies(t){key=t.value,initMap()}function customQuery(t){var e=map.unproject(t[1]),n=map.unproject(t[0]),i=Math.min(e.lat,n.lat),r=Math.min(e.lng,n.lng),o=Math.max(e.lat,n.lat),a=Math.max(e.lng,n.lng),s="http://tiletest.gbif.org/"+key+"/regression.json?minLat="+i+"&maxLat="+o+"&minLng="+r+"&maxLng="+a+"&minYear="+minYear+"&maxYear="+maxYear+"&yearThreshold="+yearThreshold;$.ajax(s).done(function(t){console.log(t),showStats(t)}).fail(function(){alert("error in communication with API")})}!function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function n(t){var e=!!t&&"length"in t&&t.length,n=ot.type(t);return"function"===n||ot.isWindow(t)?!1:"array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t}function i(t,e,n){if(ot.isFunction(e))return ot.grep(t,function(t,i){return!!e.call(t,i,t)!==n});if(e.nodeType)return ot.grep(t,function(t){return t===e!==n});if("string"==typeof e){if(mt.test(e))return ot.filter(e,t,n);e=ot.filter(e,t)}return ot.grep(t,function(t){return Q.call(e,t)>-1!==n})}function r(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function o(t){var e={};return ot.each(t.match(bt)||[],function(t,n){e[n]=!0}),e}function a(){W.removeEventListener("DOMContentLoaded",a),t.removeEventListener("load",a),ot.ready()}function s(){this.expando=ot.expando+s.uid++}function u(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(It,"-$&").toLowerCase(),n=t.getAttribute(i),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Dt.test(n)?ot.parseJSON(n):n}catch(r){}Tt.set(t,e,n)}else n=void 0;return n}function l(t,e,n,i){var r,o=1,a=20,s=i?function(){return i.cur()}:function(){return ot.css(t,e,"")},u=s(),l=n&&n[3]||(ot.cssNumber[e]?"":"px"),c=(ot.cssNumber[e]||"px"!==l&&+u)&&At.exec(ot.css(t,e));if(c&&c[3]!==l){l=l||c[3],n=n||[],c=+u||1;do o=o||".5",c/=o,ot.style(t,e,c+l);while(o!==(o=s()/u)&&1!==o&&--a)}return n&&(c=+c||+u||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2],i&&(i.unit=l,i.start=c,i.end=r)),r}function c(t,e){var n="undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e||"*"):"undefined"!=typeof t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&ot.nodeName(t,e)?ot.merge([t],n):n}function h(t,e){for(var n=0,i=t.length;i>n;n++)Et.set(t[n],"globalEval",!e||Et.get(e[n],"globalEval"))}function f(t,e,n,i,r){for(var o,a,s,u,l,f,d=e.createDocumentFragment(),p=[],m=0,v=t.length;v>m;m++)if(o=t[m],o||0===o)if("object"===ot.type(o))ot.merge(p,o.nodeType?[o]:o);else if(Ot.test(o)){for(a=a||d.appendChild(e.createElement("div")),s=(Pt.exec(o)||["",""])[1].toLowerCase(),u=jt[s]||jt._default,a.innerHTML=u[1]+ot.htmlPrefilter(o)+u[2],f=u[0];f--;)a=a.lastChild;ot.merge(p,a.childNodes),a=d.firstChild,a.textContent=""}else p.push(e.createTextNode(o));for(d.textContent="",m=0;o=p[m++];)if(i&&ot.inArray(o,i)>-1)r&&r.push(o);else if(l=ot.contains(o.ownerDocument,o),a=c(d.appendChild(o),"script"),l&&h(a),n)for(f=0;o=a[f++];)Ft.test(o.type||"")&&n.push(o);return d}function d(){return!0}function p(){return!1}function m(){try{return W.activeElement}catch(t){}}function v(t,e,n,i,r,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=void 0);for(s in e)v(t,s,n,i,e[s],o);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),r===!1)r=p;else if(!r)return t;return 1===o&&(a=r,r=function(t){return ot().off(t),a.apply(this,arguments)},r.guid=a.guid||(a.guid=ot.guid++)),t.each(function(){ot.event.add(this,e,r,i,n)})}function y(t,e){return ot.nodeName(t,"table")&&ot.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function g(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function _(t){var e=Ht.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function x(t,e){var n,i,r,o,a,s,u,l;if(1===e.nodeType){if(Et.hasData(t)&&(o=Et.access(t),a=Et.set(e,o),l=o.events)){delete a.handle,a.events={};for(r in l)for(n=0,i=l[r].length;i>n;n++)ot.event.add(e,r,l[r][n])}Tt.hasData(t)&&(s=Tt.access(t),u=ot.extend({},s),Tt.set(e,u))}}function b(t,e){var n=e.nodeName.toLowerCase();"input"===n&&Ct.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function w(t,e,n,i){e=K.apply([],e);var r,o,a,s,u,l,h=0,d=t.length,p=d-1,m=e[0],v=ot.isFunction(m);if(v||d>1&&"string"==typeof m&&!it.checkClone&&Vt.test(m))return t.each(function(r){var o=t.eq(r);v&&(e[0]=m.call(this,r,o.html())),w(o,e,n,i)});if(d&&(r=f(e,t[0].ownerDocument,!1,t,i),o=r.firstChild,1===r.childNodes.length&&(r=o),o||i)){for(a=ot.map(c(r,"script"),g),s=a.length;d>h;h++)u=r,h!==p&&(u=ot.clone(u,!0,!0),s&&ot.merge(a,c(u,"script"))),n.call(t[h],u,h);if(s)for(l=a[a.length-1].ownerDocument,ot.map(a,_),h=0;s>h;h++)u=a[h],Ft.test(u.type||"")&&!Et.access(u,"globalEval")&&ot.contains(l,u)&&(u.src?ot._evalUrl&&ot._evalUrl(u.src):ot.globalEval(u.textContent.replace(Gt,"")))}return t}function S(t,e,n){for(var i,r=e?ot.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||ot.cleanData(c(i)),i.parentNode&&(n&&ot.contains(i.ownerDocument,i)&&h(c(i,"script")),i.parentNode.removeChild(i));return t}function M(t,e){var n=ot(e.createElement(t)).appendTo(e.body),i=ot.css(n[0],"display");return n.detach(),i}function E(t){var e=W,n=Xt[t];return n||(n=M(t,e),"none"!==n&&n||(Yt=(Yt||ot("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=Yt[0].contentDocument,e.write(),e.close(),n=M(t,e),Yt.detach()),Xt[t]=n),n}function T(t,e,n){var i,r,o,a,s=t.style;return n=n||Zt(t),a=n?n.getPropertyValue(e)||n[e]:void 0,""!==a&&void 0!==a||ot.contains(t.ownerDocument,t)||(a=ot.style(t,e)),n&&!it.pixelMarginRight()&&Wt.test(a)&&$t.test(e)&&(i=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=r,s.maxWidth=o),void 0!==a?a+"":a}function D(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function I(t){if(t in ie)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=ne.length;n--;)if(t=ne[n]+e,t in ie)return t}function z(t,e,n){var i=At.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function A(t,e,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===e?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=ot.css(t,n+kt[o],!0,r)),i?("content"===n&&(a-=ot.css(t,"padding"+kt[o],!0,r)),"margin"!==n&&(a-=ot.css(t,"border"+kt[o]+"Width",!0,r))):(a+=ot.css(t,"padding"+kt[o],!0,r),"padding"!==n&&(a+=ot.css(t,"border"+kt[o]+"Width",!0,r)));return a}function k(e,n,i){var r=!0,o="width"===n?e.offsetWidth:e.offsetHeight,a=Zt(e),s="border-box"===ot.css(e,"boxSizing",!1,a);if(W.msFullscreenElement&&t.top!==t&&e.getClientRects().length&&(o=Math.round(100*e.getBoundingClientRect()[n])),0>=o||null==o){if(o=T(e,n,a),(0>o||null==o)&&(o=e.style[n]),Wt.test(o))return o;r=s&&(it.boxSizingReliable()||o===e.style[n]),o=parseFloat(o)||0}return o+A(e,n,i||(s?"border":"content"),r,a)+"px"}function L(t,e){for(var n,i,r,o=[],a=0,s=t.length;s>a;a++)i=t[a],i.style&&(o[a]=Et.get(i,"olddisplay"),n=i.style.display,e?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&Lt(i)&&(o[a]=Et.access(i,"olddisplay",E(i.nodeName)))):(r=Lt(i),"none"===n&&r||Et.set(i,"olddisplay",r?n:ot.css(i,"display"))));for(a=0;s>a;a++)i=t[a],i.style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?o[a]||"":"none"));return t}function C(t,e,n,i,r){return new C.prototype.init(t,e,n,i,r)}function P(){return t.setTimeout(function(){re=void 0}),re=ot.now()}function F(t,e){var n,i=0,r={height:t};for(e=e?1:0;4>i;i+=2-e)n=kt[i],r["margin"+n]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function j(t,e,n){for(var i,r=(N.tweeners[e]||[]).concat(N.tweeners["*"]),o=0,a=r.length;a>o;o++)if(i=r[o].call(n,e,t))return i}function O(t,e,n){var i,r,o,a,s,u,l,c,h=this,f={},d=t.style,p=t.nodeType&&Lt(t),m=Et.get(t,"fxshow");n.queue||(s=ot._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,u=s.empty.fire,s.empty.fire=function(){s.unqueued||u()}),s.unqueued++,h.always(function(){h.always(function(){s.unqueued--,ot.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],l=ot.css(t,"display"),c="none"===l?Et.get(t,"olddisplay")||E(t.nodeName):l,"inline"===c&&"none"===ot.css(t,"float")&&(d.display="inline-block")),n.overflow&&(d.overflow="hidden",h.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(i in e)if(r=e[i],ae.exec(r)){if(delete e[i],o=o||"toggle"===r,r===(p?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;p=!0}f[i]=m&&m[i]||ot.style(t,i)}else l=void 0;if(ot.isEmptyObject(f))"inline"===("none"===l?E(t.nodeName):l)&&(d.display=l);else{m?"hidden"in m&&(p=m.hidden):m=Et.access(t,"fxshow",{}),o&&(m.hidden=!p),p?ot(t).show():h.done(function(){ot(t).hide()}),h.done(function(){var e;Et.remove(t,"fxshow");for(e in f)ot.style(t,e,f[e])});for(i in f)a=j(p?m[i]:0,i,h),i in m||(m[i]=a.start,p&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function R(t,e){var n,i,r,o,a;for(n in t)if(i=ot.camelCase(n),r=e[i],o=t[n],ot.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),a=ot.cssHooks[i],a&&"expand"in a){o=a.expand(o),delete t[i];for(n in o)n in t||(t[n]=o[n],e[n]=r)}else e[i]=r}function N(t,e,n){var i,r,o=0,a=N.prefilters.length,s=ot.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var e=re||P(),n=Math.max(0,l.startTime+l.duration-e),i=n/l.duration||0,o=1-i,a=0,u=l.tweens.length;u>a;a++)l.tweens[a].run(o);return s.notifyWith(t,[l,o,n]),1>o&&u?n:(s.resolveWith(t,[l]),!1)},l=s.promise({elem:t,props:ot.extend({},e),opts:ot.extend(!0,{specialEasing:{},easing:ot.easing._default},n),originalProperties:e,originalOptions:n,startTime:re||P(),duration:n.duration,tweens:[],createTween:function(e,n){var i=ot.Tween(t,l.opts,e,n,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(i),i},stop:function(e){var n=0,i=e?l.tweens.length:0;if(r)return this;for(r=!0;i>n;n++)l.tweens[n].run(1);return e?(s.notifyWith(t,[l,1,0]),s.resolveWith(t,[l,e])):s.rejectWith(t,[l,e]),this}}),c=l.props;for(R(c,l.opts.specialEasing);a>o;o++)if(i=N.prefilters[o].call(l,t,c,l.opts))return ot.isFunction(i.stop)&&(ot._queueHooks(l.elem,l.opts.queue).stop=ot.proxy(i.stop,i)),i;return ot.map(c,j,l),ot.isFunction(l.opts.start)&&l.opts.start.call(t,l),ot.fx.timer(ot.extend(u,{elem:t,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function B(t){return t.getAttribute&&t.getAttribute("class")||""}function q(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(bt)||[];if(ot.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function U(t,e,n,i){function r(s){var u;return o[s]=!0,ot.each(t[s]||[],function(t,s){var l=s(e,n,i);return"string"!=typeof l||a||o[l]?a?!(u=l):void 0:(e.dataTypes.unshift(l),r(l),!1)}),u}var o={},a=t===Te;return r(e.dataTypes[0])||!o["*"]&&r("*")}function V(t,e){var n,i,r=ot.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&ot.extend(!0,t,i),t}function H(t,e,n){for(var i,r,o,a,s=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){u.unshift(r);break}if(u[0]in n)o=u[0];else{for(r in n){if(!u[0]||t.converters[r+" "+u[0]]){o=r;break}a||(a=r)}o=o||a}return o?(o!==u[0]&&u.unshift(o),n[o]):void 0}function G(t,e,n,i){var r,o,a,s,u,l={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)l[a.toLowerCase()]=t.converters[a];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!u&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(a=l[u+" "+o]||l["* "+o],!a)for(r in l)if(s=r.split(" "),s[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){a===!0?a=l[r]:l[r]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(h){return{state:"parsererror",error:a?h:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}function Y(t,e,n,i){var r;if(ot.isArray(e))ot.each(e,function(e,r){n||Ae.test(t)?i(t,r):Y(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)});else if(n||"object"!==ot.type(e))i(t,e);else for(r in e)Y(t+"["+r+"]",e[r],n,i)}function X(t){return ot.isWindow(t)?t:9===t.nodeType&&t.defaultView}var $=[],W=t.document,Z=$.slice,K=$.concat,J=$.push,Q=$.indexOf,tt={},et=tt.toString,nt=tt.hasOwnProperty,it={},rt="2.2.3",ot=function(t,e){return new ot.fn.init(t,e)},at=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,st=/^-ms-/,ut=/-([\da-z])/gi,lt=function(t,e){return e.toUpperCase()};ot.fn=ot.prototype={jquery:rt,constructor:ot,selector:"",length:0,toArray:function(){return Z.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:Z.call(this)},pushStack:function(t){var e=ot.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return ot.each(this,t)},map:function(t){return this.pushStack(ot.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(Z.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:J,sort:$.sort,splice:$.splice},ot.extend=ot.fn.extend=function(){var t,e,n,i,r,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||ot.isFunction(a)||(a={}),s===u&&(a=this,s--);u>s;s++)if(null!=(t=arguments[s]))for(e in t)n=a[e],i=t[e],a!==i&&(l&&i&&(ot.isPlainObject(i)||(r=ot.isArray(i)))?(r?(r=!1,o=n&&ot.isArray(n)?n:[]):o=n&&ot.isPlainObject(n)?n:{},a[e]=ot.extend(l,o,i)):void 0!==i&&(a[e]=i));return a},ot.extend({expando:"jQuery"+(rt+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===ot.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=t&&t.toString();return!ot.isArray(t)&&e-parseFloat(e)+1>=0},isPlainObject:function(t){var e;if("object"!==ot.type(t)||t.nodeType||ot.isWindow(t))return!1;if(t.constructor&&!nt.call(t,"constructor")&&!nt.call(t.constructor.prototype||{},"isPrototypeOf"))return!1;for(e in t);return void 0===e||nt.call(t,e)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?tt[et.call(t)]||"object":typeof t},globalEval:function(t){var e,n=eval;t=ot.trim(t),t&&(1===t.indexOf("use strict")?(e=W.createElement("script"),e.text=t,W.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace(st,"ms-").replace(ut,lt)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var i,r=0;if(n(t))for(i=t.length;i>r&&e.call(t[r],r,t[r])!==!1;r++);else for(r in t)if(e.call(t[r],r,t[r])===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(at,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(n(Object(t))?ot.merge(i,"string"==typeof t?[t]:t):J.call(i,t)),i},inArray:function(t,e,n){return null==e?-1:Q.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;n>i;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i,r=[],o=0,a=t.length,s=!n;a>o;o++)i=!e(t[o],o),i!==s&&r.push(t[o]);return r},map:function(t,e,i){var r,o,a=0,s=[];if(n(t))for(r=t.length;r>a;a++)o=e(t[a],a,i),null!=o&&s.push(o);else for(a in t)o=e(t[a],a,i),null!=o&&s.push(o);return K.apply([],s)},guid:1,proxy:function(t,e){var n,i,r;return"string"==typeof e&&(n=t[e],e=t,t=n),ot.isFunction(t)?(i=Z.call(arguments,2),r=function(){return t.apply(e||this,i.concat(Z.call(arguments)))},r.guid=t.guid=t.guid||ot.guid++,r):void 0},now:Date.now,support:it}),"function"==typeof Symbol&&(ot.fn[Symbol.iterator]=$[Symbol.iterator]),ot.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){tt["[object "+e+"]"]=e.toLowerCase()});var ct=function(t){function e(t,e,n,i){var r,o,a,s,u,l,h,d,p=e&&e.ownerDocument,m=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==m&&9!==m&&11!==m)return n;if(!i&&((e?e.ownerDocument||e:B)!==L&&k(e),e=e||L,P)){if(11!==m&&(l=yt.exec(t)))if(r=l[1]){if(9===m){if(!(a=e.getElementById(r)))return n;if(a.id===r)return n.push(a),n}else if(p&&(a=p.getElementById(r))&&R(e,a)&&a.id===r)return n.push(a),n}else{if(l[2])return J.apply(n,e.getElementsByTagName(t)),n;if((r=l[3])&&b.getElementsByClassName&&e.getElementsByClassName)return J.apply(n,e.getElementsByClassName(r)),n}if(b.qsa&&!G[t+" "]&&(!F||!F.test(t))){if(1!==m)p=e,d=t;else if("object"!==e.nodeName.toLowerCase()){for((s=e.getAttribute("id"))?s=s.replace(_t,"\\$&"):e.setAttribute("id",s=N),h=E(t),o=h.length,u=ft.test(s)?"#"+s:"[id='"+s+"']";o--;)h[o]=u+" "+f(h[o]);d=h.join(","),p=gt.test(t)&&c(e.parentNode)||e}if(d)try{return J.apply(n,p.querySelectorAll(d)),n}catch(v){}finally{s===N&&e.removeAttribute("id")}}}return D(t.replace(st,"$1"),e,n,i)}function n(){function t(n,i){return e.push(n+" ")>w.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function i(t){return t[N]=!0,t}function r(t){var e=L.createElement("div");try{return!!t(e)}catch(n){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var n=t.split("|"),i=n.length;i--;)w.attrHandle[n[i]]=e}function a(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||X)-(~t.sourceIndex||X);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function s(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function u(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function l(t){return i(function(e){return e=+e,i(function(n,i){for(var r,o=t([],n.length,e),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))})})}function c(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function h(){}function f(t){for(var e=0,n=t.length,i="";n>e;e++)i+=t[e].value;return i}function d(t,e,n){var i=e.dir,r=n&&"parentNode"===i,o=U++;return e.first?function(e,n,o){for(;e=e[i];)if(1===e.nodeType||r)return t(e,n,o)}:function(e,n,a){var s,u,l,c=[q,o];if(a){for(;e=e[i];)if((1===e.nodeType||r)&&t(e,n,a))return!0}else for(;e=e[i];)if(1===e.nodeType||r){if(l=e[N]||(e[N]={}),u=l[e.uniqueID]||(l[e.uniqueID]={}),(s=u[i])&&s[0]===q&&s[1]===o)return c[2]=s[2];if(u[i]=c,c[2]=t(e,n,a))return!0}}}function p(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function m(t,n,i){for(var r=0,o=n.length;o>r;r++)e(t,n[r],i);return i}function v(t,e,n,i,r){for(var o,a=[],s=0,u=t.length,l=null!=e;u>s;s++)(o=t[s])&&(n&&!n(o,i,r)||(a.push(o),l&&e.push(s)));return a}function y(t,e,n,r,o,a){return r&&!r[N]&&(r=y(r)),o&&!o[N]&&(o=y(o,a)),i(function(i,a,s,u){var l,c,h,f=[],d=[],p=a.length,y=i||m(e||"*",s.nodeType?[s]:s,[]),g=!t||!i&&e?y:v(y,f,t,s,u),_=n?o||(i?t:p||r)?[]:a:g;if(n&&n(g,_,s,u),r)for(l=v(_,d),r(l,[],s,u),c=l.length;c--;)(h=l[c])&&(_[d[c]]=!(g[d[c]]=h));if(i){if(o||t){if(o){for(l=[],c=_.length;c--;)(h=_[c])&&l.push(g[c]=h);o(null,_=[],l,u)}for(c=_.length;c--;)(h=_[c])&&(l=o?tt(i,h):f[c])>-1&&(i[l]=!(a[l]=h))}}else _=v(_===a?_.splice(p,_.length):_),o?o(null,a,_,u):J.apply(a,_)})}function g(t){for(var e,n,i,r=t.length,o=w.relative[t[0].type],a=o||w.relative[" "],s=o?1:0,u=d(function(t){return t===e},a,!0),l=d(function(t){return tt(e,t)>-1},a,!0),c=[function(t,n,i){var r=!o&&(i||n!==I)||((e=n).nodeType?u(t,n,i):l(t,n,i));return e=null,r}];r>s;s++)if(n=w.relative[t[s].type])c=[d(p(c),n)];else{if(n=w.filter[t[s].type].apply(null,t[s].matches),n[N]){for(i=++s;r>i&&!w.relative[t[i].type];i++);return y(s>1&&p(c),s>1&&f(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(st,"$1"),n,i>s&&g(t.slice(s,i)),r>i&&g(t=t.slice(i)),r>i&&f(t))}c.push(n)}return p(c)}function _(t,n){var r=n.length>0,o=t.length>0,a=function(i,a,s,u,l){var c,h,f,d=0,p="0",m=i&&[],y=[],g=I,_=i||o&&w.find.TAG("*",l),x=q+=null==g?1:Math.random()||.1,b=_.length;for(l&&(I=a===L||a||l);p!==b&&null!=(c=_[p]);p++){if(o&&c){for(h=0,a||c.ownerDocument===L||(k(c),s=!P);f=t[h++];)if(f(c,a||L,s)){u.push(c);break}l&&(q=x)}r&&((c=!f&&c)&&d--,i&&m.push(c))}if(d+=p,r&&p!==d){for(h=0;f=n[h++];)f(m,y,a,s);if(i){if(d>0)for(;p--;)m[p]||y[p]||(y[p]=Z.call(u));y=v(y)}J.apply(u,y),l&&!i&&y.length>0&&d+n.length>1&&e.uniqueSort(u)}return l&&(q=x,I=g),m};return r?i(a):a}var x,b,w,S,M,E,T,D,I,z,A,k,L,C,P,F,j,O,R,N="sizzle"+1*new Date,B=t.document,q=0,U=0,V=n(),H=n(),G=n(),Y=function(t,e){return t===e&&(A=!0),0},X=1<<31,$={}.hasOwnProperty,W=[],Z=W.pop,K=W.push,J=W.push,Q=W.slice,tt=function(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",rt="\\["+nt+"*("+it+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+it+"))|)"+nt+"*\\]",ot=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+rt+")*)|.*)\\)|)",at=new RegExp(nt+"+","g"),st=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ut=new RegExp("^"+nt+"*,"+nt+"*"),lt=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),ct=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),ht=new RegExp(ot),ft=new RegExp("^"+it+"$"),dt={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it+"|[*])"),ATTR:new RegExp("^"+rt),PSEUDO:new RegExp("^"+ot),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},pt=/^(?:input|select|textarea|button)$/i,mt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,yt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,gt=/[+~]/,_t=/'|\\/g,xt=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),bt=function(t,e,n){var i="0x"+e-65536;return i!==i||n?e:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},wt=function(){k()};try{J.apply(W=Q.call(B.childNodes),B.childNodes),W[B.childNodes.length].nodeType}catch(St){J={apply:W.length?function(t,e){K.apply(t,Q.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}b=e.support={},M=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},k=e.setDocument=function(t){var e,n,i=t?t.ownerDocument||t:B;return i!==L&&9===i.nodeType&&i.documentElement?(L=i,C=L.documentElement,P=!M(L),(n=L.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",wt,!1):n.attachEvent&&n.attachEvent("onunload",wt)),b.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),b.getElementsByTagName=r(function(t){return t.appendChild(L.createComment("")),!t.getElementsByTagName("*").length}),b.getElementsByClassName=vt.test(L.getElementsByClassName),b.getById=r(function(t){return C.appendChild(t).id=N,!L.getElementsByName||!L.getElementsByName(N).length}),b.getById?(w.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&P){var n=e.getElementById(t);return n?[n]:[]}},w.filter.ID=function(t){var e=t.replace(xt,bt);return function(t){return t.getAttribute("id")===e}}):(delete w.find.ID,w.filter.ID=function(t){var e=t.replace(xt,bt);return function(t){var n="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}}),w.find.TAG=b.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):b.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},w.find.CLASS=b.getElementsByClassName&&function(t,e){return"undefined"!=typeof e.getElementsByClassName&&P?e.getElementsByClassName(t):void 0},j=[],F=[],(b.qsa=vt.test(L.querySelectorAll))&&(r(function(t){C.appendChild(t).innerHTML="<a id='"+N+"'></a><select id='"+N+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&F.push("[*^$]="+nt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||F.push("\\["+nt+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+N+"-]").length||F.push("~="),t.querySelectorAll(":checked").length||F.push(":checked"),t.querySelectorAll("a#"+N+"+*").length||F.push(".#.+[+~]")}),r(function(t){var e=L.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&F.push("name"+nt+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),F.push(",.*:")})),(b.matchesSelector=vt.test(O=C.matches||C.webkitMatchesSelector||C.mozMatchesSelector||C.oMatchesSelector||C.msMatchesSelector))&&r(function(t){b.disconnectedMatch=O.call(t,"div"),O.call(t,"[s!='']:x"),j.push("!=",ot)}),F=F.length&&new RegExp(F.join("|")),j=j.length&&new RegExp(j.join("|")),e=vt.test(C.compareDocumentPosition),R=e||vt.test(C.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},Y=e?function(t,e){if(t===e)return A=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n?n:(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!b.sortDetached&&e.compareDocumentPosition(t)===n?t===L||t.ownerDocument===B&&R(B,t)?-1:e===L||e.ownerDocument===B&&R(B,e)?1:z?tt(z,t)-tt(z,e):0:4&n?-1:1)}:function(t,e){if(t===e)return A=!0,0;var n,i=0,r=t.parentNode,o=e.parentNode,s=[t],u=[e];if(!r||!o)return t===L?-1:e===L?1:r?-1:o?1:z?tt(z,t)-tt(z,e):0;if(r===o)return a(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)u.unshift(n);for(;s[i]===u[i];)i++;return i?a(s[i],u[i]):s[i]===B?-1:u[i]===B?1:0},L):L},e.matches=function(t,n){return e(t,null,null,n)},e.matchesSelector=function(t,n){if((t.ownerDocument||t)!==L&&k(t),n=n.replace(ct,"='$1']"),b.matchesSelector&&P&&!G[n+" "]&&(!j||!j.test(n))&&(!F||!F.test(n)))try{var i=O.call(t,n);if(i||b.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(r){}return e(n,L,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==L&&k(t),R(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==L&&k(t);var n=w.attrHandle[e.toLowerCase()],i=n&&$.call(w.attrHandle,e.toLowerCase())?n(t,e,!P):void 0;return void 0!==i?i:b.attributes||!P?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,n=[],i=0,r=0;if(A=!b.detectDuplicates,z=!b.sortStable&&t.slice(0),t.sort(Y),A){for(;e=t[r++];)e===t[r]&&(i=n.push(r));for(;i--;)t.splice(n[i],1)}return z=null,t},S=e.getText=function(t){var e,n="",i=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=S(t);
}else if(3===r||4===r)return t.nodeValue}else for(;e=t[i++];)n+=S(e);return n},w=e.selectors={cacheLength:50,createPseudo:i,match:dt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(xt,bt),t[3]=(t[3]||t[4]||t[5]||"").replace(xt,bt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return dt.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&ht.test(n)&&(e=E(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(xt,bt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=V[t+" "];return e||(e=new RegExp("(^|"+nt+")"+t+"("+nt+"|$)"))&&V(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,n,i){return function(r){var o=e.attr(r,t);return null==o?"!="===n:n?(o+="","="===n?o===i:"!="===n?o!==i:"^="===n?i&&0===o.indexOf(i):"*="===n?i&&o.indexOf(i)>-1:"$="===n?i&&o.slice(-i.length)===i:"~="===n?(" "+o.replace(at," ")+" ").indexOf(i)>-1:"|="===n?o===i||o.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,u){var l,c,h,f,d,p,m=o!==a?"nextSibling":"previousSibling",v=e.parentNode,y=s&&e.nodeName.toLowerCase(),g=!u&&!s,_=!1;if(v){if(o){for(;m;){for(f=e;f=f[m];)if(s?f.nodeName.toLowerCase()===y:1===f.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?v.firstChild:v.lastChild],a&&g){for(f=v,h=f[N]||(f[N]={}),c=h[f.uniqueID]||(h[f.uniqueID]={}),l=c[t]||[],d=l[0]===q&&l[1],_=d&&l[2],f=d&&v.childNodes[d];f=++d&&f&&f[m]||(_=d=0)||p.pop();)if(1===f.nodeType&&++_&&f===e){c[t]=[q,d,_];break}}else if(g&&(f=e,h=f[N]||(f[N]={}),c=h[f.uniqueID]||(h[f.uniqueID]={}),l=c[t]||[],d=l[0]===q&&l[1],_=d),_===!1)for(;(f=++d&&f&&f[m]||(_=d=0)||p.pop())&&((s?f.nodeName.toLowerCase()!==y:1!==f.nodeType)||!++_||(g&&(h=f[N]||(f[N]={}),c=h[f.uniqueID]||(h[f.uniqueID]={}),c[t]=[q,_]),f!==e)););return _-=r,_===i||_%i===0&&_/i>=0}}},PSEUDO:function(t,n){var r,o=w.pseudos[t]||w.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[N]?o(n):o.length>1?(r=[t,t,"",n],w.setFilters.hasOwnProperty(t.toLowerCase())?i(function(t,e){for(var i,r=o(t,n),a=r.length;a--;)i=tt(t,r[a]),t[i]=!(e[i]=r[a])}):function(t){return o(t,0,r)}):o}},pseudos:{not:i(function(t){var e=[],n=[],r=T(t.replace(st,"$1"));return r[N]?i(function(t,e,n,i){for(var o,a=r(t,null,i,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,i,o){return e[0]=t,r(e,null,o,n),e[0]=null,!n.pop()}}),has:i(function(t){return function(n){return e(t,n).length>0}}),contains:i(function(t){return t=t.replace(xt,bt),function(e){return(e.textContent||e.innerText||S(e)).indexOf(t)>-1}}),lang:i(function(t){return ft.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(xt,bt).toLowerCase(),function(e){var n;do if(n=P?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return n=n.toLowerCase(),n===t||0===n.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===C},focus:function(t){return t===L.activeElement&&(!L.hasFocus||L.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!w.pseudos.empty(t)},header:function(t){return mt.test(t.nodeName)},input:function(t){return pt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:l(function(){return[0]}),last:l(function(t,e){return[e-1]}),eq:l(function(t,e,n){return[0>n?n+e:n]}),even:l(function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t}),odd:l(function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t}),lt:l(function(t,e,n){for(var i=0>n?n+e:n;--i>=0;)t.push(i);return t}),gt:l(function(t,e,n){for(var i=0>n?n+e:n;++i<e;)t.push(i);return t})}},w.pseudos.nth=w.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[x]=s(x);for(x in{submit:!0,reset:!0})w.pseudos[x]=u(x);return h.prototype=w.filters=w.pseudos,w.setFilters=new h,E=e.tokenize=function(t,n){var i,r,o,a,s,u,l,c=H[t+" "];if(c)return n?0:c.slice(0);for(s=t,u=[],l=w.preFilter;s;){i&&!(r=ut.exec(s))||(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),i=!1,(r=lt.exec(s))&&(i=r.shift(),o.push({value:i,type:r[0].replace(st," ")}),s=s.slice(i.length));for(a in w.filter)!(r=dt[a].exec(s))||l[a]&&!(r=l[a](r))||(i=r.shift(),o.push({value:i,type:a,matches:r}),s=s.slice(i.length));if(!i)break}return n?s.length:s?e.error(t):H(t,u).slice(0)},T=e.compile=function(t,e){var n,i=[],r=[],o=G[t+" "];if(!o){for(e||(e=E(t)),n=e.length;n--;)o=g(e[n]),o[N]?i.push(o):r.push(o);o=G(t,_(r,i)),o.selector=t}return o},D=e.select=function(t,e,n,i){var r,o,a,s,u,l="function"==typeof t&&t,h=!i&&E(t=l.selector||t);if(n=n||[],1===h.length){if(o=h[0]=h[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&b.getById&&9===e.nodeType&&P&&w.relative[o[1].type]){if(e=(w.find.ID(a.matches[0].replace(xt,bt),e)||[])[0],!e)return n;l&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=dt.needsContext.test(t)?0:o.length;r--&&(a=o[r],!w.relative[s=a.type]);)if((u=w.find[s])&&(i=u(a.matches[0].replace(xt,bt),gt.test(o[0].type)&&c(e.parentNode)||e))){if(o.splice(r,1),t=i.length&&f(o),!t)return J.apply(n,i),n;break}}return(l||T(t,h))(i,e,!P,n,!e||gt.test(t)&&c(e.parentNode)||e),n},b.sortStable=N.split("").sort(Y).join("")===N,b.detectDuplicates=!!A,k(),b.sortDetached=r(function(t){return 1&t.compareDocumentPosition(L.createElement("div"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,n){return n?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),b.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,n){return n||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(et,function(t,e,n){var i;return n?void 0:t[e]===!0?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),e}(t);ot.find=ct,ot.expr=ct.selectors,ot.expr[":"]=ot.expr.pseudos,ot.uniqueSort=ot.unique=ct.uniqueSort,ot.text=ct.getText,ot.isXMLDoc=ct.isXML,ot.contains=ct.contains;var ht=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&ot(t).is(n))break;i.push(t)}return i},ft=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},dt=ot.expr.match.needsContext,pt=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,mt=/^.[^:#\[\.,]*$/;ot.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?ot.find.matchesSelector(i,t)?[i]:[]:ot.find.matches(t,ot.grep(e,function(t){return 1===t.nodeType}))},ot.fn.extend({find:function(t){var e,n=this.length,i=[],r=this;if("string"!=typeof t)return this.pushStack(ot(t).filter(function(){for(e=0;n>e;e++)if(ot.contains(r[e],this))return!0}));for(e=0;n>e;e++)ot.find(t,r[e],i);return i=this.pushStack(n>1?ot.unique(i):i),i.selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(i(this,t||[],!1))},not:function(t){return this.pushStack(i(this,t||[],!0))},is:function(t){return!!i(this,"string"==typeof t&&dt.test(t)?ot(t):t||[],!1).length}});var vt,yt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,gt=ot.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||vt,"string"==typeof t){if(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:yt.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof ot?e[0]:e,ot.merge(this,ot.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:W,!0)),pt.test(i[1])&&ot.isPlainObject(e))for(i in e)ot.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return r=W.getElementById(i[2]),r&&r.parentNode&&(this.length=1,this[0]=r),this.context=W,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):ot.isFunction(t)?void 0!==n.ready?n.ready(t):t(ot):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),ot.makeArray(t,this))};gt.prototype=ot.fn,vt=ot(W);var _t=/^(?:parents|prev(?:Until|All))/,xt={children:!0,contents:!0,next:!0,prev:!0};ot.fn.extend({has:function(t){var e=ot(t,this),n=e.length;return this.filter(function(){for(var t=0;n>t;t++)if(ot.contains(this,e[t]))return!0})},closest:function(t,e){for(var n,i=0,r=this.length,o=[],a=dt.test(t)||"string"!=typeof t?ot(t,e||this.context):0;r>i;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&ot.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?ot.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?Q.call(ot(t),this[0]):Q.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(ot.uniqueSort(ot.merge(this.get(),ot(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),ot.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return ht(t,"parentNode")},parentsUntil:function(t,e,n){return ht(t,"parentNode",n)},next:function(t){return r(t,"nextSibling")},prev:function(t){return r(t,"previousSibling")},nextAll:function(t){return ht(t,"nextSibling")},prevAll:function(t){return ht(t,"previousSibling")},nextUntil:function(t,e,n){return ht(t,"nextSibling",n)},prevUntil:function(t,e,n){return ht(t,"previousSibling",n)},siblings:function(t){return ft((t.parentNode||{}).firstChild,t)},children:function(t){return ft(t.firstChild)},contents:function(t){return t.contentDocument||ot.merge([],t.childNodes)}},function(t,e){ot.fn[t]=function(n,i){var r=ot.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=ot.filter(i,r)),this.length>1&&(xt[t]||ot.uniqueSort(r),_t.test(t)&&r.reverse()),this.pushStack(r)}});var bt=/\S+/g;ot.Callbacks=function(t){t="string"==typeof t?o(t):ot.extend({},t);var e,n,i,r,a=[],s=[],u=-1,l=function(){for(r=t.once,i=e=!0;s.length;u=-1)for(n=s.shift();++u<a.length;)a[u].apply(n[0],n[1])===!1&&t.stopOnFalse&&(u=a.length,n=!1);t.memory||(n=!1),e=!1,r&&(a=n?[]:"")},c={add:function(){return a&&(n&&!e&&(u=a.length-1,s.push(n)),function i(e){ot.each(e,function(e,n){ot.isFunction(n)?t.unique&&c.has(n)||a.push(n):n&&n.length&&"string"!==ot.type(n)&&i(n)})}(arguments),n&&!e&&l()),this},remove:function(){return ot.each(arguments,function(t,e){for(var n;(n=ot.inArray(e,a,n))>-1;)a.splice(n,1),u>=n&&u--}),this},has:function(t){return t?ot.inArray(t,a)>-1:a.length>0},empty:function(){return a&&(a=[]),this},disable:function(){return r=s=[],a=n="",this},disabled:function(){return!a},lock:function(){return r=s=[],n||(a=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=n||[],n=[t,n.slice?n.slice():n],s.push(n),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},ot.extend({Deferred:function(t){var e=[["resolve","done",ot.Callbacks("once memory"),"resolved"],["reject","fail",ot.Callbacks("once memory"),"rejected"],["notify","progress",ot.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return ot.Deferred(function(n){ot.each(e,function(e,o){var a=ot.isFunction(t[e])&&t[e];r[o[1]](function(){var t=a&&a.apply(this,arguments);t&&ot.isFunction(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[o[0]+"With"](this===i?n.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?ot.extend(t,i):i}},r={};return i.pipe=i.then,ot.each(e,function(t,o){var a=o[2],s=o[3];i[o[1]]=a.add,s&&a.add(function(){n=s},e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=a.fireWith}),i.promise(r),t&&t.call(r,r),r},when:function(t){var e,n,i,r=0,o=Z.call(arguments),a=o.length,s=1!==a||t&&ot.isFunction(t.promise)?a:0,u=1===s?t:ot.Deferred(),l=function(t,n,i){return function(r){n[t]=this,i[t]=arguments.length>1?Z.call(arguments):r,i===e?u.notifyWith(n,i):--s||u.resolveWith(n,i)}};if(a>1)for(e=new Array(a),n=new Array(a),i=new Array(a);a>r;r++)o[r]&&ot.isFunction(o[r].promise)?o[r].promise().progress(l(r,n,e)).done(l(r,i,o)).fail(u.reject):--s;return s||u.resolveWith(i,o),u.promise()}});var wt;ot.fn.ready=function(t){return ot.ready.promise().done(t),this},ot.extend({isReady:!1,readyWait:1,holdReady:function(t){t?ot.readyWait++:ot.ready(!0)},ready:function(t){(t===!0?--ot.readyWait:ot.isReady)||(ot.isReady=!0,t!==!0&&--ot.readyWait>0||(wt.resolveWith(W,[ot]),ot.fn.triggerHandler&&(ot(W).triggerHandler("ready"),ot(W).off("ready"))))}}),ot.ready.promise=function(e){return wt||(wt=ot.Deferred(),"complete"===W.readyState||"loading"!==W.readyState&&!W.documentElement.doScroll?t.setTimeout(ot.ready):(W.addEventListener("DOMContentLoaded",a),t.addEventListener("load",a))),wt.promise(e)},ot.ready.promise();var St=function(t,e,n,i,r,o,a){var s=0,u=t.length,l=null==n;if("object"===ot.type(n)){r=!0;for(s in n)St(t,e,s,n[s],!0,o,a)}else if(void 0!==i&&(r=!0,ot.isFunction(i)||(a=!0),l&&(a?(e.call(t,i),e=null):(l=e,e=function(t,e,n){return l.call(ot(t),n)})),e))for(;u>s;s++)e(t[s],n,a?i:i.call(t[s],s,e(t[s],n)));return r?t:l?e.call(t):u?e(t[0],n):o},Mt=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};s.uid=1,s.prototype={register:function(t,e){var n=e||{};return t.nodeType?t[this.expando]=n:Object.defineProperty(t,this.expando,{value:n,writable:!0,configurable:!0}),t[this.expando]},cache:function(t){if(!Mt(t))return{};var e=t[this.expando];return e||(e={},Mt(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[e]=n;else for(i in e)r[i]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][e]},access:function(t,e,n){var i;return void 0===e||e&&"string"==typeof e&&void 0===n?(i=this.get(t,e),void 0!==i?i:this.get(t,ot.camelCase(e))):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i,r,o=t[this.expando];if(void 0!==o){if(void 0===e)this.register(t);else{ot.isArray(e)?i=e.concat(e.map(ot.camelCase)):(r=ot.camelCase(e),e in o?i=[e,r]:(i=r,i=i in o?[i]:i.match(bt)||[])),n=i.length;for(;n--;)delete o[i[n]]}(void 0===e||ot.isEmptyObject(o))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!ot.isEmptyObject(e)}};var Et=new s,Tt=new s,Dt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,It=/[A-Z]/g;ot.extend({hasData:function(t){return Tt.hasData(t)||Et.hasData(t)},data:function(t,e,n){return Tt.access(t,e,n)},removeData:function(t,e){Tt.remove(t,e)},_data:function(t,e,n){return Et.access(t,e,n)},_removeData:function(t,e){Et.remove(t,e)}}),ot.fn.extend({data:function(t,e){var n,i,r,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(r=Tt.get(o),1===o.nodeType&&!Et.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&(i=a[n].name,0===i.indexOf("data-")&&(i=ot.camelCase(i.slice(5)),u(o,i,r[i])));Et.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){Tt.set(this,t)}):St(this,function(e){var n,i;if(o&&void 0===e){if(n=Tt.get(o,t)||Tt.get(o,t.replace(It,"-$&").toLowerCase()),void 0!==n)return n;if(i=ot.camelCase(t),n=Tt.get(o,i),void 0!==n)return n;if(n=u(o,i,void 0),void 0!==n)return n}else i=ot.camelCase(t),this.each(function(){var n=Tt.get(this,i);Tt.set(this,i,e),t.indexOf("-")>-1&&void 0!==n&&Tt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){Tt.remove(this,t)})}}),ot.extend({queue:function(t,e,n){var i;return t?(e=(e||"fx")+"queue",i=Et.get(t,e),n&&(!i||ot.isArray(n)?i=Et.access(t,e,ot.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(t,e){e=e||"fx";var n=ot.queue(t,e),i=n.length,r=n.shift(),o=ot._queueHooks(t,e),a=function(){ot.dequeue(t,e)};"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,a,o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Et.get(t,n)||Et.access(t,n,{empty:ot.Callbacks("once memory").add(function(){Et.remove(t,[e+"queue",n])})})}}),ot.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?ot.queue(this[0],t):void 0===e?this:this.each(function(){var n=ot.queue(this,t,e);ot._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&ot.dequeue(this,t)})},dequeue:function(t){return this.each(function(){ot.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=ot.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)n=Et.get(o[a],t+"queueHooks"),n&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(e)}});var zt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,At=new RegExp("^(?:([+-])=|)("+zt+")([a-z%]*)$","i"),kt=["Top","Right","Bottom","Left"],Lt=function(t,e){return t=e||t,"none"===ot.css(t,"display")||!ot.contains(t.ownerDocument,t)},Ct=/^(?:checkbox|radio)$/i,Pt=/<([\w:-]+)/,Ft=/^$|\/(?:java|ecma)script/i,jt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};jt.optgroup=jt.option,jt.tbody=jt.tfoot=jt.colgroup=jt.caption=jt.thead,jt.th=jt.td;var Ot=/<|&#?\w+;/;!function(){var t=W.createDocumentFragment(),e=t.appendChild(W.createElement("div")),n=W.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),e.appendChild(n),it.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",it.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var Rt=/^key/,Nt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Bt=/^([^.]*)(?:\.(.+)|)/;ot.event={global:{},add:function(t,e,n,i,r){var o,a,s,u,l,c,h,f,d,p,m,v=Et.get(t);if(v)for(n.handler&&(o=n,n=o.handler,r=o.selector),n.guid||(n.guid=ot.guid++),(u=v.events)||(u=v.events={}),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof ot&&ot.event.triggered!==e.type?ot.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(bt)||[""],l=e.length;l--;)s=Bt.exec(e[l])||[],d=m=s[1],p=(s[2]||"").split(".").sort(),d&&(h=ot.event.special[d]||{},d=(r?h.delegateType:h.bindType)||d,h=ot.event.special[d]||{},c=ot.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&ot.expr.match.needsContext.test(r),namespace:p.join(".")},o),(f=u[d])||(f=u[d]=[],f.delegateCount=0,h.setup&&h.setup.call(t,i,p,a)!==!1||t.addEventListener&&t.addEventListener(d,a)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),r?f.splice(f.delegateCount++,0,c):f.push(c),ot.event.global[d]=!0)},remove:function(t,e,n,i,r){var o,a,s,u,l,c,h,f,d,p,m,v=Et.hasData(t)&&Et.get(t);if(v&&(u=v.events)){for(e=(e||"").match(bt)||[""],l=e.length;l--;)if(s=Bt.exec(e[l])||[],d=m=s[1],p=(s[2]||"").split(".").sort(),d){for(h=ot.event.special[d]||{},d=(i?h.delegateType:h.bindType)||d,f=u[d]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=f.length;o--;)c=f[o],!r&&m!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(f.splice(o,1),c.selector&&f.delegateCount--,h.remove&&h.remove.call(t,c));a&&!f.length&&(h.teardown&&h.teardown.call(t,p,v.handle)!==!1||ot.removeEvent(t,d,v.handle),delete u[d])}else for(d in u)ot.event.remove(t,d+e[l],n,i,!0);ot.isEmptyObject(u)&&Et.remove(t,"handle events")}},dispatch:function(t){t=ot.event.fix(t);var e,n,i,r,o,a=[],s=Z.call(arguments),u=(Et.get(this,"events")||{})[t.type]||[],l=ot.event.special[t.type]||{};if(s[0]=t,t.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,t)!==!1){for(a=ot.event.handlers.call(this,t,u),e=0;(r=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(o.namespace)||(t.handleObj=o,t.data=o.data,i=((ot.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s),void 0!==i&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,i,r,o,a=[],s=e.delegateCount,u=t.target;if(s&&u.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&(u.disabled!==!0||"click"!==t.type)){for(i=[],n=0;s>n;n++)o=e[n],r=o.selector+" ",void 0===i[r]&&(i[r]=o.needsContext?ot(r,this).index(u)>-1:ot.find(r,this,null,[u]).length),i[r]&&i.push(o);i.length&&a.push({elem:u,handlers:i})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,i,r,o=e.button;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||W,i=n.documentElement,r=n.body,t.pageX=e.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),t.pageY=e.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},fix:function(t){if(t[ot.expando])return t;var e,n,i,r=t.type,o=t,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=Nt.test(r)?this.mouseHooks:Rt.test(r)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,t=new ot.Event(o),e=i.length;e--;)n=i[e],t[n]=o[n];return t.target||(t.target=W),3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==m()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===m()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&ot.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return ot.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},ot.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},ot.Event=function(t,e){return this instanceof ot.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?d:p):this.type=t,e&&ot.extend(this,e),this.timeStamp=t&&t.timeStamp||ot.now(),void(this[ot.expando]=!0)):new ot.Event(t,e)},ot.Event.prototype={constructor:ot.Event,isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=d,t&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=d,t&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=d,t&&t.stopImmediatePropagation(),this.stopPropagation()}},ot.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){ot.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===i||ot.contains(i,r))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}}),ot.fn.extend({on:function(t,e,n,i){return v(this,t,e,n,i)},one:function(t,e,n,i){return v(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,ot(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return e!==!1&&"function"!=typeof e||(n=e,e=void 0),n===!1&&(n=p),this.each(function(){ot.event.remove(this,t,n,e)})}});var qt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Ut=/<script|<style|<link/i,Vt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ht=/^true\/(.*)/,Gt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;ot.extend({htmlPrefilter:function(t){return t.replace(qt,"<$1></$2>")},clone:function(t,e,n){var i,r,o,a,s=t.cloneNode(!0),u=ot.contains(t.ownerDocument,t);if(!(it.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||ot.isXMLDoc(t)))for(a=c(s),o=c(t),i=0,r=o.length;r>i;i++)b(o[i],a[i]);if(e)if(n)for(o=o||c(t),a=a||c(s),i=0,r=o.length;r>i;i++)x(o[i],a[i]);else x(t,s);return a=c(s,"script"),a.length>0&&h(a,!u&&c(t,"script")),s},cleanData:function(t){for(var e,n,i,r=ot.event.special,o=0;void 0!==(n=t[o]);o++)if(Mt(n)){if(e=n[Et.expando]){if(e.events)for(i in e.events)r[i]?ot.event.remove(n,i):ot.removeEvent(n,i,e.handle);n[Et.expando]=void 0}n[Tt.expando]&&(n[Tt.expando]=void 0)}}}),ot.fn.extend({domManip:w,detach:function(t){return S(this,t,!0)},remove:function(t){return S(this,t)},text:function(t){return St(this,function(t){return void 0===t?ot.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return w(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=y(this,t);e.appendChild(t)}})},prepend:function(){return w(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=y(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return w(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return w(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(ot.cleanData(c(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return ot.clone(this,t,e)})},html:function(t){return St(this,function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Ut.test(t)&&!jt[(Pt.exec(t)||["",""])[1].toLowerCase()]){t=ot.htmlPrefilter(t);try{for(;i>n;n++)e=this[n]||{},1===e.nodeType&&(ot.cleanData(c(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return w(this,arguments,function(e){var n=this.parentNode;ot.inArray(this,t)<0&&(ot.cleanData(c(this)),n&&n.replaceChild(e,this))},t)}}),ot.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){ot.fn[t]=function(t){for(var n,i=[],r=ot(t),o=r.length-1,a=0;o>=a;a++)n=a===o?this:this.clone(!0),ot(r[a])[e](n),J.apply(i,n.get());return this.pushStack(i)}});var Yt,Xt={HTML:"block",BODY:"block"},$t=/^margin/,Wt=new RegExp("^("+zt+")(?!px)[a-z%]+$","i"),Zt=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)},Kt=function(t,e,n,i){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];r=n.apply(t,i||[]);for(o in e)t.style[o]=a[o];return r},Jt=W.documentElement;!function(){function e(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",s.innerHTML="",Jt.appendChild(a);var e=t.getComputedStyle(s);n="1%"!==e.top,o="2px"===e.marginLeft,i="4px"===e.width,s.style.marginRight="50%",r="4px"===e.marginRight,Jt.removeChild(a)}var n,i,r,o,a=W.createElement("div"),s=W.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",it.clearCloneStyle="content-box"===s.style.backgroundClip,a.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",a.appendChild(s),ot.extend(it,{pixelPosition:function(){return e(),n},boxSizingReliable:function(){return null==i&&e(),i},pixelMarginRight:function(){return null==i&&e(),r},reliableMarginLeft:function(){return null==i&&e(),o},reliableMarginRight:function(){var e,n=s.appendChild(W.createElement("div"));return n.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",s.style.width="1px",Jt.appendChild(a),e=!parseFloat(t.getComputedStyle(n).marginRight),Jt.removeChild(a),s.removeChild(n),e}}))}();var Qt=/^(none|table(?!-c[ea]).+)/,te={position:"absolute",visibility:"hidden",display:"block"},ee={letterSpacing:"0",fontWeight:"400"},ne=["Webkit","O","Moz","ms"],ie=W.createElement("div").style;ot.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=T(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,s=ot.camelCase(e),u=t.style;return e=ot.cssProps[s]||(ot.cssProps[s]=I(s)||s),a=ot.cssHooks[e]||ot.cssHooks[s],void 0===n?a&&"get"in a&&void 0!==(r=a.get(t,!1,i))?r:u[e]:(o=typeof n,"string"===o&&(r=At.exec(n))&&r[1]&&(n=l(t,e,r),o="number"),void(null!=n&&n===n&&("number"===o&&(n+=r&&r[3]||(ot.cssNumber[s]?"":"px")),it.clearCloneStyle||""!==n||0!==e.indexOf("background")||(u[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,i))||(u[e]=n))))}},css:function(t,e,n,i){var r,o,a,s=ot.camelCase(e);return e=ot.cssProps[s]||(ot.cssProps[s]=I(s)||s),a=ot.cssHooks[e]||ot.cssHooks[s],a&&"get"in a&&(r=a.get(t,!0,n)),void 0===r&&(r=T(t,e,i)),"normal"===r&&e in ee&&(r=ee[e]),""===n||n?(o=parseFloat(r),n===!0||isFinite(o)?o||0:r):r}}),ot.each(["height","width"],function(t,e){ot.cssHooks[e]={get:function(t,n,i){return n?Qt.test(ot.css(t,"display"))&&0===t.offsetWidth?Kt(t,te,function(){return k(t,e,i)}):k(t,e,i):void 0},set:function(t,n,i){var r,o=i&&Zt(t),a=i&&A(t,e,i,"border-box"===ot.css(t,"boxSizing",!1,o),o);return a&&(r=At.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=ot.css(t,e)),z(t,n,a)}}}),ot.cssHooks.marginLeft=D(it.reliableMarginLeft,function(t,e){return e?(parseFloat(T(t,"marginLeft"))||t.getBoundingClientRect().left-Kt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px":void 0}),ot.cssHooks.marginRight=D(it.reliableMarginRight,function(t,e){
return e?Kt(t,{display:"inline-block"},T,[t,"marginRight"]):void 0}),ot.each({margin:"",padding:"",border:"Width"},function(t,e){ot.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];4>i;i++)r[t+kt[i]+e]=o[i]||o[i-2]||o[0];return r}},$t.test(t)||(ot.cssHooks[t+e].set=z)}),ot.fn.extend({css:function(t,e){return St(this,function(t,e,n){var i,r,o={},a=0;if(ot.isArray(e)){for(i=Zt(t),r=e.length;r>a;a++)o[e[a]]=ot.css(t,e[a],!1,i);return o}return void 0!==n?ot.style(t,e,n):ot.css(t,e)},t,e,arguments.length>1)},show:function(){return L(this,!0)},hide:function(){return L(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Lt(this)?ot(this).show():ot(this).hide()})}}),ot.Tween=C,C.prototype={constructor:C,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||ot.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(ot.cssNumber[n]?"":"px")},cur:function(){var t=C.propHooks[this.prop];return t&&t.get?t.get(this):C.propHooks._default.get(this)},run:function(t){var e,n=C.propHooks[this.prop];return this.options.duration?this.pos=e=ot.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):C.propHooks._default.set(this),this}},C.prototype.init.prototype=C.prototype,C.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=ot.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){ot.fx.step[t.prop]?ot.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[ot.cssProps[t.prop]]&&!ot.cssHooks[t.prop]?t.elem[t.prop]=t.now:ot.style(t.elem,t.prop,t.now+t.unit)}}},C.propHooks.scrollTop=C.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},ot.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},ot.fx=C.prototype.init,ot.fx.step={};var re,oe,ae=/^(?:toggle|show|hide)$/,se=/queueHooks$/;ot.Animation=ot.extend(N,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return l(n.elem,t,At.exec(e),n),n}]},tweener:function(t,e){ot.isFunction(t)?(e=t,t=["*"]):t=t.match(bt);for(var n,i=0,r=t.length;r>i;i++)n=t[i],N.tweeners[n]=N.tweeners[n]||[],N.tweeners[n].unshift(e)},prefilters:[O],prefilter:function(t,e){e?N.prefilters.unshift(t):N.prefilters.push(t)}}),ot.speed=function(t,e,n){var i=t&&"object"==typeof t?ot.extend({},t):{complete:n||!n&&e||ot.isFunction(t)&&t,duration:t,easing:n&&e||e&&!ot.isFunction(e)&&e};return i.duration=ot.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in ot.fx.speeds?ot.fx.speeds[i.duration]:ot.fx.speeds._default,null!=i.queue&&i.queue!==!0||(i.queue="fx"),i.old=i.complete,i.complete=function(){ot.isFunction(i.old)&&i.old.call(this),i.queue&&ot.dequeue(this,i.queue)},i},ot.fn.extend({fadeTo:function(t,e,n,i){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=ot.isEmptyObject(t),o=ot.speed(e,n,i),a=function(){var e=N(this,ot.extend({},t),o);(r||Et.get(this,"finish"))&&e.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=ot.timers,a=Et.get(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&se.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||ot.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,n=Et.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=ot.timers,a=i?i.length:0;for(n.finish=!0,ot.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;a>e;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),ot.each(["toggle","show","hide"],function(t,e){var n=ot.fn[e];ot.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(F(e,!0),t,i,r)}}),ot.each({slideDown:F("show"),slideUp:F("hide"),slideToggle:F("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){ot.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),ot.timers=[],ot.fx.tick=function(){var t,e=0,n=ot.timers;for(re=ot.now();e<n.length;e++)t=n[e],t()||n[e]!==t||n.splice(e--,1);n.length||ot.fx.stop(),re=void 0},ot.fx.timer=function(t){ot.timers.push(t),t()?ot.fx.start():ot.timers.pop()},ot.fx.interval=13,ot.fx.start=function(){oe||(oe=t.setInterval(ot.fx.tick,ot.fx.interval))},ot.fx.stop=function(){t.clearInterval(oe),oe=null},ot.fx.speeds={slow:600,fast:200,_default:400},ot.fn.delay=function(e,n){return e=ot.fx?ot.fx.speeds[e]||e:e,n=n||"fx",this.queue(n,function(n,i){var r=t.setTimeout(n,e);i.stop=function(){t.clearTimeout(r)}})},function(){var t=W.createElement("input"),e=W.createElement("select"),n=e.appendChild(W.createElement("option"));t.type="checkbox",it.checkOn=""!==t.value,it.optSelected=n.selected,e.disabled=!0,it.optDisabled=!n.disabled,t=W.createElement("input"),t.value="t",t.type="radio",it.radioValue="t"===t.value}();var ue,le=ot.expr.attrHandle;ot.fn.extend({attr:function(t,e){return St(this,ot.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){ot.removeAttr(this,t)})}}),ot.extend({attr:function(t,e,n){var i,r,o=t.nodeType;return 3!==o&&8!==o&&2!==o?"undefined"==typeof t.getAttribute?ot.prop(t,e,n):(1===o&&ot.isXMLDoc(t)||(e=e.toLowerCase(),r=ot.attrHooks[e]||(ot.expr.match.bool.test(e)?ue:void 0)),void 0!==n?null===n?void ot.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:(i=ot.find.attr(t,e),null==i?void 0:i)):void 0},attrHooks:{type:{set:function(t,e){if(!it.radioValue&&"radio"===e&&ot.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i,r=0,o=e&&e.match(bt);if(o&&1===t.nodeType)for(;n=o[r++];)i=ot.propFix[n]||n,ot.expr.match.bool.test(n)&&(t[i]=!1),t.removeAttribute(n)}}),ue={set:function(t,e,n){return e===!1?ot.removeAttr(t,n):t.setAttribute(n,n),n}},ot.each(ot.expr.match.bool.source.match(/\w+/g),function(t,e){var n=le[e]||ot.find.attr;le[e]=function(t,e,i){var r,o;return i||(o=le[e],le[e]=r,r=null!=n(t,e,i)?e.toLowerCase():null,le[e]=o),r}});var ce=/^(?:input|select|textarea|button)$/i,he=/^(?:a|area)$/i;ot.fn.extend({prop:function(t,e){return St(this,ot.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[ot.propFix[t]||t]})}}),ot.extend({prop:function(t,e,n){var i,r,o=t.nodeType;return 3!==o&&8!==o&&2!==o?(1===o&&ot.isXMLDoc(t)||(e=ot.propFix[e]||e,r=ot.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]):void 0},propHooks:{tabIndex:{get:function(t){var e=ot.find.attr(t,"tabindex");return e?parseInt(e,10):ce.test(t.nodeName)||he.test(t.nodeName)&&t.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),it.optSelected||(ot.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),ot.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ot.propFix[this.toLowerCase()]=this});var fe=/[\t\r\n\f]/g;ot.fn.extend({addClass:function(t){var e,n,i,r,o,a,s,u=0;if(ot.isFunction(t))return this.each(function(e){ot(this).addClass(t.call(this,e,B(this)))});if("string"==typeof t&&t)for(e=t.match(bt)||[];n=this[u++];)if(r=B(n),i=1===n.nodeType&&(" "+r+" ").replace(fe," ")){for(a=0;o=e[a++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");s=ot.trim(i),r!==s&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,i,r,o,a,s,u=0;if(ot.isFunction(t))return this.each(function(e){ot(this).removeClass(t.call(this,e,B(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(bt)||[];n=this[u++];)if(r=B(n),i=1===n.nodeType&&(" "+r+" ").replace(fe," ")){for(a=0;o=e[a++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");s=ot.trim(i),r!==s&&n.setAttribute("class",s)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):ot.isFunction(t)?this.each(function(n){ot(this).toggleClass(t.call(this,n,B(this),e),e)}):this.each(function(){var e,i,r,o;if("string"===n)for(i=0,r=ot(this),o=t.match(bt)||[];e=o[i++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==t&&"boolean"!==n||(e=B(this),e&&Et.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||t===!1?"":Et.get(this,"__className__")||""))})},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+B(n)+" ").replace(fe," ").indexOf(e)>-1)return!0;return!1}});var de=/\r/g,pe=/[\x20\t\r\n\f]+/g;ot.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=ot.isFunction(t),this.each(function(n){var r;1===this.nodeType&&(r=i?t.call(this,n,ot(this).val()):t,null==r?r="":"number"==typeof r?r+="":ot.isArray(r)&&(r=ot.map(r,function(t){return null==t?"":t+""})),e=ot.valHooks[this.type]||ot.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))})):r?(e=ot.valHooks[r.type]||ot.valHooks[r.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:(n=r.value,"string"==typeof n?n.replace(de,""):null==n?"":n)):void 0}}),ot.extend({valHooks:{option:{get:function(t){var e=ot.find.attr(t,"value");return null!=e?e:ot.trim(ot.text(t)).replace(pe," ")}},select:{get:function(t){for(var e,n,i=t.options,r=t.selectedIndex,o="select-one"===t.type||0>r,a=o?null:[],s=o?r+1:i.length,u=0>r?s:o?r:0;s>u;u++)if(n=i[u],(n.selected||u===r)&&(it.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!ot.nodeName(n.parentNode,"optgroup"))){if(e=ot(n).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,o=ot.makeArray(e),a=r.length;a--;)i=r[a],(i.selected=ot.inArray(ot.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),ot.each(["radio","checkbox"],function(){ot.valHooks[this]={set:function(t,e){return ot.isArray(e)?t.checked=ot.inArray(ot(t).val(),e)>-1:void 0}},it.checkOn||(ot.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var me=/^(?:focusinfocus|focusoutblur)$/;ot.extend(ot.event,{trigger:function(e,n,i,r){var o,a,s,u,l,c,h,f=[i||W],d=nt.call(e,"type")?e.type:e,p=nt.call(e,"namespace")?e.namespace.split("."):[];if(a=s=i=i||W,3!==i.nodeType&&8!==i.nodeType&&!me.test(d+ot.event.triggered)&&(d.indexOf(".")>-1&&(p=d.split("."),d=p.shift(),p.sort()),l=d.indexOf(":")<0&&"on"+d,e=e[ot.expando]?e:new ot.Event(d,"object"==typeof e&&e),e.isTrigger=r?2:3,e.namespace=p.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:ot.makeArray(n,[e]),h=ot.event.special[d]||{},r||!h.trigger||h.trigger.apply(i,n)!==!1)){if(!r&&!h.noBubble&&!ot.isWindow(i)){for(u=h.delegateType||d,me.test(u+d)||(a=a.parentNode);a;a=a.parentNode)f.push(a),s=a;s===(i.ownerDocument||W)&&f.push(s.defaultView||s.parentWindow||t)}for(o=0;(a=f[o++])&&!e.isPropagationStopped();)e.type=o>1?u:h.bindType||d,c=(Et.get(a,"events")||{})[e.type]&&Et.get(a,"handle"),c&&c.apply(a,n),c=l&&a[l],c&&c.apply&&Mt(a)&&(e.result=c.apply(a,n),e.result===!1&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||h._default&&h._default.apply(f.pop(),n)!==!1||!Mt(i)||l&&ot.isFunction(i[d])&&!ot.isWindow(i)&&(s=i[l],s&&(i[l]=null),ot.event.triggered=d,i[d](),ot.event.triggered=void 0,s&&(i[l]=s)),e.result}},simulate:function(t,e,n){var i=ot.extend(new ot.Event,n,{type:t,isSimulated:!0});ot.event.trigger(i,null,e),i.isDefaultPrevented()&&n.preventDefault()}}),ot.fn.extend({trigger:function(t,e){return this.each(function(){ot.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];return n?ot.event.trigger(t,e,n,!0):void 0}}),ot.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){ot.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),ot.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),it.focusin="onfocusin"in t,it.focusin||ot.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){ot.event.simulate(e,t.target,ot.event.fix(t))};ot.event.special[e]={setup:function(){var i=this.ownerDocument||this,r=Et.access(i,e);r||i.addEventListener(t,n,!0),Et.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=Et.access(i,e)-1;r?Et.access(i,e,r):(i.removeEventListener(t,n,!0),Et.remove(i,e))}}});var ve=t.location,ye=ot.now(),ge=/\?/;ot.parseJSON=function(t){return JSON.parse(t+"")},ot.parseXML=function(e){var n;if(!e||"string"!=typeof e)return null;try{n=(new t.DOMParser).parseFromString(e,"text/xml")}catch(i){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||ot.error("Invalid XML: "+e),n};var _e=/#.*$/,xe=/([?&])_=[^&]*/,be=/^(.*?):[ \t]*([^\r\n]*)$/gm,we=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Se=/^(?:GET|HEAD)$/,Me=/^\/\//,Ee={},Te={},De="*/".concat("*"),Ie=W.createElement("a");Ie.href=ve.href,ot.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ve.href,type:"GET",isLocal:we.test(ve.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":De,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ot.parseJSON,"text xml":ot.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?V(V(t,ot.ajaxSettings),e):V(ot.ajaxSettings,t)},ajaxPrefilter:q(Ee),ajaxTransport:q(Te),ajax:function(e,n){function i(e,n,i,s){var l,h,g,_,b,S=n;2!==x&&(x=2,u&&t.clearTimeout(u),r=void 0,a=s||"",w.readyState=e>0?4:0,l=e>=200&&300>e||304===e,i&&(_=H(f,w,i)),_=G(f,_,w,l),l?(f.ifModified&&(b=w.getResponseHeader("Last-Modified"),b&&(ot.lastModified[o]=b),b=w.getResponseHeader("etag"),b&&(ot.etag[o]=b)),204===e||"HEAD"===f.type?S="nocontent":304===e?S="notmodified":(S=_.state,h=_.data,g=_.error,l=!g)):(g=S,!e&&S||(S="error",0>e&&(e=0))),w.status=e,w.statusText=(n||S)+"",l?m.resolveWith(d,[h,S,w]):m.rejectWith(d,[w,S,g]),w.statusCode(y),y=void 0,c&&p.trigger(l?"ajaxSuccess":"ajaxError",[w,f,l?h:g]),v.fireWith(d,[w,S]),c&&(p.trigger("ajaxComplete",[w,f]),--ot.active||ot.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=void 0),n=n||{};var r,o,a,s,u,l,c,h,f=ot.ajaxSetup({},n),d=f.context||f,p=f.context&&(d.nodeType||d.jquery)?ot(d):ot.event,m=ot.Deferred(),v=ot.Callbacks("once memory"),y=f.statusCode||{},g={},_={},x=0,b="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===x){if(!s)for(s={};e=be.exec(a);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===x?a:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return x||(t=_[n]=_[n]||t,g[t]=e),this},overrideMimeType:function(t){return x||(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>x)for(e in t)y[e]=[y[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||b;return r&&r.abort(e),i(0,e),this}};if(m.promise(w).complete=v.add,w.success=w.done,w.error=w.fail,f.url=((e||f.url||ve.href)+"").replace(_e,"").replace(Me,ve.protocol+"//"),f.type=n.method||n.type||f.method||f.type,f.dataTypes=ot.trim(f.dataType||"*").toLowerCase().match(bt)||[""],null==f.crossDomain){l=W.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Ie.protocol+"//"+Ie.host!=l.protocol+"//"+l.host}catch(S){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=ot.param(f.data,f.traditional)),U(Ee,f,n,w),2===x)return w;c=ot.event&&f.global,c&&0===ot.active++&&ot.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Se.test(f.type),o=f.url,f.hasContent||(f.data&&(o=f.url+=(ge.test(o)?"&":"?")+f.data,delete f.data),f.cache===!1&&(f.url=xe.test(o)?o.replace(xe,"$1_="+ye++):o+(ge.test(o)?"&":"?")+"_="+ye++)),f.ifModified&&(ot.lastModified[o]&&w.setRequestHeader("If-Modified-Since",ot.lastModified[o]),ot.etag[o]&&w.setRequestHeader("If-None-Match",ot.etag[o])),(f.data&&f.hasContent&&f.contentType!==!1||n.contentType)&&w.setRequestHeader("Content-Type",f.contentType),w.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+De+"; q=0.01":""):f.accepts["*"]);for(h in f.headers)w.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(f.beforeSend.call(d,w,f)===!1||2===x))return w.abort();b="abort";for(h in{success:1,error:1,complete:1})w[h](f[h]);if(r=U(Te,f,n,w)){if(w.readyState=1,c&&p.trigger("ajaxSend",[w,f]),2===x)return w;f.async&&f.timeout>0&&(u=t.setTimeout(function(){w.abort("timeout")},f.timeout));try{x=1,r.send(g,i)}catch(S){if(!(2>x))throw S;i(-1,S)}}else i(-1,"No Transport");return w},getJSON:function(t,e,n){return ot.get(t,e,n,"json")},getScript:function(t,e){return ot.get(t,void 0,e,"script")}}),ot.each(["get","post"],function(t,e){ot[e]=function(t,n,i,r){return ot.isFunction(n)&&(r=r||i,i=n,n=void 0),ot.ajax(ot.extend({url:t,type:e,dataType:r,data:n,success:i},ot.isPlainObject(t)&&t))}}),ot._evalUrl=function(t){return ot.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},ot.fn.extend({wrapAll:function(t){var e;return ot.isFunction(t)?this.each(function(e){ot(this).wrapAll(t.call(this,e))}):(this[0]&&(e=ot(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return ot.isFunction(t)?this.each(function(e){ot(this).wrapInner(t.call(this,e))}):this.each(function(){var e=ot(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=ot.isFunction(t);return this.each(function(n){ot(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){ot.nodeName(this,"body")||ot(this).replaceWith(this.childNodes)}).end()}}),ot.expr.filters.hidden=function(t){return!ot.expr.filters.visible(t)},ot.expr.filters.visible=function(t){return t.offsetWidth>0||t.offsetHeight>0||t.getClientRects().length>0};var ze=/%20/g,Ae=/\[\]$/,ke=/\r?\n/g,Le=/^(?:submit|button|image|reset|file)$/i,Ce=/^(?:input|select|textarea|keygen)/i;ot.param=function(t,e){var n,i=[],r=function(t,e){e=ot.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=ot.ajaxSettings&&ot.ajaxSettings.traditional),ot.isArray(t)||t.jquery&&!ot.isPlainObject(t))ot.each(t,function(){r(this.name,this.value)});else for(n in t)Y(n,t[n],e,r);return i.join("&").replace(ze,"+")},ot.fn.extend({serialize:function(){return ot.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=ot.prop(this,"elements");return t?ot.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!ot(this).is(":disabled")&&Ce.test(this.nodeName)&&!Le.test(t)&&(this.checked||!Ct.test(t))}).map(function(t,e){var n=ot(this).val();return null==n?null:ot.isArray(n)?ot.map(n,function(t){return{name:e.name,value:t.replace(ke,"\r\n")}}):{name:e.name,value:n.replace(ke,"\r\n")}}).get()}}),ot.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(e){}};var Pe={0:200,1223:204},Fe=ot.ajaxSettings.xhr();it.cors=!!Fe&&"withCredentials"in Fe,it.ajax=Fe=!!Fe,ot.ajaxTransport(function(e){var n,i;return it.cors||Fe&&!e.crossDomain?{send:function(r,o){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");for(a in r)s.setRequestHeader(a,r[a]);n=function(t){return function(){n&&(n=i=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Pe[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),i=s.onerror=n("error"),void 0!==s.onabort?s.onabort=i:s.onreadystatechange=function(){4===s.readyState&&t.setTimeout(function(){n&&i()})},n=n("abort");try{s.send(e.hasContent&&e.data||null)}catch(u){if(n)throw u}},abort:function(){n&&n()}}:void 0}),ot.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return ot.globalEval(t),t}}}),ot.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),ot.ajaxTransport("script",function(t){if(t.crossDomain){var e,n;return{send:function(i,r){e=ot("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),W.head.appendChild(e[0])},abort:function(){n&&n()}}}});var je=[],Oe=/(=)\?(?=&|$)|\?\?/;ot.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=je.pop()||ot.expando+"_"+ye++;return this[t]=!0,t}}),ot.ajaxPrefilter("json jsonp",function(e,n,i){var r,o,a,s=e.jsonp!==!1&&(Oe.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Oe.test(e.data)&&"data");return s||"jsonp"===e.dataTypes[0]?(r=e.jsonpCallback=ot.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Oe,"$1"+r):e.jsonp!==!1&&(e.url+=(ge.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return a||ot.error(r+" was not called"),a[0]},e.dataTypes[0]="json",o=t[r],t[r]=function(){a=arguments},i.always(function(){void 0===o?ot(t).removeProp(r):t[r]=o,e[r]&&(e.jsonpCallback=n.jsonpCallback,je.push(r)),a&&ot.isFunction(o)&&o(a[0]),a=o=void 0}),"script"):void 0}),ot.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||W;var i=pt.exec(t),r=!n&&[];return i?[e.createElement(i[1])]:(i=f([t],e,r),r&&r.length&&ot(r).remove(),ot.merge([],i.childNodes))};var Re=ot.fn.load;ot.fn.load=function(t,e,n){if("string"!=typeof t&&Re)return Re.apply(this,arguments);var i,r,o,a=this,s=t.indexOf(" ");return s>-1&&(i=ot.trim(t.slice(s)),t=t.slice(0,s)),ot.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),a.length>0&&ot.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,a.html(i?ot("<div>").append(ot.parseHTML(t)).find(i):t)}).always(n&&function(t,e){a.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},ot.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){ot.fn[e]=function(t){return this.on(e,t)}}),ot.expr.filters.animated=function(t){return ot.grep(ot.timers,function(e){return t===e.elem}).length},ot.offset={setOffset:function(t,e,n){var i,r,o,a,s,u,l,c=ot.css(t,"position"),h=ot(t),f={};"static"===c&&(t.style.position="relative"),s=h.offset(),o=ot.css(t,"top"),u=ot.css(t,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(i=h.position(),a=i.top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(u)||0),ot.isFunction(e)&&(e=e.call(t,n,ot.extend({},s))),null!=e.top&&(f.top=e.top-s.top+a),null!=e.left&&(f.left=e.left-s.left+r),"using"in e?e.using.call(t,f):h.css(f)}},ot.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){ot.offset.setOffset(this,t,e)});var e,n,i=this[0],r={top:0,left:0},o=i&&i.ownerDocument;return o?(e=o.documentElement,ot.contains(e,i)?(r=i.getBoundingClientRect(),n=X(o),{top:r.top+n.pageYOffset-e.clientTop,left:r.left+n.pageXOffset-e.clientLeft}):r):void 0},position:function(){if(this[0]){var t,e,n=this[0],i={top:0,left:0};return"fixed"===ot.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),ot.nodeName(t[0],"html")||(i=t.offset()),i.top+=ot.css(t[0],"borderTopWidth",!0),i.left+=ot.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-ot.css(n,"marginTop",!0),left:e.left-i.left-ot.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===ot.css(t,"position");)t=t.offsetParent;return t||Jt})}}),ot.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;ot.fn[t]=function(i){return St(this,function(t,i,r){var o=X(t);return void 0===r?o?o[e]:t[i]:void(o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r)},t,i,arguments.length)}}),ot.each(["top","left"],function(t,e){ot.cssHooks[e]=D(it.pixelPosition,function(t,n){return n?(n=T(t,e),Wt.test(n)?ot(t).position()[e]+"px":n):void 0})}),ot.each({Height:"height",Width:"width"},function(t,e){ot.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){ot.fn[i]=function(i,r){var o=arguments.length&&(n||"boolean"!=typeof i),a=n||(i===!0||r===!0?"margin":"border");return St(this,function(e,n,i){var r;return ot.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===i?ot.css(e,n,a):ot.style(e,n,i,a)},e,o?i:void 0,o,null)}})}),ot.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},size:function(){return this.length}}),ot.fn.andSelf=ot.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ot});var Ne=t.jQuery,Be=t.$;return ot.noConflict=function(e){return t.$===ot&&(t.$=Be),e&&t.jQuery===ot&&(t.jQuery=Ne),ot},e||(t.jQuery=t.$=ot),ot}),!function(t,e){"function"==typeof define&&define.amd?define("bloodhound",["jquery"],function(n){return t.Bloodhound=e(n)}):"object"==typeof exports?module.exports=e(require("jquery")):t.Bloodhound=e(jQuery)}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?void 0:!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?!1:void 0}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var o,a,s=this,u=arguments;return o=function(){i=null,n||(r=t.apply(s,u))},a=n&&!i,clearTimeout(i),i=setTimeout(o,e),a&&(r=t.apply(s,u)),r}},throttle:function(t,e){var n,i,r,o,a,s;return a=0,s=function(){a=new Date,r=null,o=t.apply(n,i)},function(){var u=new Date,l=e-(u-a);return n=this,i=arguments,0>=l?(clearTimeout(r),r=null,a=u,o=t.apply(n,i)):r||(r=setTimeout(s,l)),o}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n="0.11.1",i=function(){"use strict";function t(t){return t=e.toStr(t),t?t.split(/\s+/):[]}function n(t){return t=e.toStr(t),t?t.split(/\W+/):[]}function i(t){return function(n){return n=e.isArray(n)?n:[].slice.call(arguments,0),function(i){var r=[];return e.each(n,function(n){r=r.concat(t(e.toStr(i[n])))}),r}}}return{nonword:n,whitespace:t,obj:{nonword:i(n),whitespace:i(t)}}}(),r=function(){"use strict";function n(n){this.maxSize=e.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function i(){this.head=this.tail=null}function r(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(n.prototype,{set:function(t,e){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key],this.size--),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new r(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];return e?(this.list.moveToFront(e),e.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new i}}),e.mixin(i.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),n}(),o=function(){"use strict";function n(t,n){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix)),this.ls=n||s,!this.ls&&this._noop()}function i(){return(new Date).getTime()}function r(t){return JSON.stringify(e.isUndefined(t)?null:t)}function o(e){return t.parseJSON(e)}function a(t){var e,n,i=[],r=s.length;for(e=0;r>e;e++)(n=s.key(e)).match(t)&&i.push(n.replace(t,""));return i}var s;try{s=window.localStorage,s.setItem("~~~","!"),s.removeItem("~~~")}catch(u){s=null}return e.mixin(n.prototype,{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=e.noop},_safeSet:function(t,e){try{this.ls.setItem(t,e)}catch(n){"QuotaExceededError"===n.name&&(this.clear(),this._noop())}},get:function(t){return this.isExpired(t)&&this.remove(t),o(this.ls.getItem(this._prefix(t)))},set:function(t,n,o){return e.isNumber(o)?this._safeSet(this._ttlKey(t),r(i()+o)):this.ls.removeItem(this._ttlKey(t)),this._safeSet(this._prefix(t),r(n))},remove:function(t){return this.ls.removeItem(this._ttlKey(t)),this.ls.removeItem(this._prefix(t)),this},clear:function(){var t,e=a(this.keyMatcher);for(t=e.length;t--;)this.remove(e[t]);return this},isExpired:function(t){var n=o(this.ls.getItem(this._ttlKey(t)));return!!(e.isNumber(n)&&i()>n)}}),n}(),a=function(){"use strict";function n(t){t=t||{},this.cancelled=!1,this.lastReq=null,this._send=t.transport,this._get=t.limiter?t.limiter(this._get):this._get,this._cache=t.cache===!1?new r(0):s}var i=0,o={},a=6,s=new r(10);return n.setMaxPendingRequests=function(t){a=t},n.resetCache=function(){s.reset()},e.mixin(n.prototype,{_fingerprint:function(e){return e=e||{},e.url+e.type+t.param(e.data||{})},_get:function(t,e){function n(t){e(null,t),c._cache.set(u,t)}function r(){
e(!0)}function s(){i--,delete o[u],c.onDeckRequestArgs&&(c._get.apply(c,c.onDeckRequestArgs),c.onDeckRequestArgs=null)}var u,l,c=this;u=this._fingerprint(t),this.cancelled||u!==this.lastReq||((l=o[u])?l.done(n).fail(r):a>i?(i++,o[u]=this._send(t).done(n).fail(r).always(s)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(n,i){var r,o;i=i||t.noop,n=e.isString(n)?{url:n}:n||{},o=this._fingerprint(n),this.cancelled=!1,this.lastReq=o,(r=this._cache.get(o))?i(null,r):this._get(n,i)},cancel:function(){this.cancelled=!0}}),n}(),s=window.SearchIndex=function(){"use strict";function n(n){n=n||{},n.datumTokenizer&&n.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.identify=n.identify||e.stringify,this.datumTokenizer=n.datumTokenizer,this.queryTokenizer=n.queryTokenizer,this.reset()}function i(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function r(){var t={};return t[u]=[],t[s]={},t}function o(t){for(var e={},n=[],i=0,r=t.length;r>i;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}function a(t,e){var n=0,i=0,r=[];t=t.sort(),e=e.sort();for(var o=t.length,a=e.length;o>n&&a>i;)t[n]<e[i]?n++:t[n]>e[i]?i++:(r.push(t[n]),n++,i++);return r}var s="c",u="i";return e.mixin(n.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var n=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var o,a;n.datums[o=n.identify(t)]=t,a=i(n.datumTokenizer(t)),e.each(a,function(t){var e,i,a;for(e=n.trie,i=t.split("");a=i.shift();)e=e[s][a]||(e[s][a]=r()),e[u].push(o)})})},get:function(t){var n=this;return e.map(t,function(t){return n.datums[t]})},search:function(t){var n,r,l=this;return n=i(this.queryTokenizer(t)),e.each(n,function(t){var e,n,i,o;if(r&&0===r.length)return!1;for(e=l.trie,n=t.split("");e&&(i=n.shift());)e=e[s][i];return e&&0===n.length?(o=e[u].slice(0),void(r=r?a(r,o):o)):(r=[],!1)}),r?e.map(o(r),function(t){return l.datums[t]}):[]},all:function(){var t=[];for(var e in this.datums)t.push(this.datums[e]);return t},reset:function(){this.datums={},this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),u=function(){"use strict";function t(t){this.url=t.url,this.ttl=t.ttl,this.cache=t.cache,this.prepare=t.prepare,this.transform=t.transform,this.transport=t.transport,this.thumbprint=t.thumbprint,this.storage=new o(t.cacheKey)}var n;return n={data:"data",protocol:"protocol",thumbprint:"thumbprint"},e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(t){this.cache&&(this.storage.set(n.data,t,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var t,e={};return this.cache?(e.data=this.storage.get(n.data),e.protocol=this.storage.get(n.protocol),e.thumbprint=this.storage.get(n.thumbprint),t=e.thumbprint!==this.thumbprint||e.protocol!==location.protocol,e.data&&!t?e.data:null):null},fromNetwork:function(t){function e(){t(!0)}function n(e){t(null,r.transform(e))}var i,r=this;t&&(i=this.prepare(this._settings()),this.transport(i).fail(e).done(n))},clear:function(){return this.storage.clear(),this}}),t}(),l=function(){"use strict";function t(t){this.url=t.url,this.prepare=t.prepare,this.transform=t.transform,this.transport=new a({cache:t.cache,limiter:t.limiter,transport:t.transport})}return e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(t,e){function n(t,n){e(t?[]:r.transform(n))}var i,r=this;return e?(t=t||"",i=this.prepare(t,this._settings()),this.transport.get(i,n)):void 0},cancelLastRequest:function(){this.transport.cancel()}}),t}(),c=function(){"use strict";function i(i){var r;return i?(r={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:e.identity,transform:e.identity,transport:null},i=e.isString(i)?{url:i}:i,i=e.mixin(r,i),!i.url&&t.error("prefetch requires url to be set"),i.transform=i.filter||i.transform,i.cacheKey=i.cacheKey||i.url,i.thumbprint=n+i.thumbprint,i.transport=i.transport?s(i.transport):t.ajax,i):null}function r(n){var i;return n?(i={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:e.identity,transport:null},n=e.isString(n)?{url:n}:n,n=e.mixin(i,n),!n.url&&t.error("remote requires url to be set"),n.transform=n.filter||n.transform,n.prepare=o(n),n.limiter=a(n),n.transport=n.transport?s(n.transport):t.ajax,delete n.replace,delete n.wildcard,delete n.rateLimitBy,delete n.rateLimitWait,n):void 0}function o(t){function e(t,e){return e.url=o(e.url,t),e}function n(t,e){return e.url=e.url.replace(a,encodeURIComponent(t)),e}function i(t,e){return e}var r,o,a;return r=t.prepare,o=t.replace,a=t.wildcard,r?r:r=o?e:t.wildcard?n:i}function a(t){function n(t){return function(n){return e.debounce(n,t)}}function i(t){return function(n){return e.throttle(n,t)}}var r,o,a;return r=t.limiter,o=t.rateLimitBy,a=t.rateLimitWait,r||(r=/^throttle$/i.test(o)?i(a):n(a)),r}function s(n){return function(i){function r(t){e.defer(function(){a.resolve(t)})}function o(t){e.defer(function(){a.reject(t)})}var a=t.Deferred();return n(i,r,o),a}}return function(n){var o,a;return o={initialize:!0,identify:e.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},n=e.mixin(o,n||{}),!n.datumTokenizer&&t.error("datumTokenizer is required"),!n.queryTokenizer&&t.error("queryTokenizer is required"),a=n.sorter,n.sorter=a?function(t){return t.sort(a)}:e.identity,n.local=e.isFunction(n.local)?n.local():n.local,n.prefetch=i(n.prefetch),n.remote=r(n.remote),n}}(),h=function(){"use strict";function n(t){t=c(t),this.sorter=t.sorter,this.identify=t.identify,this.sufficient=t.sufficient,this.local=t.local,this.remote=t.remote?new l(t.remote):null,this.prefetch=t.prefetch?new u(t.prefetch):null,this.index=new s({identify:this.identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),t.initialize!==!1&&this.initialize()}var r;return r=window&&window.Bloodhound,n.noConflict=function(){return window&&(window.Bloodhound=r),n},n.tokenizers=i,e.mixin(n.prototype,{__ttAdapter:function(){function t(t,e,i){return n.search(t,e,i)}function e(t,e){return n.search(t,e)}var n=this;return this.remote?t:e},_loadPrefetch:function(){function e(t,e){return t?n.reject():(r.add(e),r.prefetch.store(r.index.serialize()),void n.resolve())}var n,i,r=this;return n=t.Deferred(),this.prefetch?(i=this.prefetch.fromCache())?(this.index.bootstrap(i),n.resolve()):this.prefetch.fromNetwork(e):n.resolve(),n.promise()},_initialize:function(){function t(){e.add(e.local)}var e=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(t),this.initPromise},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){return this.index.add(t),this},get:function(t){return t=e.isArray(t)?t:[].slice.call(arguments),this.index.get(t)},search:function(t,n,i){function r(t){var n=[];e.each(t,function(t){!e.some(o,function(e){return a.identify(t)===a.identify(e)})&&n.push(t)}),i&&i(n)}var o,a=this;return o=this.sorter(this.index.search(t)),n(this.remote?o.slice():o),this.remote&&o.length<this.sufficient?this.remote.get(t,r):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return a.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),n}();return h}),function(t,e){"function"==typeof define&&define.amd?define("typeahead.js",["jquery"],function(t){return e(t)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?void 0:!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?!1:void 0}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var o,a,s=this,u=arguments;return o=function(){i=null,n||(r=t.apply(s,u))},a=n&&!i,clearTimeout(i),i=setTimeout(o,e),a&&(r=t.apply(s,u)),r}},throttle:function(t,e){var n,i,r,o,a,s;return a=0,s=function(){a=new Date,r=null,o=t.apply(n,i)},function(){var u=new Date,l=e-(u-a);return n=this,i=arguments,0>=l?(clearTimeout(r),r=null,a=u,o=t.apply(n,i)):r||(r=setTimeout(s,l)),o}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n=function(){"use strict";function t(t){var a,s;return s=e.mixin({},o,t),a={css:r(),classes:s,html:n(s),selectors:i(s)},{css:a.css,html:a.html,classes:a.classes,selectors:a.selectors,mixin:function(t){e.mixin(t,a)}}}function n(t){return{wrapper:'<span class="'+t.wrapper+'"></span>',menu:'<div class="'+t.menu+'"></div>'}}function i(t){var n={};return e.each(t,function(t,e){n[e]="."+t}),n}function r(){var t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return e.isMsie()&&e.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),t}var o={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return t}(),i=function(){"use strict";function n(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}var i,r;return i="typeahead:",r={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},e.mixin(n.prototype,{_trigger:function(e,n){var r;return r=t.Event(i+e),(n=n||[]).unshift(r),this.$el.trigger.apply(this.$el,n),r},before:function(t){var e,n;return e=[].slice.call(arguments,1),n=this._trigger("before"+t,e),n.isDefaultPrevented()},trigger:function(t){var e;this._trigger(t,[].slice.call(arguments,1)),(e=r[t])&&this._trigger(e,[].slice.call(arguments,1))}}),n}(),r=function(){"use strict";function t(t,e,n,i){var r;if(!n)return this;for(e=e.split(u),n=i?s(n,i):n,this._callbacks=this._callbacks||{};r=e.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][t].push(n);return this}function e(e,n,i){return t.call(this,"async",e,n,i)}function n(e,n,i){return t.call(this,"sync",e,n,i)}function i(t){var e;if(!this._callbacks)return this;for(t=t.split(u);e=t.shift();)delete this._callbacks[e];return this}function r(t){var e,n,i,r,a;if(!this._callbacks)return this;for(t=t.split(u),i=[].slice.call(arguments,1);(e=t.shift())&&(n=this._callbacks[e]);)r=o(n.sync,this,[e].concat(i)),a=o(n.async,this,[e].concat(i)),r()&&l(a);return this}function o(t,e,n){function i(){for(var i,r=0,o=t.length;!i&&o>r;r+=1)i=t[r].apply(e,n)===!1;return!i}return i}function a(){var t;return t=window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)}}function s(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}var u=/\s+/,l=a();return{onSync:n,onAsync:e,off:i,trigger:r}}(),o=function(t){"use strict";function n(t,n,i){for(var r,o=[],a=0,s=t.length;s>a;a++)o.push(e.escapeRegExChars(t[a]));return r=i?"\\b("+o.join("|")+")\\b":"("+o.join("|")+")",n?new RegExp(r):new RegExp(r,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(r){function o(e){var n,i,o;return(n=s.exec(e.data))&&(o=t.createElement(r.tagName),r.className&&(o.className=r.className),i=e.splitText(n.index),i.splitText(n[0].length),o.appendChild(i.cloneNode(!0)),e.parentNode.replaceChild(o,i)),!!n}function a(t,e){for(var n,i=3,r=0;r<t.childNodes.length;r++)n=t.childNodes[r],n.nodeType===i?r+=e(n)?1:0:a(n,e)}var s;r=e.mixin({},i,r),r.node&&r.pattern&&(r.pattern=e.isArray(r.pattern)?r.pattern:[r.pattern],s=n(r.pattern,r.caseSensitive,r.wordsOnly),a(r.node,o))}}(window.document),a=function(){"use strict";function n(n,r){n=n||{},n.input||t.error("input is missing"),r.mixin(this),this.$hint=t(n.hint),this.$input=t(n.input),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=i(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop)}function i(e){return t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function o(t,e){return n.normalizeQuery(t)===n.normalizeQuery(e)}function a(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var s;return s={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(t){return e.toStr(t).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},e.mixin(n.prototype,r,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(t){var e=s[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(t,e){var n;switch(t){case"up":case"down":n=!a(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!a(e);break;default:n=!0}return n},_checkLanguageDirection:function(){var t=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==t&&(this.dir=t,this.$hint.attr("dir",t),this.trigger("langDirChanged",t))},_setQuery:function(t,e){var n,i;n=o(t,this.query),i=n?this.query.length!==t.length:!1,this.query=t,e||n?!e&&i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var t,n,i,r,o=this;return t=e.bind(this._onBlur,this),n=e.bind(this._onFocus,this),i=e.bind(this._onKeydown,this),r=e.bind(this._onInput,this),this.$input.on("blur.tt",t).on("focus.tt",n).on("keydown.tt",i),!e.isMsie()||e.isMsie()>9?this.$input.on("input.tt",r):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){s[t.which||t.keyCode]||e.defer(e.bind(o._onInput,o,t))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(t,e){this.setInputValue(t),this._setQuery(t,e)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(t){this.$input.val(t),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n,i;t=this.getInputValue(),e=this.getHint(),n=t!==e&&0===e.indexOf(t),i=""!==t&&n&&!this.hasOverflow(),!i&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,n,i;return t=this.$input.val().length,n=this.$input[0].selectionStart,e.isNumber(n)?n===t:document.selection?(i=document.selection.createRange(),i.moveStart("character",-t),t===i.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=t("<div>")}}),n}(),s=function(){"use strict";function n(n,r){n=n||{},n.templates=n.templates||{},n.templates.notFound=n.templates.notFound||n.templates.empty,n.source||t.error("missing source"),n.node||t.error("missing node"),n.name&&!s(n.name)&&t.error("invalid dataset name: "+n.name),r.mixin(this),this.highlight=!!n.highlight,this.name=n.name||l(),this.limit=n.limit||5,this.displayFn=i(n.display||n.displayKey),this.templates=a(n.templates,this.displayFn),this.source=n.source.__ttAdapter?n.source.__ttAdapter():n.source,this.async=e.isUndefined(n.async)?this.source.length>2:!!n.async,this._resetLastSuggestion(),this.$el=t(n.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function i(t){function n(e){return e[t]}return t=t||e.stringify,e.isFunction(t)?t:n}function a(n,i){function r(e){return t("<div>").text(i(e))}return{notFound:n.notFound&&e.templatify(n.notFound),pending:n.pending&&e.templatify(n.pending),header:n.header&&e.templatify(n.header),footer:n.footer&&e.templatify(n.footer),suggestion:n.suggestion||r}}function s(t){return/^[_a-zA-Z0-9-]+$/.test(t)}var u,l;return u={val:"tt-selectable-display",obj:"tt-selectable-object"},l=e.getIdGenerator(),n.extractData=function(e){var n=t(e);return n.data(u.obj)?{val:n.data(u.val)||"",obj:n.data(u.obj)||null}:null},e.mixin(n.prototype,r,{_overwrite:function(t,e){e=e||[],e.length?this._renderSuggestions(t,e):this.async&&this.templates.pending?this._renderPending(t):!this.async&&this.templates.notFound?this._renderNotFound(t):this._empty(),this.trigger("rendered",this.name,e,!1)},_append:function(t,e){e=e||[],e.length&&this.$lastSuggestion.length?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(t),this.trigger("rendered",this.name,e,!0)},_renderSuggestions:function(t,e){var n;n=this._getSuggestionsFragment(t,e),this.$lastSuggestion=n.children().last(),this.$el.html(n).prepend(this._getHeader(t,e)).append(this._getFooter(t,e))},_appendSuggestions:function(t,e){var n,i;n=this._getSuggestionsFragment(t,e),i=n.children().last(),this.$lastSuggestion.after(n),this.$lastSuggestion=i},_renderPending:function(t){var e=this.templates.pending;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_renderNotFound:function(t){var e=this.templates.notFound;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(n,i){var r,a=this;return r=document.createDocumentFragment(),e.each(i,function(e){var i,o;o=a._injectQuery(n,e),i=t(a.templates.suggestion(o)).data(u.obj,e).data(u.val,a.displayFn(e)).addClass(a.classes.suggestion+" "+a.classes.selectable),r.appendChild(i[0])}),this.highlight&&o({className:this.classes.highlight,node:r,pattern:n}),t(r)},_getFooter:function(t,e){return this.templates.footer?this.templates.footer({query:t,suggestions:e,dataset:this.name}):null},_getHeader:function(t,e){return this.templates.header?this.templates.header({query:t,suggestions:e,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=t()},_injectQuery:function(t,n){return e.isObject(n)?e.mixin({_query:t},n):n},update:function(e){function n(t){a||(a=!0,t=(t||[]).slice(0,r.limit),s=t.length,r._overwrite(e,t),s<r.limit&&r.async&&r.trigger("asyncRequested",e))}function i(n){n=n||[],!o&&s<r.limit&&(r.cancel=t.noop,s+=n.length,r._append(e,n.slice(0,r.limit-s)),r.async&&r.trigger("asyncReceived",e))}var r=this,o=!1,a=!1,s=0;this.cancel(),this.cancel=function(){o=!0,r.cancel=t.noop,r.async&&r.trigger("asyncCanceled",e)},this.source(e,n,i),!a&&n([])},cancel:t.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=t("<div>")}}),n}(),u=function(){"use strict";function n(n,i){function r(e){var n=o.$node.find(e.node).first();return e.node=n.length?n:t("<div>").appendTo(o.$node),new s(e,i)}var o=this;n=n||{},n.node||t.error("node is required"),i.mixin(this),this.$node=t(n.node),this.query=null,this.datasets=e.map(n.datasets,r)}return e.mixin(n.prototype,r,{_onSelectableClick:function(e){this.trigger("selectableClicked",t(e.currentTarget))},_onRendered:function(t,e,n,i){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",e,n,i)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){function t(t){return t.isEmpty()}return e.every(this.datasets,t)},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var t=this.getActiveSelectable();t&&t.removeClass(this.classes.cursor)},_ensureVisible:function(t){var e,n,i,r;e=t.position().top,n=e+t.outerHeight(!0),i=this.$node.scrollTop(),r=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),0>e?this.$node.scrollTop(i+e):n>r&&this.$node.scrollTop(i+(n-r))},bind:function(){var t,n=this;return t=e.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,t),e.each(this.datasets,function(t){t.onSync("asyncRequested",n._propagate,n).onSync("asyncCanceled",n._propagate,n).onSync("asyncReceived",n._propagate,n).onSync("rendered",n._onRendered,n).onSync("cleared",n._onCleared,n)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(t){this.$node.attr("dir",t)},selectableRelativeToCursor:function(t){var e,n,i,r;return n=this.getActiveSelectable(),e=this._getSelectables(),i=n?e.index(n):-1,r=i+t,r=(r+1)%(e.length+1)-1,r=-1>r?e.length-1:r,-1===r?null:e.eq(r)},setCursor:function(t){this._removeCursor(),(t=t&&t.first())&&(t.addClass(this.classes.cursor),this._ensureVisible(t))},getSelectableData:function(t){return t&&t.length?s.extractData(t):null},getActiveSelectable:function(){var t=this._getSelectables().filter(this.selectors.cursor).first();return t.length?t:null},getTopSelectable:function(){var t=this._getSelectables().first();return t.length?t:null},update:function(t){function n(e){e.update(t)}var i=t!==this.query;return i&&(this.query=t,e.each(this.datasets,n)),i},empty:function(){function t(t){t.clear()}e.each(this.datasets,t),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){function n(t){t.destroy()}this.$node.off(".tt"),this.$node=t("<div>"),e.each(this.datasets,n)}}),n}(),l=function(){"use strict";function t(){u.apply(this,[].slice.call(arguments,0))}var n=u.prototype;return e.mixin(t.prototype,u.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),n.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),n.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(t){return this.$node.css("ltr"===t?this.css.ltr:this.css.rtl),n.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),t}(),c=function(){"use strict";function n(n,r){var o,a,s,u,l,c,h,f,d,p,m;n=n||{},n.input||t.error("missing input"),n.menu||t.error("missing menu"),n.eventBus||t.error("missing event bus"),r.mixin(this),this.eventBus=n.eventBus,this.minLength=e.isNumber(n.minLength)?n.minLength:1,this.input=n.input,this.menu=n.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),o=i(this,"activate","open","_onFocused"),a=i(this,"deactivate","_onBlurred"),s=i(this,"isActive","isOpen","_onEnterKeyed"),u=i(this,"isActive","isOpen","_onTabKeyed"),l=i(this,"isActive","_onEscKeyed"),c=i(this,"isActive","open","_onUpKeyed"),h=i(this,"isActive","open","_onDownKeyed"),f=i(this,"isActive","isOpen","_onLeftKeyed"),d=i(this,"isActive","isOpen","_onRightKeyed"),p=i(this,"_openIfActive","_onQueryChanged"),m=i(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",o,this).onSync("blurred",a,this).onSync("enterKeyed",s,this).onSync("tabKeyed",u,this).onSync("escKeyed",l,this).onSync("upKeyed",c,this).onSync("downKeyed",h,this).onSync("leftKeyed",f,this).onSync("rightKeyed",d,this).onSync("queryChanged",p,this).onSync("whitespaceChanged",m,this).onSync("langDirChanged",this._onLangDirChanged,this)}function i(t){var n=[].slice.call(arguments,1);return function(){var i=[].slice.call(arguments);e.each(n,function(e){return t[e].apply(t,i)})}}return e.mixin(n.prototype,{_hacks:function(){var n,i;n=this.input.$input||t("<div>"),i=this.menu.$node||t("<div>"),n.on("blur.tt",function(t){var r,o,a;r=document.activeElement,o=i.is(r),a=i.has(r).length>0,e.isMsie()&&(o||a)&&(t.preventDefault(),t.stopImmediatePropagation(),e.defer(function(){n.focus()}))}),i.on("mousedown.tt",function(t){t.preventDefault()})},_onSelectableClicked:function(t,e){this.select(e)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(t,e,n,i){this._updateHint(),this.eventBus.trigger("render",n,i,e)},_onAsyncRequested:function(t,e,n){this.eventBus.trigger("asyncrequest",n,e)},_onAsyncCanceled:function(t,e,n){this.eventBus.trigger("asynccancel",n,e)},_onAsyncReceived:function(t,e,n){this.eventBus.trigger("asyncreceive",n,e)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())&&this.select(n)&&e.preventDefault()},_onTabKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&e.preventDefault():(n=this.menu.getTopSelectable())&&this.autocomplete(n)&&e.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(t,e){this._minLengthMet(e)?this.menu.update(e):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(t,e){this.dir!==e&&(this.dir=e,this.menu.setLanguageDirection(e))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(t){return t=e.isString(t)?t:this.input.getQuery()||"",t.length>=this.minLength},_updateHint:function(){var t,n,i,r,o,s,u;t=this.menu.getTopSelectable(),n=this.menu.getSelectableData(t),i=this.input.getInputValue(),!n||e.isBlankString(i)||this.input.hasOverflow()?this.input.clearHint():(r=a.normalizeQuery(i),o=e.escapeRegExChars(r),s=new RegExp("^(?:"+o+")(.+$)","i"),u=s.exec(n.val),u&&this.input.setHint(i+u[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return this.isActive()?!0:!this.isEnabled()||this.eventBus.before("active")?!1:(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return this.isActive()?this.eventBus.before("idle")?!1:(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0):!0},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(t){this.input.setQuery(e.toStr(t))},getVal:function(){return this.input.getQuery()},select:function(t){var e=this.menu.getSelectableData(t);return e&&!this.eventBus.before("select",e.obj)?(this.input.setQuery(e.val,!0),this.eventBus.trigger("select",e.obj),this.close(),!0):!1},autocomplete:function(t){var e,n,i;return e=this.input.getQuery(),n=this.menu.getSelectableData(t),i=n&&e!==n.val,i&&!this.eventBus.before("autocomplete",n.obj)?(this.input.setQuery(n.val),this.eventBus.trigger("autocomplete",n.obj),!0):!1},moveCursor:function(t){var e,n,i,r,o;return e=this.input.getQuery(),n=this.menu.selectableRelativeToCursor(t),i=this.menu.getSelectableData(n),r=i?i.obj:null,o=this._minLengthMet()&&this.menu.update(e),o||this.eventBus.before("cursorchange",r)?!1:(this.menu.setCursor(n),i?this.input.setInputValue(i.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",r),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),n}();!function(){"use strict";function r(e,n){e.each(function(){var e,i=t(this);(e=i.data(m.typeahead))&&n(e,i)})}function o(t,e){return t.clone().addClass(e.classes.hint).removeData().css(e.css.hint).css(h(t)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function s(t,e){t.data(m.attrs,{dir:t.attr("dir"),autocomplete:t.attr("autocomplete"),spellcheck:t.attr("spellcheck"),style:t.attr("style")}),t.addClass(e.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!t.attr("dir")&&t.attr("dir","auto")}catch(n){}return t}function h(t){return{backgroundAttachment:t.css("background-attachment"),backgroundClip:t.css("background-clip"),backgroundColor:t.css("background-color"),backgroundImage:t.css("background-image"),backgroundOrigin:t.css("background-origin"),backgroundPosition:t.css("background-position"),backgroundRepeat:t.css("background-repeat"),backgroundSize:t.css("background-size")}}function f(t){var n,i;n=t.data(m.www),i=t.parent().filter(n.selectors.wrapper),
e.each(t.data(m.attrs),function(n,i){e.isUndefined(n)?t.removeAttr(i):t.attr(i,n)}),t.removeData(m.typeahead).removeData(m.www).removeData(m.attr).removeClass(n.classes.input),i.length&&(t.detach().insertAfter(i),i.remove())}function d(n){var i,r;return i=e.isJQuery(n)||e.isElement(n),r=i?t(n).first():[],r.length?r:null}var p,m,v;p=t.fn.typeahead,m={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},v={initialize:function(r,h){function f(){var n,f,v,y,g,_,x,b,w,S,M;e.each(h,function(t){t.highlight=!!r.highlight}),n=t(this),f=t(p.html.wrapper),v=d(r.hint),y=d(r.menu),g=r.hint!==!1&&!v,_=r.menu!==!1&&!y,g&&(v=o(n,p)),_&&(y=t(p.html.menu).css(p.css.menu)),v&&v.val(""),n=s(n,p),(g||_)&&(f.css(p.css.wrapper),n.css(g?p.css.input:p.css.inputWithNoHint),n.wrap(f).parent().prepend(g?v:null).append(_?y:null)),M=_?l:u,x=new i({el:n}),b=new a({hint:v,input:n},p),w=new M({node:y,datasets:h},p),S=new c({input:b,menu:w,eventBus:x,minLength:r.minLength},p),n.data(m.www,p),n.data(m.typeahead,S)}var p;return h=e.isArray(h)?h:[].slice.call(arguments,1),r=r||{},p=n(r.classNames),this.each(f)},isEnabled:function(){var t;return r(this.first(),function(e){t=e.isEnabled()}),t},enable:function(){return r(this,function(t){t.enable()}),this},disable:function(){return r(this,function(t){t.disable()}),this},isActive:function(){var t;return r(this.first(),function(e){t=e.isActive()}),t},activate:function(){return r(this,function(t){t.activate()}),this},deactivate:function(){return r(this,function(t){t.deactivate()}),this},isOpen:function(){var t;return r(this.first(),function(e){t=e.isOpen()}),t},open:function(){return r(this,function(t){t.open()}),this},close:function(){return r(this,function(t){t.close()}),this},select:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.select(i)}),n},autocomplete:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.autocomplete(i)}),n},moveCursor:function(t){var e=!1;return r(this.first(),function(n){e=n.moveCursor(t)}),e},val:function(t){var e;return arguments.length?(r(this,function(e){e.setVal(t)}),this):(r(this.first(),function(t){e=t.getVal()}),e)},destroy:function(){return r(this,function(t,e){f(e),t.destroy()}),this}},t.fn.typeahead=function(t){return v[t]?v[t].apply(this,[].slice.call(arguments,1)):v.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=p,this}}()}),!function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return r(n?n:t)},c,c.exports,t,e,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t){return new a["default"](t)}var o=t("./src/draw"),a=i(o);window.mapboxgl?mapboxgl.Draw=r:"undefined"!=typeof e&&(e.exports=r)},{"./src/draw":7}],2:[function(t,e,n){var i=e.exports=function(t,e){if(e||(e=16),void 0===t&&(t=128),0>=t)return"0";for(var n=Math.log(Math.pow(2,t))/Math.log(e),r=2;n===1/0;r*=2)n=Math.log(Math.pow(2,t/r))/Math.log(e)*r;for(var o=n-Math.floor(n),a="",r=0;r<Math.floor(n);r++){var s=Math.floor(Math.random()*e).toString(e);a=s+a}if(o){var u=Math.pow(e,o),s=Math.floor(Math.random()*u).toString(e);a=s+a}var l=parseInt(a,e);return l!==1/0&&l>=Math.pow(2,t)?i(t,e):a};i.rack=function(t,e,n){var r=function(r){var a=0;do{if(a++>10){if(!n)throw new Error("too many ID collisions, use more bits");t+=n}var s=i(t,e)}while(Object.hasOwnProperty.call(o,s));return o[s]=r,s},o=r.hats={};return r.get=function(t){return r.hats[t]},r.set=function(t,e){return r.hats[t]=e,r},r.bits=t||128,r.base=e||16,r}},{}],3:[function(t,e,n){"use strict";function i(t,e){this.x=t,this.y=e}e.exports=i,i.prototype={clone:function(){return new i(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,r=n*this.x+e*this.y;return this.x=i,this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t}},{}],4:[function(t,e,n){(function(){"use strict";var t={"@@functional/placeholder":!0},i=function(t,e){switch(t){case 0:return function(){return e.apply(this,arguments)};case 1:return function(t){return e.apply(this,arguments)};case 2:return function(t,n){return e.apply(this,arguments)};case 3:return function(t,n,i){return e.apply(this,arguments)};case 4:return function(t,n,i,r){return e.apply(this,arguments)};case 5:return function(t,n,i,r,o){return e.apply(this,arguments)};case 6:return function(t,n,i,r,o,a){return e.apply(this,arguments)};case 7:return function(t,n,i,r,o,a,s){return e.apply(this,arguments)};case 8:return function(t,n,i,r,o,a,s,u){return e.apply(this,arguments)};case 9:return function(t,n,i,r,o,a,s,u,l){return e.apply(this,arguments)};case 10:return function(t,n,i,r,o,a,s,u,l,c){return e.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}},r=function(t){return new RegExp(t.source,(t.global?"g":"")+(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.sticky?"y":"")+(t.unicode?"u":""))},o=function(t){return function(){return!t.apply(this,arguments)}},a=function(t,e){t=t||[],e=e||[];var n,i=t.length,r=e.length,o=[];for(n=0;i>n;)o[o.length]=t[n],n+=1;for(n=0;r>n;)o[o.length]=e[n],n+=1;return o},s=function(t,e,n){for(var i=0,r=n.length;r>i;){if(t(e,n[i]))return!0;i+=1}return!1},u=function(t){return function e(n){return 0===arguments.length?e:null!=n&&n["@@functional/placeholder"]===!0?e:t.apply(this,arguments)}},l=function(t){return function e(n,i){var r=arguments.length;return 0===r?e:1===r&&null!=n&&n["@@functional/placeholder"]===!0?e:1===r?u(function(e){return t(n,e)}):2===r&&null!=n&&n["@@functional/placeholder"]===!0&&null!=i&&i["@@functional/placeholder"]===!0?e:2===r&&null!=n&&n["@@functional/placeholder"]===!0?u(function(e){return t(e,i)}):2===r&&null!=i&&i["@@functional/placeholder"]===!0?u(function(e){return t(n,e)}):t(n,i)}},c=function(t){return function e(n,i,r){var o=arguments.length;return 0===o?e:1===o&&null!=n&&n["@@functional/placeholder"]===!0?e:1===o?l(function(e,i){return t(n,e,i)}):2===o&&null!=n&&n["@@functional/placeholder"]===!0&&null!=i&&i["@@functional/placeholder"]===!0?e:2===o&&null!=n&&n["@@functional/placeholder"]===!0?l(function(e,n){return t(e,i,n)}):2===o&&null!=i&&i["@@functional/placeholder"]===!0?l(function(e,i){return t(n,e,i)}):2===o?u(function(e){return t(n,i,e)}):3===o&&null!=n&&n["@@functional/placeholder"]===!0&&null!=i&&i["@@functional/placeholder"]===!0&&null!=r&&r["@@functional/placeholder"]===!0?e:3===o&&null!=n&&n["@@functional/placeholder"]===!0&&null!=i&&i["@@functional/placeholder"]===!0?l(function(e,n){return t(e,n,r)}):3===o&&null!=n&&n["@@functional/placeholder"]===!0&&null!=r&&r["@@functional/placeholder"]===!0?l(function(e,n){return t(e,i,n)}):3===o&&null!=i&&i["@@functional/placeholder"]===!0&&null!=r&&r["@@functional/placeholder"]===!0?l(function(e,i){return t(n,e,i)}):3===o&&null!=n&&n["@@functional/placeholder"]===!0?u(function(e){return t(e,i,r)}):3===o&&null!=i&&i["@@functional/placeholder"]===!0?u(function(e){return t(n,e,r)}):3===o&&null!=r&&r["@@functional/placeholder"]===!0?u(function(e){return t(n,i,e)}):t(n,i,r)}},h=function lr(t,e,n){return function(){for(var r=[],o=0,a=t,s=0;s<e.length||o<arguments.length;){var u;s<e.length&&(null==e[s]||e[s]["@@functional/placeholder"]!==!0||o>=arguments.length)?u=e[s]:(u=arguments[o],o+=1),r[s]=u,null!=u&&u["@@functional/placeholder"]===!0||(a-=1),s+=1}return 0>=a?n.apply(this,r):i(a,lr(t,r,n))}},f=function(t,e){for(var n=0,i=e.length,r=[];i>n;)t(e[n])&&(r[r.length]=e[n]),n+=1;return r},d=function(t){return{"@@transducer/value":t,"@@transducer/reduced":!0}},p=function(t){return function(e){return f(function(t){return"function"==typeof e[t]},t(e))}},m=function(t,e){return Object.prototype.hasOwnProperty.call(e,t)},v=function(t){return t},y=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)},g=Number.isInteger||function(t){return t<<0===t},_=function(t){return"[object Number]"===Object.prototype.toString.call(t)},x=function(t){return"[object String]"===Object.prototype.toString.call(t)},b=function(t){return"function"==typeof t["@@transducer/step"]},w=function(t,e){for(var n=0,i=e.length,r=Array(i);i>n;)r[n]=t(e[n]),n+=1;return r},S=function(t,e){return function(){return e.call(this,t.apply(this,arguments))}},M=function(t,e){return function(){var n=this;return t.apply(n,arguments).then(function(t){return e.call(n,t)})}},E=function(t){return'"'+t.replace(/"/g,'\\"')+'"'},T=function(t){return t&&t["@@transducer/reduced"]?t:{"@@transducer/value":t,"@@transducer/reduced":!0}},D=function cr(t,e,n){switch(arguments.length){case 1:return cr(t,0,t.length);case 2:return cr(t,e,t.length);default:for(var i=[],r=0,o=Math.max(0,Math.min(t.length,n)-e);o>r;)i[r]=t[e+r],r+=1;return i}},I=function(){var t=function(t){return(10>t?"0":"")+t};return"function"==typeof Date.prototype.toISOString?function(t){return t.toISOString()}:function(e){return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),z=function(){function t(t,e){this.xf=e,this.pred=t,this.lastValue=void 0,this.seenFirstValue=!1}return t.prototype["@@transducer/init"]=function(){return this.xf["@@transducer/init"]()},t.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){var n=!1;return this.seenFirstValue?this.pred(this.lastValue,e)&&(n=!0):this.seenFirstValue=!0,this.lastValue=e,n?t:this.xf["@@transducer/step"](t,e)},l(function(e,n){return new t(e,n)})}(),A={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}},k=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=A.result,t.prototype["@@transducer/step"]=function(t,e){return this.f(e)?this.xf["@@transducer/step"](t,e):t},l(function(e,n){return new t(e,n)})}(),L=function(){function t(t,e){this.xf=e,this.f=t,this.found=!1}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,void 0)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)&&(this.found=!0,t=T(this.xf["@@transducer/step"](t,e))),t},l(function(e,n){return new t(e,n)})}(),C=function(){function t(t,e){this.xf=e,this.f=t,this.idx=-1,this.found=!1}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,-1)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.idx+=1,this.f(e)&&(this.found=!0,t=T(this.xf["@@transducer/step"](t,this.idx))),t},l(function(e,n){return new t(e,n)})}(),P=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](t,this.last))},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)&&(this.last=e),t},l(function(e,n){return new t(e,n)})}(),F=function(){function t(t,e){this.xf=e,this.f=t,this.idx=-1,this.lastIdx=-1}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](t,this.lastIdx))},t.prototype["@@transducer/step"]=function(t,e){return this.idx+=1,this.f(e)&&(this.lastIdx=this.idx),t},l(function(e,n){return new t(e,n)})}(),j=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=A.result,t.prototype["@@transducer/step"]=function(t,e){return this.xf["@@transducer/step"](t,this.f(e))},l(function(e,n){return new t(e,n)})}(),O=function(){function t(t,e){this.xf=e,this.n=t}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=A.result,t.prototype["@@transducer/step"]=function(t,e){return 0===this.n?T(t):(this.n-=1,this.xf["@@transducer/step"](t,e))},l(function(e,n){return new t(e,n)})}(),R=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=A.result,t.prototype["@@transducer/step"]=function(t,e){return this.f(e)?this.xf["@@transducer/step"](t,e):T(t)},l(function(e,n){return new t(e,n)})}(),N=function(){function t(t){this.f=t}return t.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},t.prototype["@@transducer/result"]=function(t){return t},t.prototype["@@transducer/step"]=function(t,e){return this.f(t,e)},function(e){return new t(e)}}(),B=l(function(t,e){return t+e}),q=c(function(t,e,n){if(e>=n.length||e<-n.length)return n;var i=0>e?n.length:0,r=i+e,o=a(n);return o[r]=t(n[r]),o}),U=u(function(t){return function(){return t}}),V=l(function(t,e){for(var n=0,i=e.length-(t-1),r=new Array(i>=0?i:0);i>n;)r[n]=D(e,n,n+t),n+=1;return r}),H=l(function(t,e){return a(e,[t])}),G=l(function(t,e){return t.apply(this,e)}),Y=c(function(t,e,n){var i={};for(var r in n)i[r]=n[r];return i[t]=e,i}),X=c(function hr(t,e,n){switch(t.length){case 0:return n;case 1:return Y(t[0],e,n);default:return Y(t[0],hr(D(t,1),e,Object(n[t[0]])),n)}}),$=l(function(t,e){return i(t.length,function(){return t.apply(e,arguments)})}),W=l(function(t,e){return function(){return t.apply(this,arguments)&&e.apply(this,arguments)}}),Z=u(function(t){return function(e,n){return t(e,n)?-1:t(n,e)?1:0}}),K=u(o),J=u(function(t){return function(){for(var e=0;e<t.length;){if(t[e][0].apply(this,arguments))return t[e][1].apply(this,arguments);e+=1}}}),Q=c(s),tt=l(function(t,e){for(var n={},i=e.length,r=0;i>r;){var o=t(e[r]);n[o]=(m(o,n)?n[o]:0)+1,r+=1}return n}),et=l(function(t,e){var n={};return n[t]=e,n}),nt=l(function(t,e){return 1===t?u(e):i(t,h(t,[],e))}),it=B(-1),rt=l(function(t,e){return null==e?t:e}),ot=c(function(t,e,n){for(var i=[],r=0,o=e.length,a=Q(t);o>r;)a(e[r],n)||a(e[r],i)||(i[i.length]=e[r]),r+=1;return i}),at=l(function(t,e){var n={};for(var i in e)i!==t&&(n[i]=e[i]);return n}),st=l(function fr(t,e){switch(t.length){case 0:return e;case 1:return at(t[0],e);default:var n=t[0],i=D(t,1);return null==e[n]?e:Y(n,fr(i,e[n]),e)}}),ut=l(function(t,e){return t/e}),lt=l(function(t,e){for(var n=e.length-1;n>=0&&t(e[n]);)n-=1;return D(e,0,n+1)}),ct=l(function(t,e){return function(){return t.apply(this,arguments)||e.apply(this,arguments)}}),ht=u(function(t){if(null!=t&&"function"==typeof t.empty)return t.empty();if(null!=t&&null!=typeof t.constructor&&"function"==typeof t.constructor.empty)return t.constructor.empty();switch(Object.prototype.toString.call(t)){case"[object Array]":return[];case"[object Object]":return{};case"[object String]":return""}}),ft=l(function dr(t,e){var n,i,r,o={};for(i in e)n=t[i],r=typeof n,o[i]="function"===r?n(e[i]):"object"===r?dr(t[i],e[i]):e[i];return o}),dt=u(function(t){for(var e=0,n=t.length,i={};n>e;)y(t[e])&&t[e].length&&(i[t[e][0]]=t[e][1]),e+=1;return i}),pt=l(function(t,e){return t>e}),mt=l(function(t,e){return t>=e}),vt=l(m),yt=l(function(t,e){return t in e}),gt=l(function(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}),_t=u(v),xt=c(function(t,e,n){return nt(Math.max(t.length,e.length,n.length),function(){return t.apply(this,arguments)?e.apply(this,arguments):n.apply(this,arguments)})}),bt=B(1),wt=c(function(t,e,n){t=t<n.length&&t>=0?t:n.length;var i=D(n);return i.splice(t,0,e),i}),St=c(function(t,e,n){return t=t<n.length&&t>=0?t:n.length,a(a(D(n,0,t),e),D(n,t))}),Mt=l(function(t,e){return null!=e&&e.constructor===t||e instanceof t}),Et=u(function(t){return y(t)?!0:t?"object"!=typeof t?!1:t instanceof String?!1:1===t.nodeType?!!t.length:0===t.length?!0:t.length>0?t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1):!1:!1}),Tt=u(function(t){return 0===Object(t).length}),Dt=u(function(t){return null==t}),It=function(){var t=!{toString:null}.propertyIsEnumerable("toString"),e=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],n=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1};return u("function"==typeof Object.keys?function(t){return Object(t)!==t?[]:Object.keys(t)}:function(i){if(Object(i)!==i)return[];var r,o,a=[];for(r in i)m(r,i)&&(a[a.length]=r);if(t)for(o=e.length-1;o>=0;)r=e[o],m(r,i)&&!n(a,r)&&(a[a.length]=r),o-=1;return a})}(),zt=u(function(t){var e,n=[];for(e in t)n[n.length]=e;return n}),At=u(function(t){return null!=t&&Mt(Number,t.length)?t.length:NaN}),kt=l(function(t,e){return e>t}),Lt=l(function(t,e){return e>=t}),Ct=c(function(t,e,n){for(var i=0,r=n.length,o=[],a=[e];r>i;)a=t(a[0],n[i]),o[i]=a[1],i+=1;return[a[0],o]}),Pt=c(function(t,e,n){for(var i=n.length-1,r=[],o=[e];i>=0;)o=t(o[0],n[i]),r[i]=o[1],i-=1;return[o[0],r]}),Ft=l(function(t,e){return e.match(t)||[]}),jt=l(function(t,e){return g(t)?!g(e)||1>e?NaN:(t%e+e)%e:NaN}),Ot=l(function(t,e){return e>t?e:t}),Rt=c(function(t,e,n){return t(n)>t(e)?n:e}),Nt=l(function(t,e){for(var n={},i=It(t),r=0;r<i.length;)n[i[r]]=t[i[r]],r+=1;for(i=It(e),r=0;r<i.length;)n[i[r]]=e[i[r]],r+=1;return n}),Bt=l(function(t,e){return t>e?e:t}),qt=c(function(t,e,n){return t(n)<t(e)?n:e}),Ut=l(function(t,e){return t%e}),Vt=l(function(t,e){return t*e}),Ht=l(function(t,e){switch(t){case 0:return function(){return e.call(this)};case 1:return function(t){return e.call(this,t)};case 2:return function(t,n){return e.call(this,t,n)};case 3:return function(t,n,i){return e.call(this,t,n,i)};case 4:return function(t,n,i,r){return e.call(this,t,n,i,r)};case 5:return function(t,n,i,r,o){return e.call(this,t,n,i,r,o)};case 6:return function(t,n,i,r,o,a){return e.call(this,t,n,i,r,o,a)};case 7:return function(t,n,i,r,o,a,s){return e.call(this,t,n,i,r,o,a,s)};case 8:return function(t,n,i,r,o,a,s,u){return e.call(this,t,n,i,r,o,a,s,u)};case 9:return function(t,n,i,r,o,a,s,u,l){return e.call(this,t,n,i,r,o,a,s,u,l)};case 10:return function(t,n,i,r,o,a,s,u,l,c){return e.call(this,t,n,i,r,o,a,s,u,l,c)};default:throw new Error("First argument to nAry must be a non-negative integer no greater than ten")}}),Gt=u(function(t){return-t}),Yt=u(function(t){return!t}),Xt=l(function(t,e){var n=0>t?e.length+t:t;return x(e)?e.charAt(n):e[n]}),$t=u(function(t){return function(){return Xt(t,arguments)}}),Wt=l(function(t,e){return e.charAt(0>t?e.length+t:t)}),Zt=l(function(t,e){return e.charCodeAt(0>t?e.length+t:t)}),Kt=u(function(t){return[t]}),Jt=u(function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments))}}),Qt=function(){var t=function(e){return{value:e,map:function(n){return t(n(e))}}};return c(function(e,n,i){return e(function(e){return t(n(e))})(i).value})}(),te=l(function(t,e){if(null!=e){for(var n=e,i=0,r=t.length;r>i&&null!=n;i+=1)n=n[t[i]];return n}}),ee=l(function(t,e){for(var n={},i=0;i<t.length;)t[i]in e&&(n[t[i]]=e[t[i]]),i+=1;return n}),ne=l(function(t,e){for(var n={},i=0,r=t.length;r>i;){var o=t[i];n[o]=e[o],i+=1}return n}),ie=l(function(t,e){var n={};for(var i in e)t(e[i],i,e)&&(n[i]=e[i]);return n}),re=l(function(t,e){return a([t],e)}),oe=l(function(t,e){return e[t]}),ae=c(function(t,e,n){return null!=n&&m(e,n)?n[e]:t}),se=c(function(t,e,n){return t(n[e])}),ue=l(function(t,e){for(var n=t.length,i=[],r=0;n>r;)i[r]=e[t[r]],r+=1;return i}),le=l(function(t,e){if(!_(t)||!_(e))throw new TypeError("Both arguments to range must be numbers");for(var n=[],i=t;e>i;)n.push(i),i+=1;return n}),ce=c(function(t,e,n){for(var i=n.length-1;i>=0;)e=t(e,n[i]),i-=1;return e}),he=u(T),fe=c(function(t,e,n){return a(D(n,0,Math.min(t,n.length)),D(n,Math.min(n.length,t+e)))}),de=c(function(t,e,n){return n.replace(t,e)}),pe=u(function(t){return D(t).reverse()}),me=c(function(t,e,n){for(var i=0,r=n.length,o=[e];r>i;)e=t(e,n[i]),o[i+1]=e,i+=1;return o}),ve=c(function(t,e,n){return Qt(t,U(e),n)}),ye=l(function(t,e){return D(e).sort(t)}),ge=l(function(t,e){return D(e).sort(function(e,n){var i=t(e),r=t(n);return r>i?-1:i>r?1:0})}),_e=l(function(t,e){return t-e}),xe=l(function(t,e){for(var n=e.length-1;n>=0&&t(e[n]);)n-=1;return D(e,n+1,1/0)}),be=l(function(t,e){return t(e),e}),we=l(function(t,e){return r(t).test(e)}),Se=l(function(t,e){for(var n=Number(e),i=new Array(n),r=0;n>r;)i[r]=t(r),r+=1;return i}),Me=u(function(t){var e=[];for(var n in t)m(n,t)&&(e[e.length]=[n,t[n]]);return e}),Ee=u(function(t){var e=[];for(var n in t)e[e.length]=[n,t[n]];return e}),Te=function(){var t="	\n\x0B\f\r   ᠎             　\u2028\u2029\ufeff",e="​",n="function"==typeof String.prototype.trim;return u(n&&!t.trim()&&e.trim()?function(t){return t.trim()}:function(e){var n=new RegExp("^["+t+"]["+t+"]*"),i=new RegExp("["+t+"]["+t+"]*$");return e.replace(n,"").replace(i,"")})}(),De=u(function(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)}),Ie=u(function(t){return function(){return t(D(arguments))}}),ze=u(function(t){return Ht(1,t)}),Ae=l(function(t,e){return nt(t,function(){for(var n,i=1,r=e,o=0;t>=i&&"function"==typeof r;)n=i===t?arguments.length:o+r.length,r=r.apply(this,D(arguments,o,n)),i+=1,o=n;return r})}),ke=l(function(t,e){for(var n=t(e),i=[];n&&n.length;)i[i.length]=n[0],n=t(n[1]);return i}),Le=l(function(t,e){for(var n,i=0,r=e.length,o=[];r>i;)n=e[i],s(t,n,o)||(o[o.length]=n),i+=1;return o}),Ce=c(function(t,e,n){return q(U(e),t,n)}),Pe=u(function(t){for(var e=It(t),n=e.length,i=[],r=0;n>r;)i[r]=t[e[r]],r+=1;return i}),Fe=u(function(t){var e,n=[];for(e in t)n[n.length]=t[e];return n}),je=function(){var t=function(t){return{value:t,map:function(){return this}}};return l(function(e,n){return e(t)(n).value})}(),Oe=l(function(t,e){for(var n in t)if(m(n,t)&&!t[n](e[n]))return!1;return!0}),Re=l(function(t,e){return nt(t.length,function(){return e.apply(this,a([t],arguments))})}),Ne=l(function(t,e){for(var n,i=0,r=t.length,o=e.length,a=[];r>i;){for(n=0;o>n;)a[a.length]=[t[i],e[n]],n+=1;i+=1}return a}),Be=l(function(t,e){for(var n=[],i=0,r=Math.min(t.length,e.length);r>i;)n[i]=[t[i],e[i]],i+=1;return n}),qe=l(function(t,e){for(var n=0,i=t.length,r={};i>n;)r[t[n]]=e[n],n+=1;return r}),Ue=c(function(t,e,n){for(var i=[],r=0,o=Math.min(e.length,n.length);o>r;)i[r]=t(e[r],n[r]),r+=1;return i}),Ve=U(!1),He=U(!0),Ge=function(t,e){return function(){var n=arguments.length;if(0===n)return e();var i=arguments[n-1];return y(i)||"function"!=typeof i[t]?e.apply(this,arguments):i[t].apply(i,D(arguments,0,n-1))}},Ye=function pr(t,e,n){var i=function(i){for(var r=e.length,o=0;r>o;){if(t===e[o])return n[o];o+=1}e[o+1]=t,n[o+1]=i;for(var a in t)i[a]=pr(t[a],e,n);return i};switch(De(t)){case"Object":return i({});case"Array":return i([]);case"Date":return new Date(t);case"RegExp":return r(t);default:return t}},Xe=function(t){return function(e){var n=D(arguments,1);return i(Math.max(0,e.length-n.length),function(){return e.apply(this,t(n,arguments))})}},$e=function(t,e,n){return function(){var i=arguments.length;if(0===i)return n();var r=arguments[i-1];if(!y(r)){var o=D(arguments,0,i-1);if("function"==typeof r[t])return r[t].apply(r,o);if(b(r)){var a=e.apply(null,o);return a(r)}}return n.apply(this,arguments)}},We=function mr(t,e,n,i){var r=De(t);if(r!==De(e))return!1;if("Boolean"===r||"Number"===r||"String"===r)return"object"==typeof t?"object"==typeof e&&gt(t.valueOf(),e.valueOf()):gt(t,e);if(gt(t,e))return!0;if("RegExp"===r)return t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline&&t.sticky===e.sticky&&t.unicode===e.unicode;if(Object(t)===t){if("Date"===r&&t.getTime()!==e.getTime())return!1;var o=It(t);if(o.length!==It(e).length)return!1;for(var a=n.length-1;a>=0;){if(n[a]===t)return i[a]===e;a-=1}for(n[n.length]=t,i[i.length]=e,a=o.length-1;a>=0;){var s=o[a];if(!m(s,e)||!mr(e[s],t[s],n,i))return!1;a-=1}return n.pop(),i.pop(),!0}return!1},Ze=function(t,e){return null!=e&&!y(e)&&"function"==typeof e[t]},Ke=function(t){return function e(n){for(var i,r,o,a=[],s=0,u=n.length;u>s;){if(Et(n[s]))for(i=t?e(n[s]):n[s],r=0,o=i.length;o>r;)a[a.length]=i[r],r+=1;else a[a.length]=n[s];s+=1}return a}},Je=function(){function t(t,e,n){for(var i=0,r=n.length;r>i;){if(e=t["@@transducer/step"](e,n[i]),e&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}i+=1}return t["@@transducer/result"](e)}function e(t,e,n){for(var i=n.next();!i.done;){if(e=t["@@transducer/step"](e,i.value),e&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}i=n.next()}return t["@@transducer/result"](e)}function n(t,e,n){return t["@@transducer/result"](n.reduce($(t["@@transducer/step"],t),e))}var i="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";return function(r,o,a){if("function"==typeof r&&(r=N(r)),Et(a))return t(r,o,a);if("function"==typeof a.reduce)return n(r,o,a);if(null!=a[i])return e(r,o,a[i]());if("function"==typeof a.next)return e(r,o,a);throw new TypeError("reduce: list must be array or iterable")}}(),Qe=function(){var t={"@@transducer/init":Array,"@@transducer/step":function(t,e){return a(t,[e])},"@@transducer/result":v},e={"@@transducer/init":String,"@@transducer/step":function(t,e){return t+e},"@@transducer/result":v},n={"@@transducer/init":Object,"@@transducer/step":function(t,e){return Nt(t,Et(e)?et(e[0],e[1]):e)},"@@transducer/result":v};return function(i){if(b(i))return i;if(Et(i))return t;if("string"==typeof i)return e;if("object"==typeof i)return n;throw new Error("Cannot create transformer for "+i)}}(),tn=function(){function t(t,e){this.xf=e,this.f=t,this.all=!0}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=function(t){return this.all&&(t=this.xf["@@transducer/step"](t,!0)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)||(this.all=!1,t=T(this.xf["@@transducer/step"](t,!1))),t},l(function(e,n){return new t(e,n)})}(),en=function(){function t(t,e){this.xf=e,this.f=t,this.any=!1}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=function(t){return this.any||(t=this.xf["@@transducer/step"](t,!1)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)&&(this.any=!0,t=T(this.xf["@@transducer/step"](t,!0))),t},l(function(e,n){return new t(e,n)})}(),nn=function(){function t(t,e){this.xf=e,this.n=t}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=A.result,t.prototype["@@transducer/step"]=function(t,e){return this.n>0?(this.n-=1,t):this.xf["@@transducer/step"](t,e)},l(function(e,n){return new t(e,n)})}(),rn=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=A.result,t.prototype["@@transducer/step"]=function(t,e){if(this.f){if(this.f(e))return t;this.f=null}return this.xf["@@transducer/step"](t,e)},l(function(e,n){return new t(e,n)})}(),on=function(){function t(t,e){this.xf=e,this.f=t,this.inputs={}}return t.prototype["@@transducer/init"]=A.init,t.prototype["@@transducer/result"]=function(t){var e;for(e in this.inputs)if(m(e,this.inputs)&&(t=this.xf["@@transducer/step"](t,this.inputs[e]),t["@@transducer/reduced"])){t=t["@@transducer/value"];break}return this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){var n=this.f(e);return this.inputs[n]=this.inputs[n]||[n,[]],this.inputs[n][1]=H(e,this.inputs[n][1]),t},l(function(e,n){return new t(e,n)})}(),an=u(function(t){return nt(t.length,function(){var e=0,n=arguments[0],i=arguments[arguments.length-1],r=D(arguments);return r[0]=function(){var t=n.apply(this,a(arguments,[e,i]));return e+=1,t},t.apply(this,r)})}),sn=l($e("all",tn,function(t,e){for(var n=0;n<e.length;){if(!t(e[n]))return!1;n+=1}return!0})),un=l(function(t,e){return Ze("and",t)?t.and(e):t&&e}),ln=l($e("any",en,function(t,e){for(var n=0;n<e.length;){if(t(e[n]))return!0;n+=1}return!1})),cn=u(function(t){return Ht(2,t)}),hn=u(function(t){return Ye(t,[],[])}),fn=l(function(t,e){if(y(e))return a(t,e);if(Ze("concat",t))return t.concat(e);throw new TypeError("can't concat "+typeof t)}),dn=u(function(t){return nt(t.length,t)}),pn=l($e("dropWhile",rn,function(t,e){for(var n=0,i=e.length;i>n&&t(e[n]);)n+=1;return D(e,n)})),mn=l(function(t,e){return Ze("equals",t)?t.equals(e):Ze("equals",e)?e.equals(t):We(t,e,[],[])}),vn=l($e("filter",k,f)),yn=l($e("find",L,function(t,e){for(var n=0,i=e.length;i>n;){if(t(e[n]))return e[n];n+=1}})),gn=l($e("findIndex",C,function(t,e){for(var n=0,i=e.length;i>n;){if(t(e[n]))return n;n+=1}return-1})),_n=l($e("findLast",P,function(t,e){for(var n=e.length-1;n>=0;){if(t(e[n]))return e[n];n-=1}})),xn=l($e("findLastIndex",F,function(t,e){for(var n=e.length-1;n>=0;){if(t(e[n]))return n;n-=1}return-1})),bn=u(Ke(!0)),wn=u(function(t){return dn(function(e,n){var i=D(arguments);return i[0]=n,i[1]=e,t.apply(this,i)})}),Sn=l(Ge("forEach",function(t,e){for(var n=e.length,i=0;n>i;)t(e[i]),i+=1;return e})),Mn=u(p(It)),En=u(p(zt)),Tn=l($e("groupBy",on,function(t,e){return Je(function(e,n){var i=t(n);return e[i]=H(n,e[i]||(e[i]=[])),e},{},e)})),Dn=Xt(0),In=c(function(t,e,n){for(var i=[],r=0;r<e.length;)s(t,e[r],n)&&(i[i.length]=e[r]),r+=1;return Le(t,i)}),zn=l(Ge("intersperse",function(t,e){for(var n=[],i=0,r=e.length;r>i;)i===r-1?n.push(e[i]):n.push(e[i],t),i+=1;return n})),An=c(function(t,e,n){return b(t)?Je(e(t),t["@@transducer/init"](),n):Je(e(Qe(t)),t,n)}),kn=u(function(t){for(var e=It(t),n=e.length,i=0,r={};n>i;){var o=e[i],a=t[o],s=m(a,r)?r[a]:r[a]=[];s[s.length]=o,i+=1}return r}),Ln=u(function(t){for(var e=It(t),n=e.length,i=0,r={};n>i;){var o=e[i];r[t[o]]=o,i+=1}return r}),Cn=Xt(-1),Pn=l(function(t,e){if(Ze("lastIndexOf",e))return e.lastIndexOf(t);for(var n=e.length-1;n>=0;){if(mn(e[n],t))return n;n-=1}return-1}),Fn=l($e("map",j,w)),jn=l(function(t,e){return Je(function(n,i){return n[i]=t(e[i]),n},{},It(e))}),On=l(function(t,e){return Je(function(n,i){return n[i]=t(e[i],i,e),n},{},It(e))}),Rn=l(o($e("any",en,ln))),Nn=l(function(t,e){return Ze("or",t)?t.or(e):t||e}),Bn=dn(Xe(a)),qn=dn(Xe(wn(a))),Un=l(function(t,e){return Je(function(e,n){var i=e[t(n)?0:1];return i[i.length]=n,e},[[],[]],e)}),Vn=c(function(t,e,n){
return mn(te(t,n),e)}),Hn=l(function(t,e){return Fn(oe(t),e)}),Gn=c(function(t,e,n){return se(mn(e),t,n)}),Yn=c(function(t,e,n){return se(Mt(t),e,n)}),Xn=c(Je),$n=l(function(t,e){return vn(o(t),e)}),Wn=l(function(t,e){return Se(U(t),e)}),Zn=c(Ge("slice",function(t,e,n){return Array.prototype.slice.call(n,t,e)})),Kn=l(function(t,e){if(0>=t)throw new Error("First argument to splitEvery must be a positive integer");for(var n=[],i=0;i<e.length;)n.push(Zn(i,i+=t,e));return n}),Jn=Xn(B,0),Qn=Ge("tail",Zn(1,1/0)),ti=l($e("take",O,function(t,e){return Zn(0,0>t?1/0:t,e)})),ei=l($e("takeWhile",R,function(t,e){for(var n=0,i=e.length;i>n&&t(e[n]);)n+=1;return D(e,0,n)})),ni=nt(4,function(t,e,n,i){return Je(t("function"==typeof e?N(e):e),n,i)}),ii=c(function(t,e,n){return Le(t,a(e,n))}),ri=Le(mn),oi=u(Ke(!1)),ai=dn(function(t){var e=D(arguments,1),n=e.length;return dn(i(n,function(){for(var i=[],r=0;n>r;)i[r]=e[r](arguments[r]),r+=1;return t.apply(this,i.concat(D(arguments,n)))}))}),si=l(function(t,e){return Oe(jn(mn,t),e)}),ui=function(){var t=function(t){return{"@@transducer/init":A.init,"@@transducer/result":function(e){return t["@@transducer/result"](e)},"@@transducer/step":function(e,n){var i=t["@@transducer/step"](e,n);return i["@@transducer/reduced"]?d(i):i}}};return function(e){var n=t(e);return{"@@transducer/init":A.init,"@@transducer/result":function(t){return n["@@transducer/result"](t)},"@@transducer/step":function(t,e){return Et(e)?Je(n,t,e):Je(n,t,[e])}}}}(),li=function(t,e,n){for(var i=n;i<t.length;){if(mn(t[i],e))return i;i+=1}return-1},ci=function(t){return function(e){var n=function(){var n=arguments;return t(function(t){return t.apply(null,n)},e)};return arguments.length>1?n.apply(null,D(arguments,1)):i(Math.max.apply(Math,Hn("length",e)),n)}},hi=l(function(t,e){return Fn(t,ui(e))}),fi=u(ci(sn)),di=u(ci(ln)),pi=l(function(t,e){return Ze("ap",t)?t.ap(e):Je(function(t,n){return a(t,Fn(n,e))},[],t)}),mi=dn(function(t){return t.apply(this,D(arguments,1))}),vi=l($e("chain",hi,function(t,e){return oi(Fn(t,e))})),yi=c(function(t,e,n){function i(e,n){return pi(Fn(H,t(n)),e)}return Je(i,e([]),n)}),gi=l(function(t,e){if(t>10)throw new Error("Constructor with greater than ten arguments");return 0===t?function(){return new e}:dn(Ht(t,function(t,n,i,r,o,a,s,u,l,c){switch(arguments.length){case 1:return new e(t);case 2:return new e(t,n);case 3:return new e(t,n,i);case 4:return new e(t,n,i,r);case 5:return new e(t,n,i,r,o);case 6:return new e(t,n,i,r,o,a);case 7:return new e(t,n,i,r,o,a,s);case 8:return new e(t,n,i,r,o,a,s,u);case 9:return new e(t,n,i,r,o,a,s,u,l);case 10:return new e(t,n,i,r,o,a,s,u,l,c)}}))}),_i=nt(3,function(t){var e=D(arguments,1);return nt(Math.max.apply(Math,Hn("length",e)),function(){var n=arguments,i=this;return t.apply(i,w(function(t){return t.apply(i,n)},e))})}),xi=l($e("drop",nn,function(t,e){return Zn(Math.max(0,t),1/0,e)})),bi=l(function(t,e){return ti(t<e.length?e.length-t:0,e)}),wi=l($e("dropRepeatsWith",z,function(t,e){var n=[],i=1,r=e.length;if(0!==r)for(n[0]=e[0];r>i;)t(Cn(n),e[i])||(n[n.length]=e[i]),i+=1;return n})),Si=c(function(t,e,n){return mn(e[t],n[t])}),Mi=l(function(t,e){return Ze("indexOf",e)?e.indexOf(t):li(e,t,0)}),Ei=Zn(0,-1),Ti=u(function(t){for(var e=t.length,n=0;e>n;){if(li(t,t[n],n+1)>=0)return!1;n+=1}return!0}),Di=l(function(t,e){return function(n){return function(i){return Fn(function(t){return e(t,i)},n(t(i)))}}}),Ii=u(function(t){return Di(Xt(t),Ce(t))}),zi=u(function(t){return Di(oe(t),Y(t))}),Ai=l(function(t,e){var n=nt(t,e);return nt(t,function(){return Je(pi,Fn(n,arguments[0]),D(arguments,1))})}),ki=u(function(t){return Jn(t)/t.length}),Li=u(function(t){var e=t.length;if(0===e)return NaN;var n=2-e%2,i=(e-n)/2;return ki(D(t).sort(function(t,e){return e>t?-1:t>e?1:0}).slice(i,i+n))}),Ci=u(function(t){return Xn(Nt,{},t)}),Pi=function(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return nt(arguments[0].length,Xn(S,arguments[0],Qn(arguments)))},Fi=function(){if(0===arguments.length)throw new Error("pipeP requires at least one argument");return nt(arguments[0].length,Xn(M,arguments[0],Qn(arguments)))},ji=Xn(Vt,1),Oi=ai(w,ne,_t),Ri=l(function(t,e){return xi(t>=0?e.length-t:0,e)}),Ni=function(t,e){return li(e,t,0)>=0},Bi=function vr(t,e){var n=function(n){var i=e.concat([t]);return Ni(n,i)?"<Circular>":vr(n,i)},i=function(t,e){return w(function(e){return E(e)+": "+n(t[e])},e.slice().sort())};switch(Object.prototype.toString.call(t)){case"[object Arguments]":return"(function() { return arguments; }("+w(n,t).join(", ")+"))";case"[object Array]":return"["+w(n,t).concat(i(t,$n(we(/^\d+$/),It(t)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof t?"new Boolean("+n(t.valueOf())+")":t.toString();case"[object Date]":return"new Date("+E(I(t))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof t?"new Number("+n(t.valueOf())+")":1/t===-(1/0)?"-0":t.toString(10);case"[object String]":return"object"==typeof t?"new String("+n(t.valueOf())+")":E(t);case"[object Undefined]":return"undefined";default:return"function"==typeof t.constructor&&"Object"!==t.constructor.name&&"function"==typeof t.toString&&"[object Object]"!==t.toString()?t.toString():"{"+i(t,It(t)).join(", ")+"}"}},qi=yi(_t),Ui=function(){if(0===arguments.length)throw new Error("compose requires at least one argument");return Pi.apply(this,pe(arguments))},Vi=function(){return 0===arguments.length?_t:Ui.apply(this,Fn(vi,arguments))},Hi=function(){if(0===arguments.length)throw new Error("composeP requires at least one argument");return Fi.apply(this,pe(arguments))},Gi=u(function(t){return gi(t.length,t)}),Yi=l(Ni),Xi=l(function(t,e){for(var n=[],i=0,r=t.length;r>i;)Ni(t[i],e)||Ni(t[i],n)||(n[n.length]=t[i]),i+=1;return n}),$i=u($e("dropRepeats",z(mn),wi(mn))),Wi=l(function(t,e){return ri(f(wn(Ni)(t),e))}),Zi=u(function(t){return Ai(t.length,t)}),Ki=l(function(t,e){var n={};for(var i in e)Ni(i,t)||(n[i]=e[i]);return n}),Ji=function(){return Vi.apply(this,pe(arguments))},Qi=u(function(t){return Bi(t,[])}),tr=l(Ui(ri,a)),er=l(function(t,e){for(var n,i,r=0,o=[],a=[];r<e.length;)i=e[r],n=t(i),Ni(n,o)||(a.push(i),o.push(n)),r+=1;return a}),nr=l(function(t,e){return nt(t+1,function(){var n=arguments[t];if(null!=n&&Mt(Function,n[e]))return n[e].apply(n,D(arguments,0,t));throw new TypeError(Qi(n)+' does not have a method named "'+e+'"')})}),ir=nr(1,"join"),rr=u(function(t){var e={};return function(){var n=Qi(arguments);return m(n,e)||(e[n]=t.apply(this,arguments)),e[n]}}),or=nr(1,"split"),ar=nr(0,"toLowerCase"),sr=nr(0,"toUpperCase"),ur={F:Ve,T:He,__:t,add:B,addIndex:an,adjust:q,all:sn,allPass:fi,always:U,and:un,any:ln,anyPass:di,ap:pi,aperture:V,append:H,apply:G,assoc:Y,assocPath:X,binary:cn,bind:$,both:W,call:mi,chain:vi,clone:hn,commute:qi,commuteMap:yi,comparator:Z,complement:K,compose:Ui,composeK:Vi,composeP:Hi,concat:fn,cond:J,construct:Gi,constructN:gi,contains:Yi,containsWith:Q,converge:_i,countBy:tt,createMapEntry:et,curry:dn,curryN:nt,dec:it,defaultTo:rt,difference:Xi,differenceWith:ot,dissoc:at,dissocPath:st,divide:ut,drop:xi,dropLast:bi,dropLastWhile:lt,dropRepeats:$i,dropRepeatsWith:wi,dropWhile:pn,either:ct,empty:ht,eqProps:Si,equals:mn,evolve:ft,filter:vn,find:yn,findIndex:gn,findLast:_n,findLastIndex:xn,flatten:bn,flip:wn,forEach:Sn,fromPairs:dt,functions:Mn,functionsIn:En,groupBy:Tn,gt:pt,gte:mt,has:vt,hasIn:yt,head:Dn,identical:gt,identity:_t,ifElse:xt,inc:bt,indexOf:Mi,init:Ei,insert:wt,insertAll:St,intersection:Wi,intersectionWith:In,intersperse:zn,into:An,invert:kn,invertObj:Ln,invoker:nr,is:Mt,isArrayLike:Et,isEmpty:Tt,isNil:Dt,isSet:Ti,join:ir,keys:It,keysIn:zt,last:Cn,lastIndexOf:Pn,length:At,lens:Di,lensIndex:Ii,lensProp:zi,lift:Zi,liftN:Ai,lt:kt,lte:Lt,map:Fn,mapAccum:Ct,mapAccumRight:Pt,mapObj:jn,mapObjIndexed:On,match:Ft,mathMod:jt,max:Ot,maxBy:Rt,mean:ki,median:Li,memoize:rr,merge:Nt,mergeAll:Ci,min:Bt,minBy:qt,modulo:Ut,multiply:Vt,nAry:Ht,negate:Gt,none:Rn,not:Yt,nth:Xt,nthArg:$t,nthChar:Wt,nthCharCode:Zt,of:Kt,omit:Ki,once:Jt,or:Nn,over:Qt,partial:Bn,partialRight:qn,partition:Un,path:te,pathEq:Vn,pick:ee,pickAll:ne,pickBy:ie,pipe:Pi,pipeK:Ji,pipeP:Fi,pluck:Hn,prepend:re,product:ji,project:Oi,prop:oe,propEq:Gn,propIs:Yn,propOr:ae,propSatisfies:se,props:ue,range:le,reduce:Xn,reduceRight:ce,reduced:he,reject:$n,remove:fe,repeat:Wn,replace:de,reverse:pe,scan:me,set:ve,slice:Zn,sort:ye,sortBy:ge,split:or,splitEvery:Kn,subtract:_e,sum:Jn,tail:Qn,take:ti,takeLast:Ri,takeLastWhile:xe,takeWhile:ei,tap:be,test:we,times:Se,toLower:ar,toPairs:Me,toPairsIn:Ee,toString:Qi,toUpper:sr,transduce:ni,trim:Te,type:De,unapply:Ie,unary:ze,uncurryN:Ae,unfold:ke,union:tr,unionWith:ii,uniq:ri,uniqBy:er,uniqWith:Le,unnest:oi,update:Ce,useWith:ai,values:Pe,valuesIn:Fe,view:je,where:Oe,whereEq:si,wrap:Re,xprod:Ne,zip:Be,zipObj:qe,zipWith:Ue};"object"==typeof n?e.exports=ur:"function"==typeof define&&define.amd?define(function(){return ur}):this.R=ur}).call(this)},{}],5:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=t("./feature_types/line"),l=i(u),c=t("./feature_types/point"),h=i(c),f=t("./feature_types/polygon"),d=i(f),p=t("./control"),m=i(p),v=function(t){function e(){r(this,e);var t=o(this,Object.getPrototypeOf(e).call(this));return t.types={SQUARE:"square",POLYGON:"polygon",LINE:"line",POINT:"point"},t}return a(e,t),s(e,[{key:"add",value:function(t,e){var n=this;if(t=JSON.parse(JSON.stringify(t)),"FeatureCollection"===t.type)return t.features.map(function(t){return n.add(t,e)});t.geometry||(t={type:"Feature",id:t.id,geometry:t}),e||(e={}),e.map=this._map,e.data=t;var i;switch(t.geometry.type){case"Point":i=new h["default"](e);break;case"LineString":i=new l["default"](e);break;case"Polygon":i=new d["default"](e);break;default:throw new Error('MapboxGL Draw: Unsupported geometry type "'+t.geometry.type+'"')}i.ready=!0,i.created=!0;var r=this._store.set(i);return this._store._features[r].commited=!0,this.options.interactive&&this.select(i.drawId),i.drawId}},{key:"update",value:function(t,e){e=JSON.parse(JSON.stringify(e));var n=this._store.get(t);return n.setCoordinates(e.coordinates||e.geometry.coordinates),e.properties&&n.setProperties(e.properties),this._store._render(),this}},{key:"get",value:function(t){var e=this._store.get(t);return e&&e.toGeoJSON()}},{key:"getAll",value:function(){var t=this;return this._store.getAllIds().map(function(e){return t._store.get(e).toGeoJSON()}).reduce(function(t,e){return t.features.push(e),t},{type:"FeatureCollection",features:[]})}},{key:"startDrawing",value:function(){return null}},{key:"select",value:function(t){return this._store.get(t).options.permanent!==!0&&this._store.select(t),this}},{key:"selectAll",value:function(){var t=this;return this._store.getAllIds().filter(function(e){return t._store.get(e).options.permanent!==!0}).forEach(function(e){return t.select(e)}),this}},{key:"deselect",value:function(t){return this._store.commit(t),this}},{key:"deselectAll",value:function(){var t=this;return this._store.getSelectedIds().forEach(function(e){return t.commit(e)}),this}},{key:"getSelected",value:function(){var t=this;return this._store.getSelectedIds().map(function(e){return t._store.get(e).toGeoJSON()}).reduce(function(t,e){return t.features.push(e),t},{type:"FeatureCollection",features:[]})}},{key:"destroy",value:function(t){return this._store["delete"](t),this}},{key:"clear",value:function(){return this._store.deleteAll(),this}}]),e}(m["default"]);n["default"]=v},{"./control":6,"./feature_types/line":10,"./feature_types/point":11,"./feature_types/polygon":12}],6:[function(t,e,n){"use strict";function i(){}e.exports=i,i.prototype={addTo:function(t){this._map=t;var e=this._container=this.onAdd(t);if(this.options&&this.options.position){var n=this.options.position,i=t._controlCorners[n];e.className+=" mapboxgl-ctrl",-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e)}return this},remove:function(){return this._container.parentNode.removeChild(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this}}},{}],7:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function C(t,e,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:C(r,e,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},l=t("./lib/polyfills"),c=i(l),h=t("./api"),f=i(h),d=t("./util"),p=t("./theme/draw-selected"),m=i(p),v=t("./theme/draw"),y=i(v),g=t("./store"),_=i(g),x=t("./feature_types/line"),b=i(x),w=t("./feature_types/point"),S=i(w),M=t("./feature_types/square"),E=i(M),T=t("./feature_types/polygon"),D=i(T),I=t("./draw_events"),z=i(I);(0,c["default"])();var A={marker:!0,line:!0,shape:!0,square:!0,trash:!0},k={marker:!1,line:!1,shape:!1,square:!1,trash:!1},L=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{controls:{}}:arguments[0];r(this,e);var n=o(this,Object.getPrototypeOf(e).call(this));return n.options={drawing:!0,interactive:!1,position:"top-left",keybindings:!0,displayControlsDefault:!0,styles:{},controls:{}},t.displayControlsDefault===!1?t.controls=Object.assign(k,t.controls):t.controls=Object.assign(A,t.controls),n._events=(0,z["default"])(n),Object.assign(n.options,t),n}return a(e,t),s(e,[{key:"onAdd",value:function(t){var e=this,n=this._container=d.DOM.create("div","mapboxgl-ctrl-group",t.getContainer());return this._store=new _["default"](t,this),this._map=t,this.options.drawing&&this._createButtons(),t.style.loaded()?(this._setEventListeners(),this._setStyles()):t.on("load",function(){e._setEventListeners(),e._setStyles()}),n}},{key:"_createButtons",value:function(){var t=this._controlClass="mapbox-gl-draw_ctrl-draw-btn",e=this.options.controls;e.line&&(this.lineStringCtrl=(0,d.createButton)(this._container,{className:t+" mapbox-gl-draw_line",title:"LineString tool "+(this.options.keybindings&&"(l)"),fn:this.startDrawing.bind(this,this.types.LINE),id:"lineDrawBtn"},this._controlClass)),e.shape&&(this.polygonCtrl=(0,d.createButton)(this._container,{className:t+" mapbox-gl-draw_shape",title:"Polygon tool "+(this.options.keybindings&&"(p)"),fn:this.startDrawing.bind(this,this.types.POLYGON),id:"polygonDrawBtn"},this._controlClass)),e.square&&(this.squareCtrl=(0,d.createButton)(this._container,{className:t+" mapbox-gl-draw_square",title:"Square tool "+(this.options.keybindings&&"(s)"),fn:this.startDrawing.bind(this,this.types.SQUARE),id:"squareDrawBtn"},this._controlClass)),e.marker&&(this.markerCtrl=(0,d.createButton)(this._container,{className:t+" mapbox-gl-draw_marker",title:"Marker tool "+(this.options.keybindings&&"(m)"),fn:this.startDrawing.bind(this,this.types.POINT),id:"pointDrawBtn"},this._controlClass)),e.trash&&(this.deleteBtn=(0,d.createButton)(this._container,{className:t+" mapbox-gl-draw_trash",title:"delete",fn:this._destroy.bind(this),id:"deleteBtn"},this._controlClass),this._hideDeleteButton())}},{key:"_showDeleteButton",value:function(){this.options.controls.trash&&this.options.drawing&&(this.deleteBtn.style.display="block")}},{key:"_hideDeleteButton",value:function(){this.options.controls.trash&&this.options.drawing&&(this.deleteBtn.style.display="none")}},{key:"_destroy",value:function(){this._store.clearSelected(),this._handleDrawFinished()}},{key:"startDrawing",value:function(t){this._events.destroyNewFeature(),this._handleDrawFinished();var e=null;switch(t){case this.types.POLYGON:e=new D["default"]({map:this._map});break;case this.types.LINE:e=new b["default"]({map:this._map});break;case this.types.SQUARE:e=new E["default"]({map:this._map});break;case this.types.POINT:e=new S["default"]({map:this._map});break;default:return}e.startDrawing(),this._events.setNewFeature(e);var n=this._store.set(e);this.select(n)}},{key:"_handleDrawFinished",value:function(){var t=this;this._store.getSelectedIds().forEach(function(e){return t._store.commit(e)}),[this.lineStringCtrl,this.polygonCtrl,this.squareCtrl,this.markerCtrl].forEach(function(t){t&&t.classList.remove("active")})}},{key:"_setEventListeners",value:function(){this._map.on("click",this._events.onClick),this._map.on("dblclick",this._events.onDoubleClick),this._map.getContainer().addEventListener("mousedown",this._events.onMouseDown),this._map.getContainer().addEventListener("mouseup",this._events.onMouseUp),this._map.on("mousemove",this._events.onMouseMove),this._map.getContainer().addEventListener("keydown",this._events.onKeyDown),this.options.keybindings&&this._map.getContainer().addEventListener("keyup",this._events.onKeyUp)}},{key:"_setStyles",value:function(){var t=this;this._map.batch(function(e){e.addSource("draw",{data:{type:"FeatureCollection",features:[]},type:"geojson"});for(var n=0;n<y["default"].length;n++){var i=y["default"][n];Object.assign(i,t.options.styles[i.id]||{}),e.addLayer(i)}e.addSource("draw-selected",{data:{type:"FeatureCollection",features:[]},type:"geojson"});for(var n=0;n<m["default"].length;n++){var i=m["default"][n];Object.assign(i,t.options.styles[i.id]||{}),e.addLayer(i)}t._store._render()})}},{key:"_removeLayers",value:function(){this._map.batch(function(t){for(var e=0;e<y["default"].length;e++){var n=y["default"][e].id;t.removeLayer(n)}for(var e=0;e<m["default"].length;e++){var n=m["default"][e].id;t.removeLayer(n)}t.removeSource("draw"),t.removeSource("draw-selected")})}},{key:"_removeButtons",value:function(){if(this.options.drawing){var t=this.options.controls;t.trash&&this.deleteBtn.parentNode.removeChild(this.deleteBtn),t.square&&this.squareCtrl.parentNode.removeChild(this.squareCtrl),t.line&&this.lineStringCtrl.parentNode.removeChild(this.lineStringCtrl),t.shape&&this.polygonCtrl.parentNode.removeChild(this.polygonCtrl),t.marker&&this.markerCtrl.parentNode.removeChild(this.markerCtrl)}}},{key:"_removeEventListeners",value:function(){this._map.off("click",this._events.onClick),this._map.off("dblclick",this._events.onDoubleClick),this._map.off("mousemove",this._events.onMouseMove),this._map.getContainer().removeEventListener("mousedown",this._events.onMouseDown),this._map.getContainer().removeEventListener("mouseup",this._events.onMouseUp),this._map.getContainer().removeEventListener("keydown",this._events.onKeyDown),this.options.keybindings&&this._map.getContainer().removeEventListener("keyup",this._events.onKeyUp)}},{key:"remove",value:function(){this._removeLayers(),this._removeButtons(),this._removeEventListeners(),u(Object.getPrototypeOf(e.prototype),"remove",this).call(this)}}]),e}(f["default"]);n["default"]=L},{"./api":5,"./draw_events":8,"./feature_types/line":10,"./feature_types/point":11,"./feature_types/polygon":12,"./feature_types/square":13,"./lib/polyfills":16,"./store":17,"./theme/draw":19,"./theme/draw-selected":18,"./util":20}],8:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(t){var e=!1,n=null,i=!1,r=null,p=null,m=null,v=!1,y=function(){r.created?(t._handleDrawFinished(),r=null):r.toRemove&&(t._destroy(),r=null)},g={setNewFeature:function(t){r=t},destroyNewFeature:function(){r&&(r.toRemove=!0,r=null,t._destroy())},onMouseDown:function(i){if(e=!0,r)r.onMouseDown(i),t._store._render(),y();else{n=a.DOM.mousePos(i,t._map._container);var s=t._store.getSelectedIds();if(null===r&&s.length>0){var u=a.DOM.mousePos(i,t._map._container);v=!0,t._map.featuresAt([u.x,u.y],{radius:20},function(e,n){if(e)throw e;if(n=n.filter(function(t){return s.indexOf(t.properties.drawId||t.properties.parent)>-1}),n.length>0){var i=o["default"].find(function(t){return"midpoint"===t.properties.meta})(n);p=o["default"].find(function(t){return"vertex"===t.properties.meta})(n)||null,i&&null===p&&(t._store.get(i.properties.parent).addVertex([i.properties.lng,i.properties.lat],i.properties.index),p=i,t._store._render()),null===p&&(m=o["default"].find(function(t){return t.properties.drawId})(n).properties.drawId)}v=!1})}}},onMouseUp:function(o){if(e=!1,r)r.onMouseUp(o),t._store._render(),y();else{var s=a.DOM.mousePos(o,t._map.getContainer());i&&null===p&&null===m&&n.x!==s.x&&n.y!==s.y&&t._store.selectFeaturesIn(n,s),p&&(t._store.get(p.properties.parent).movingVertex=!1),p=null,m&&(t._store.get(m).translating=!1),m=null}n=null},onMouseMove:function(n){return e?(v&&n.originalEvent.stopPropagation(),g.onMouseDrag(n)):void(r&&(n.originalEvent.stopPropagation(),r.onMouseMove(n),t._store._render(),y()))},onMouseDrag:function(e){var i=a.DOM.mousePos(e.originalEvent,t._map.getContainer());p?(e.originalEvent.stopPropagation(),t._store.get(p.properties.parent).moveVertex(n,i,p.properties.index),t._store._render()):m&&(e.originalEvent.stopPropagation(),t._store.get(m).translate(n,i),t._store._render())},onClick:function(e){r?(r.onClick(e),t._store._render(),y()):t._map.featuresAt(e.point,{radius:10,layer:["gl-draw-polygon","gl-draw-line","gl-draw-point","gl-draw-selected-polygon","gl-draw-selected-line","gl-draw-selected-point"]},function(e,n){if(e)throw e;var r=[],o=[];n.forEach(function(e){var n=e.properties.drawId||e.properties.parent,i=t._store.get(n);i&&"vertex"===e.properties.meta?o.push([i,e.properties.index]):i&&e.properties.drawId&&i.getOptions().permanent!==!0&&!i.selected&&r.push(i)}),r.length>0?(i===!1&&t._handleDrawFinished(),t.select(r[0].drawId)):o.length>0?(o[0][0].removeVertex(o[0][1])&&t._store["delete"](o[0][0].drawId),t._store._render()):t._handleDrawFinished()})},onDoubleClick:function(e){r&&(r.onDoubleClick(e),t._store._render(),y())},onKeyUp:function(e){if(e.keyCode===u&&(i=!1),null===r)switch(e.keyCode){case d:t.startDrawing(t.types.LINE);break;case c:t.startDrawing(t.types.POINT);break;case h:t.startDrawing(t.types.POLYGON);break;case l:t.startDrawing(t.types.SQUARE);break;case f:t._store.revertSelected(),e.preventDefault();break;case s:t._handleDrawFinished()}else switch(e.keyCode){case s:r.onStopDrawing(e),y();break;case f:r.toRemove=!0,t._destroy(),r=null}},onKeyDown:function(t){t.keyCode===u&&(i=!0)}};return g};var r=t("ramda"),o=i(r),a=t("./util"),s=13,u=16,l=83,c=77,h=80,f=27,d=76},{"./util":20,ramda:4}],9:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("hat"),s=i(a),u=t("../util"),l=function(){function t(e){r(this,t),this._map=e.map,this.drawId=e.data.id||(0,s["default"])(),this.coordinates=e.data.geometry.coordinates,this.properties=e.data.properties||{},this.type=e.type,this.options={permanent:e.permanent},this.created=!1,this.ready=!1,this.commited=!1,this.toRemove=!1,this.selected=!1,this.lastCoords=null}return o(t,[{key:"select",value:function(){this.selected=!0,null===this.lastCoords&&(this.lastCoords=JSON.stringify(this.coordinates))}},{key:"deselect",value:function(){this.selected=!1,this.lastCoords=null}},{key:"revert",value:function(){null!==this.lastCoords&&(this.coordinates=JSON.parse(this.lastCoords))}},{key:"startDrawing",value:function(){this._map.getContainer().classList.add("mapbox-gl-draw_activated"),this._map.options.doubleClickZoom&&this._map.doubleClickZoom.disable()}},{key:"onStopDrawing",value:function(){this.created=!this.toRemove,this._map.options.doubleClickZoom&&(this._map.doubleClickZoom.disable(),this._map.doubleClickZoom.enable()),this._map.getContainer().classList.remove("mapbox-gl-draw_activated")}},{key:"onClick",value:function(){return null}},{key:"onDoubleClick",value:function(){return null}},{key:"onMouseMove",value:function(){return null}},{key:"onMouseDown",value:function(){return null}},{key:"onMouseUp",value:function(){return null}},{key:"toGeoJSON",value:function(){return JSON.parse(JSON.stringify({type:"Feature",id:this.drawId,properties:this.properties,geometry:{type:this.type,coordinates:this.coordinates}}))}},{key:"getType",value:function(){return this.type}},{key:"getOptions",value:function(){return this.options}},{key:"setCoordinates",value:function(t){return this.coordinates=t,this}},{key:"setProperties",value:function(t){return t=JSON.parse(JSON.stringify(t)),this.properties=t,this}},{key:"translate",value:function(t,e){this.translating||(this.translating=!0,this.initGeom=this.toGeoJSON());var n=(0,u.translate)(this.initGeom,t,e,this._map);this.coordinates=n.geometry.coordinates}}]),t}();n["default"]=l},{"../util":20,hat:2}],10:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function d(t,e,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:d(r,e,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},l=t("./feature"),c=i(l),h=t("../util"),f=function(t){function e(t){return r(this,e),t.data||(t.data={geometry:{coordinates:[[0,0],[0,0]]}}),t.type="LineString",o(this,Object.getPrototypeOf(e).call(this,t))}return a(e,t),s(e,[{key:"onClick",value:function(t){var e=[t.lngLat.lng,t.lngLat.lat];"undefined"==typeof this.vertexIdx?(this.coordinates=[e],this.vertexIdx=0,this.ready=!0):this.coordinates.splice(-1,1,e,e),this.vertexIdx++}},{key:"onMouseMove",value:function(t){var e=h.DOM.mousePos(t.originalEvent,this._map._container),n=this._map.unproject([e.x,e.y]);this.coordinates[this.vertexIdx]=[n.lng,n.lat]}},{key:"onStopDrawing",value:function(t){return this.onDoubleClick(t)}},{key:"onDoubleClick",value:function(t){var n=13,i=t.keyCode===n?1:2;this.coordinates=this.coordinates.slice(0,this.coordinates.length-i),1===this.coordinates.length&&(this.toRemove=!0),u(Object.getPrototypeOf(e.prototype),"onStopDrawing",this).call(this,t)}},{key:"moveVertex",value:function(t,e,n){this.movingVertex||(this.movingVertex=!0,this.initCoords=this.coordinates[n]);var i=e.x-t.x,r=e.y-t.y,o=(0,h.translatePoint)(JSON.parse(JSON.stringify(this.initCoords)),i,r,this._map);this.coordinates[n]=o}},{key:"addVertex",value:function(t,e){this.coordinates.splice(e,0,t)}},{key:"removeVertex",value:function(t){return this.coordinates.splice(t,1),this.coordinates.length<=1?(this.ready=!1,!0):!1}}]),e}(c["default"]);n["default"]=f},{"../util":20,"./feature":9}],11:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=t("./feature"),l=i(u),c=function(t){function e(t){return r(this,e),t.data||(t.data={geometry:{coordinates:[0,0]}}),t.type="Point",o(this,Object.getPrototypeOf(e).call(this,t))}return a(e,t),s(e,[{key:"onClick",value:function(t){this._map.getContainer().classList.remove("mapbox-gl-draw_activated"),this.coordinates=[t.lngLat.lng,t.lngLat.lat],this.created=!0,this.ready=!0}}]),e}(l["default"]);n["default"]=c},{"./feature":9}],12:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function d(t,e,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:d(r,e,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},l=t("./feature"),c=i(l),h=t("../util"),f=function(t){function e(t){return r(this,e),t.data||(t.data={geometry:{coordinates:[[[0,0],[0,0],[0,0],[0,0]]]}}),t.type="Polygon",o(this,Object.getPrototypeOf(e).call(this,t))}return a(e,t),s(e,[{key:"onClick",value:function(t){var e=[t.lngLat.lng,t.lngLat.lat];
"undefined"==typeof this.vertexIdx&&(this.vertexIdx=0,this.first=e,this.coordinates=[[e,e,e,e]],this.ready=!0),this.vertexIdx>1&&this.coordinates[0].push(this.first),this.coordinates[0][this.vertexIdx]=e,this.vertexIdx++}},{key:"onMouseMove",value:function(t){this.coordinates[0][this.vertexIdx]=[t.lngLat.lng,t.lngLat.lat]}},{key:"onStopDrawing",value:function(t){return this.onDoubleClick(t)}},{key:"onDoubleClick",value:function(t){var n=13;if(this.vertexIdx>2){var i=this.vertexIdx-(t.keyCode===n?0:1),r=t.keyCode===n?1:2;this.coordinates[0].splice(i,r),this.created=!0}(this.vertexIdx<3||this.coordinates[0].length<4)&&(this.toRemove=!0),u(Object.getPrototypeOf(e.prototype),"onStopDrawing",this).call(this,t)}},{key:"moveVertex",value:function(t,e,n){this.movingVertex||(this.movingVertex=!0,this.initCoords=JSON.parse(JSON.stringify(this.coordinates[0][n])));var i=e.x-t.x,r=e.y-t.y,o=(0,h.translatePoint)(this.initCoords,i,r,this._map);this.coordinates[0][n]=o,0===n&&(this.coordinates[0][this.coordinates[0].length-1]=o)}},{key:"addVertex",value:function(t,e){this.coordinates[0].splice(e,0,t)}},{key:"removeVertex",value:function(t){return this.coordinates[0].splice(t,1),this.coordinates[0][this.coordinates[0].length-1]=this.coordinates[0][0],this.coordinates[0].length<=3?(this.ready=!1,!0):!1}}]),e}(c["default"]);n["default"]=f},{"../util":20,"./feature":9}],13:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=t("./polygon"),l=i(u),c=function(t){function e(t){return r(this,e),t.data={geometry:{coordinates:[[[0,0],[0,0],[0,0],[0,0],[0,0]]]}},t.type="Polygon",o(this,Object.getPrototypeOf(e).call(this,t))}return a(e,t),s(e,[{key:"onMouseMove",value:function(t){if(this.ready){var e=this.coordinates[0][0];this.coordinates[0][1]=[e[0],t.lngLat.lat],this.coordinates[0][2]=[t.lngLat.lng,t.lngLat.lat],this.coordinates[0][3]=[t.lngLat.lng,e[1]],this.coordinates[0][4]=e}}},{key:"onClick",value:function(t){if(this.ready===!1){this.ready=!0;var e=[t.lngLat.lng,t.lngLat.lat];this.coordinates=[[e,e,e,e,e]]}else this.onMouseMove(t),this.onStopDrawing(t)}}]),e}(l["default"]);n["default"]=c},{"./polygon":12}],14:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(t,e){var n=[];for(var i in t)if("square"!==t[i].type){var r=t[i],o=r.toGeoJSON().geometry.coordinates;if("LineString"===r.toGeoJSON().geometry.type||"Polygon"===r.toGeoJSON().geometry.type){o="Polygon"===r.toGeoJSON().geometry.type?o[0]:o;for(var a=0;a<o.length-1;a++){var s=e.project([o[a][0],o[a][1]]),u=e.project([o[a+1][0],o[a+1][1]]),l=e.unproject([(s.x+u.x)/2,(s.y+u.y)/2]);n.push({type:"Feature",properties:{meta:"midpoint",parent:r.drawId,index:a+1,lng:l.lng,lat:l.lat},geometry:{type:"Point",coordinates:[l.lng,l.lat]}})}}}return n}},{}],15:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(t){var e=[];for(var n in t){var i=t[n].toGeoJSON().geometry.coordinates,r=t[n].toGeoJSON().geometry.type;if("LineString"===r||"Polygon"===r){i="Polygon"===r?i[0]:i;for(var o="LineString"===r?i.length:i.length-1,a=0;o>a;a++)e.push({type:"Feature",properties:{meta:"vertex",parent:t[n].drawId,index:a},geometry:{type:"Point",coordinates:i[a]}})}}return e}},{}],16:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(){"function"!=typeof Object.assign&&!function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(void 0!==i&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}}()}},{}],17:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("./lib/create_midpoints"),s=i(a),u=t("./lib/create_vertices"),l=i(u),c=t("./util"),h=function(){function t(e,n){r(this,t),this._map=e,this._draw=n,this._features={},this._render=(0,c.throttle)(this.render,16,this)}return o(t,[{key:"set",value:function(t){return this._features[t.drawId]=t,this._render(),t.drawId}},{key:"get",value:function(t){return this._features[t]}},{key:"getAllIds",value:function(){return Object.keys(this._features)}},{key:"getSelectedIds",value:function(){var t=this;return Object.keys(this._features).filter(function(e){return t._features[e].selected===!0})}},{key:"delete",value:function(t){if(this._features[t]){var e=this._features[t].created?this._features[t].toGeoJSON():null;delete this._features[t],e&&this._map.fire("draw.delete",{id:t,geojson:e}),this._render()}}},{key:"clearSelected",value:function(){var t=this;this.getSelectedIds().forEach(function(e){t.get(e).created===!1&&t.get(e).onStopDrawing({}),t["delete"](e)})}},{key:"deleteAll",value:function(){var t=this;Object.keys(this._features).forEach(function(e){t["delete"](e)})}},{key:"revertSelected",value:function(){var t=this;this.getSelectedIds().forEach(function(e){t.get(e).revert(),t.get(e).deselect()}),this.render()}},{key:"select",value:function(t){this._features[t]&&!this._features[t].selected&&(this._features[t].select(),this._render(),this._features[t].commited&&this._features[t].ready&&this._map.fire("draw.select.start",{id:t,geojson:this._features[t].toGeoJSON()}))}},{key:"commit",value:function(t){this._features[t]&&this._features[t].selected&&(this._features[t].deselect(),this._render(),this._features[t].commited?this._map.fire("draw.select.end",{id:t,geojson:this._features[t].toGeoJSON()}):this._features[t].commited=!0,this._map.fire("draw.set",{id:t,geojson:this._features[t].toGeoJSON()}))}},{key:"isSelected",value:function(){var t=this;return Object.keys(this._features).some(function(e){return t._features[e].selected===!0})}},{key:"selectFeaturesIn",value:function(t,e){var n=this,i=t.x<e.x?t.x:e.x,r=t.y<e.y?t.y:e.y,o=t.x>e.x?t.x:e.x,a=t.y>e.y?t.y:e.y,s=[[i,r],[o,a]],u=["gl-draw-polygon","gl-draw-line","gl-draw-point"];this._map.featuresIn(s,{layers:u,type:"vector"},function(t,e){if(t)throw t;e.reduce(function(t,e){var i=e.properties.drawId;return n._features[i]&&void 0===t[i]&&(t[i]=1,n.select(i)),t},{})})}},{key:"render",value:function(){var t=this,e=void 0!==this._map.getSource("draw");if(e){var n=Object.keys(this._features).reduce(function(e,n){if(t._features[n].ready){var i=t._features[n].toGeoJSON();i.properties.drawId=n,t._features[n].selected===!0?(e.selected.push(i),e.selected=e.selected.concat((0,s["default"])([t._features[n]],t._map),(0,l["default"])([t._features[n]]))):e.deselected.push(i)}return e},{deselected:[],selected:[]});n.selected.length>0?this._draw._showDeleteButton():this._draw._hideDeleteButton(),this._map.getSource("draw").setData({type:"FeatureCollection",features:n.deselected}),this._map.getSource("draw-selected").setData({type:"FeatureCollection",features:n.selected})}}}]),t}();n["default"]=h},{"./lib/create_midpoints":14,"./lib/create_vertices":15,"./util":20}],18:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=[{id:"gl-draw-selected-line",type:"line",source:"draw-selected",filter:["all",["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000000","line-dasharray":[0,2],"line-width":3},interactive:!0},{id:"gl-draw-selected-polygon",type:"fill",source:"draw-selected",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":"#000000","fill-opacity":.25},interactive:!0},{id:"gl-draw-selected-polygon-stroke",type:"line",source:"draw-selected",filter:["all",["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000000","line-dasharray":[2,2],"line-width":3},interactive:!0},{id:"gl-draw-selected-point",type:"circle",source:"draw-selected",filter:["all",["==","$type","Point"],["!=","meta","midpoint"]],layout:{},interactive:!0},{id:"gl-draw-selected-point-mid",type:"circle",source:"draw-selected",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":4,"circle-color":"#000000"},interactive:!0}]},{}],19:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=[{id:"gl-draw-polygon",type:"fill",source:"draw",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":"#ff00ff","fill-outline-color":"#ff00ff","fill-opacity":.25},interactive:!0},{id:"gl-draw-polygon-stroke",type:"line",source:"draw",filter:["all",["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ff00ff","line-width":2},interactive:!0},{id:"gl-draw-line",type:"line",source:"draw",filter:["all",["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ff00ff","line-width":2},interactive:!0},{id:"gl-draw-point",type:"circle",source:"draw",filter:["all",["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#ff00ff"},interactive:!0}]},{}],20:[function(t,e,n){"use strict";function i(t){for(var e=0;e<t.length;e++)if(t[e]in s)return t[e]}function r(t,e,n){var i,r,o,a;return a=function(){i=!1,r&&(o.apply(n,r),r=!1)},o=function(){i?r=arguments:(t.apply(n,arguments),setTimeout(a,e),i=!0)}}var o=t("point-geometry"),a={};a.mousePos=function(t,e){var n=e.getBoundingClientRect();return new o(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)},a.create=function(t,e,n,i){var r=document.createElement(t);if(e&&(r.className=e),i)for(var o in i)r.setAttribute(o,i[o]);return n&&n.appendChild(r),r},a.removeClass=function(t,e){Array.prototype.forEach.call(t,function(t){t.classList.remove(e)})};var s=document.documentElement.style,u=i(["transform","WebkitTransform"]);a.setTransform=function(t,e){t.style[u]=e};var l,c=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);a.disableSelection=function(){c&&(l=s[c],s[c]="none")},a.enableSelection=function(){c&&(s[c]=l)},e.exports.createButton=function(t,e,n){var i={title:e.title};e.id&&(i.id=e.id);var r=a.create("button",e.className,t,i);return r.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var i=t.target;i.classList.contains("active")?i.classList.remove("active"):(a.removeClass(document.querySelectorAll("."+n),"active"),i.classList.add("active"),e.fn())},!0),r},e.exports.translate=function(t,e,n,i){t=JSON.parse(JSON.stringify(t));var r,o,a=n.x-e.x,s=n.y-e.y,u=t.geometry;if("Polygon"===u.type)for(r=u.coordinates[0].length,o=0;r>o;o++)u.coordinates[0][o]=h(u.coordinates[0][o],a,s,i);else if("LineString"===u.type)for(r=u.coordinates.length,o=0;r>o;o++)u.coordinates[o]=h(u.coordinates[o],a,s,i);else u.coordinates=h(u.coordinates,a,s,i);return t};var h=function(t,e,n,i){var r=i.project([t[0],t[1]]);return r=i.unproject([r.x+e,r.y+n]),[r.lng,r.lat]};e.exports.throttle=r,e.exports.DOM=a,e.exports.translatePoint=h},{"point-geometry":3}]},{},[1]),!function(t,e){"function"==typeof define&&define.amd?define([],function(){return t.Chartist=e()}):"object"==typeof exports?module.exports=e():t.Chartist=e()}(this,function(){var t={version:"0.9.7"};return function(t,e,n){"use strict";n.namespaces={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",ct:"http://gionkunz.github.com/chartist-js/ct"},n.noop=function(t){return t},n.alphaNumerate=function(t){return String.fromCharCode(97+t%26)},n.extend=function(t){t=t||{};var e=Array.prototype.slice.call(arguments,1);return e.forEach(function(e){for(var i in e)"object"!=typeof e[i]||null===e[i]||e[i]instanceof Array?t[i]=e[i]:t[i]=n.extend({},t[i],e[i])}),t},n.replaceAll=function(t,e,n){return t.replace(new RegExp(e,"g"),n)},n.ensureUnit=function(t,e){return"number"==typeof t&&(t+=e),t},n.quantity=function(t){if("string"==typeof t){var e=/^(\d+)\s*(.*)$/g.exec(t);return{value:+e[1],unit:e[2]||void 0}}return{value:t}},n.querySelector=function(t){return t instanceof Node?t:e.querySelector(t)},n.times=function(t){return Array.apply(null,new Array(t))},n.sum=function(t,e){return t+(e?e:0)},n.mapMultiply=function(t){return function(e){return e*t}},n.mapAdd=function(t){return function(e){return e+t}},n.serialMap=function(t,e){var i=[],r=Math.max.apply(null,t.map(function(t){return t.length}));return n.times(r).forEach(function(n,r){var o=t.map(function(t){return t[r]});i[r]=e.apply(null,o)}),i},n.roundWithPrecision=function(t,e){var i=Math.pow(10,e||n.precision);return Math.round(t*i)/i},n.precision=8,n.escapingMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},n.serialize=function(t){return null===t||void 0===t?t:("number"==typeof t?t=""+t:"object"==typeof t&&(t=JSON.stringify({data:t})),Object.keys(n.escapingMap).reduce(function(t,e){return n.replaceAll(t,e,n.escapingMap[e])},t))},n.deserialize=function(t){if("string"!=typeof t)return t;t=Object.keys(n.escapingMap).reduce(function(t,e){return n.replaceAll(t,n.escapingMap[e],e)},t);try{t=JSON.parse(t),t=void 0!==t.data?t.data:t}catch(e){}return t},n.createSvg=function(t,e,i,r){var o;return e=e||"100%",i=i||"100%",Array.prototype.slice.call(t.querySelectorAll("svg")).filter(function(t){return t.getAttributeNS(n.namespaces.xmlns,"ct")}).forEach(function(e){t.removeChild(e)}),o=new n.Svg("svg").attr({width:e,height:i}).addClass(r).attr({style:"width: "+e+"; height: "+i+";"}),t.appendChild(o._node),o},n.normalizeData=function(t){if(t=t||{series:[],labels:[]},t.series=t.series||[],t.labels=t.labels||[],t.series.length>0&&0===t.labels.length){var e,i=n.getDataArray(t);e=i.every(function(t){return t instanceof Array})?Math.max.apply(null,i.map(function(t){return t.length})):i.length,t.labels=n.times(e).map(function(){return""})}return t},n.reverseData=function(t){t.labels.reverse(),t.series.reverse();for(var e=0;e<t.series.length;e++)"object"==typeof t.series[e]&&void 0!==t.series[e].data?t.series[e].data.reverse():t.series[e]instanceof Array&&t.series[e].reverse()},n.getDataArray=function(t,e,i){function r(t){if(!n.isFalseyButZero(t)){if((t.data||t)instanceof Array)return(t.data||t).map(r);if(t.hasOwnProperty("value"))return r(t.value);if(i){var e={};return"string"==typeof i?e[i]=n.getNumberOrUndefined(t):e.y=n.getNumberOrUndefined(t),e.x=t.hasOwnProperty("x")?n.getNumberOrUndefined(t.x):e.x,e.y=t.hasOwnProperty("y")?n.getNumberOrUndefined(t.y):e.y,e}return n.getNumberOrUndefined(t)}}return(e&&!t.reversed||!e&&t.reversed)&&(n.reverseData(t),t.reversed=!t.reversed),t.series.map(r)},n.normalizePadding=function(t,e){return e=e||0,"number"==typeof t?{top:t,right:t,bottom:t,left:t}:{top:"number"==typeof t.top?t.top:e,right:"number"==typeof t.right?t.right:e,bottom:"number"==typeof t.bottom?t.bottom:e,left:"number"==typeof t.left?t.left:e}},n.getMetaData=function(t,e){var i=t.data?t.data[e]:t[e];return i?n.serialize(i.meta):void 0},n.orderOfMagnitude=function(t){return Math.floor(Math.log(Math.abs(t))/Math.LN10)},n.projectLength=function(t,e,n){return e/n.range*t},n.getAvailableHeight=function(t,e){return Math.max((n.quantity(e.height).value||t.height())-(e.chartPadding.top+e.chartPadding.bottom)-e.axisX.offset,0)},n.getHighLow=function(t,e,i){function r(t){if(void 0!==t)if(t instanceof Array)for(var e=0;e<t.length;e++)r(t[e]);else{var n=i?+t[i]:+t;a&&n>o.high&&(o.high=n),s&&n<o.low&&(o.low=n)}}e=n.extend({},e,i?e["axis"+i.toUpperCase()]:{});var o={high:void 0===e.high?-Number.MAX_VALUE:+e.high,low:void 0===e.low?Number.MAX_VALUE:+e.low},a=void 0===e.high,s=void 0===e.low;return(a||s)&&r(t),(e.referenceValue||0===e.referenceValue)&&(o.high=Math.max(e.referenceValue,o.high),o.low=Math.min(e.referenceValue,o.low)),o.high<=o.low&&(0===o.low?o.high=1:o.low<0?o.high=0:o.high>0?o.low=0:(o.high=1,o.low=0)),o},n.isNum=function(t){return!isNaN(t)&&isFinite(t)},n.isFalseyButZero=function(t){return!t&&0!==t},n.getNumberOrUndefined=function(t){return isNaN(+t)?void 0:+t},n.getMultiValue=function(t,e){return n.isNum(t)?+t:t?t[e||"y"]||0:0},n.rho=function(t){function e(t,n){return t%n===0?n:e(n,t%n)}function n(t){return t*t+1}if(1===t)return t;var i,r=2,o=2;if(t%2===0)return 2;do r=n(r)%t,o=n(n(o))%t,i=e(Math.abs(r-o),t);while(1===i);return i},n.getBounds=function(t,e,i,r){var o,a,s,u=0,l={high:e.high,low:e.low};l.valueRange=l.high-l.low,l.oom=n.orderOfMagnitude(l.valueRange),l.step=Math.pow(10,l.oom),l.min=Math.floor(l.low/l.step)*l.step,l.max=Math.ceil(l.high/l.step)*l.step,l.range=l.max-l.min,l.numberOfSteps=Math.round(l.range/l.step);var c=n.projectLength(t,l.step,l),h=i>c,f=r?n.rho(l.range):0;if(r&&n.projectLength(t,1,l)>=i)l.step=1;else if(r&&f<l.step&&n.projectLength(t,f,l)>=i)l.step=f;else for(;;){if(h&&n.projectLength(t,l.step,l)<=i)l.step*=2;else{if(h||!(n.projectLength(t,l.step/2,l)>=i))break;if(l.step/=2,r&&l.step%1!==0){l.step*=2;break}}if(u++>1e3)throw new Error("Exceeded maximum number of iterations while optimizing scale step!")}for(a=l.min,s=l.max;a+l.step<=l.low;)a+=l.step;for(;s-l.step>=l.high;)s-=l.step;for(l.min=a,l.max=s,l.range=l.max-l.min,l.values=[],o=l.min;o<=l.max;o+=l.step)l.values.push(n.roundWithPrecision(o));return l},n.polarToCartesian=function(t,e,n,i){var r=(i-90)*Math.PI/180;return{x:t+n*Math.cos(r),y:e+n*Math.sin(r)}},n.createChartRect=function(t,e,i){var r=!(!e.axisX&&!e.axisY),o=r?e.axisY.offset:0,a=r?e.axisX.offset:0,s=t.width()||n.quantity(e.width).value||0,u=t.height()||n.quantity(e.height).value||0,l=n.normalizePadding(e.chartPadding,i);s=Math.max(s,o+l.left+l.right),u=Math.max(u,a+l.top+l.bottom);var c={padding:l,width:function(){return this.x2-this.x1},height:function(){return this.y1-this.y2}};return r?("start"===e.axisX.position?(c.y2=l.top+a,c.y1=Math.max(u-l.bottom,c.y2+1)):(c.y2=l.top,c.y1=Math.max(u-l.bottom-a,c.y2+1)),"start"===e.axisY.position?(c.x1=l.left+o,c.x2=Math.max(s-l.right,c.x1+1)):(c.x1=l.left,c.x2=Math.max(s-l.right-o,c.x1+1))):(c.x1=l.left,c.x2=Math.max(s-l.right,c.x1+1),c.y2=l.top,c.y1=Math.max(u-l.bottom,c.y2+1)),c},n.createGrid=function(t,e,i,r,o,a,s,u){var l={};l[i.units.pos+"1"]=t,l[i.units.pos+"2"]=t,l[i.counterUnits.pos+"1"]=r,l[i.counterUnits.pos+"2"]=r+o;var c=a.elem("line",l,s.join(" "));u.emit("draw",n.extend({type:"grid",axis:i,index:e,group:a,element:c},l))},n.createLabel=function(t,e,i,r,o,a,s,u,l,c,h){var f,d={};if(d[o.units.pos]=t+s[o.units.pos],d[o.counterUnits.pos]=s[o.counterUnits.pos],d[o.units.len]=e,d[o.counterUnits.len]=a-10,c){var p='<span class="'+l.join(" ")+'" style="'+o.units.len+": "+Math.round(d[o.units.len])+"px; "+o.counterUnits.len+": "+Math.round(d[o.counterUnits.len])+'px">'+r[i]+"</span>";f=u.foreignObject(p,n.extend({style:"overflow: visible;"},d))}else f=u.elem("text",d,l.join(" ")).text(r[i]);h.emit("draw",n.extend({type:"label",axis:o,index:i,group:u,element:f,text:r[i]},d))},n.getSeriesOption=function(t,e,n){if(t.name&&e.series&&e.series[t.name]){var i=e.series[t.name];return i.hasOwnProperty(n)?i[n]:e[n]}return e[n]},n.optionsProvider=function(e,i,r){function o(e){var o=s;if(s=n.extend({},l),i)for(u=0;u<i.length;u++){var a=t.matchMedia(i[u][0]);a.matches&&(s=n.extend(s,i[u][1]))}r&&!e&&r.emit("optionsChanged",{previousOptions:o,currentOptions:s})}function a(){c.forEach(function(t){t.removeListener(o)})}var s,u,l=n.extend({},e),c=[];if(!t.matchMedia)throw"window.matchMedia not found! Make sure you're using a polyfill.";if(i)for(u=0;u<i.length;u++){var h=t.matchMedia(i[u][0]);h.addListener(o),c.push(h)}return o(!0),{removeMediaQueryListeners:a,getCurrentOptions:function(){return n.extend({},s)}}}}(window,document,t),function(t,e,n){"use strict";n.Interpolation={},n.Interpolation.none=function(t){var e={fillHoles:!1};return t=n.extend({},e,t),function(e,i){for(var r=new n.Svg.Path,o=!0,a=0;a<e.length;a+=2){var s=e[a],u=e[a+1],l=i[a/2];void 0!==l.value?(o?r.move(s,u,!1,l):r.line(s,u,!1,l),o=!1):t.fillHoles||(o=!0)}return r}},n.Interpolation.simple=function(t){var e={divisor:2,fillHoles:!1};t=n.extend({},e,t);var i=1/Math.max(1,t.divisor);return function(e,r){for(var o,a,s,u=new n.Svg.Path,l=0;l<e.length;l+=2){var c=e[l],h=e[l+1],f=(c-o)*i,d=r[l/2];void 0!==d.value?(void 0===s?u.move(c,h,!1,d):u.curve(o+f,a,c-f,h,c,h,!1,d),o=c,a=h,s=d):t.fillHoles||(o=c=s=void 0)}return u}},n.Interpolation.cardinal=function(t){function e(e,n){for(var i=[],r=!0,o=0;o<e.length;o+=2)void 0===n[o/2].value?t.fillHoles||(r=!0):(r&&(i.push({pathCoordinates:[],valueData:[]}),r=!1),i[i.length-1].pathCoordinates.push(e[o],e[o+1]),i[i.length-1].valueData.push(n[o/2]));return i}var i={tension:1,fillHoles:!1};t=n.extend({},i,t);var r=Math.min(1,Math.max(0,t.tension)),o=1-r;return function a(t,i){var s=e(t,i);if(s.length){if(s.length>1){var u=[];return s.forEach(function(t){u.push(a(t.pathCoordinates,t.valueData))}),n.Svg.Path.join(u)}if(t=s[0].pathCoordinates,i=s[0].valueData,t.length<=4)return n.Interpolation.none()(t,i);for(var l,c=(new n.Svg.Path).move(t[0],t[1],!1,i[0]),h=0,f=t.length;f-2*!l>h;h+=2){var d=[{x:+t[h-2],y:+t[h-1]},{x:+t[h],y:+t[h+1]},{x:+t[h+2],y:+t[h+3]},{x:+t[h+4],y:+t[h+5]}];l?h?f-4===h?d[3]={x:+t[0],y:+t[1]}:f-2===h&&(d[2]={x:+t[0],y:+t[1]},d[3]={x:+t[2],y:+t[3]}):d[0]={x:+t[f-2],y:+t[f-1]}:f-4===h?d[3]=d[2]:h||(d[0]={x:+t[h],y:+t[h+1]}),c.curve(r*(-d[0].x+6*d[1].x+d[2].x)/6+o*d[2].x,r*(-d[0].y+6*d[1].y+d[2].y)/6+o*d[2].y,r*(d[1].x+6*d[2].x-d[3].x)/6+o*d[2].x,r*(d[1].y+6*d[2].y-d[3].y)/6+o*d[2].y,d[2].x,d[2].y,!1,i[(h+2)/2])}return c}return n.Interpolation.none()([])}},n.Interpolation.step=function(t){var e={postpone:!0,fillHoles:!1};return t=n.extend({},e,t),function(e,i){for(var r,o,a,s=new n.Svg.Path,u=0;u<e.length;u+=2){var l=e[u],c=e[u+1],h=i[u/2];void 0!==h.value?(void 0===a?s.move(l,c,!1,h):(t.postpone?s.line(l,o,!1,a):s.line(r,c,!1,h),s.line(l,c,!1,h)),r=l,o=c,a=h):t.fillHoles||(r=o=a=void 0)}return s}}}(window,document,t),function(t,e,n){"use strict";n.EventEmitter=function(){function t(t,e){i[t]=i[t]||[],i[t].push(e)}function e(t,e){i[t]&&(e?(i[t].splice(i[t].indexOf(e),1),0===i[t].length&&delete i[t]):delete i[t])}function n(t,e){i[t]&&i[t].forEach(function(t){t(e)}),i["*"]&&i["*"].forEach(function(n){n(t,e)})}var i=[];return{addEventHandler:t,removeEventHandler:e,emit:n}}}(window,document,t),function(t,e,n){"use strict";function i(t){var e=[];if(t.length)for(var n=0;n<t.length;n++)e.push(t[n]);return e}function r(t,e){var i=e||this.prototype||n.Class,r=Object.create(i);n.Class.cloneDefinitions(r,t);var o=function(){var t,e=r.constructor||function(){};return t=this===n?Object.create(r):this,e.apply(t,Array.prototype.slice.call(arguments,0)),t};return o.prototype=r,o["super"]=i,o.extend=this.extend,o}function o(){var t=i(arguments),e=t[0];return t.splice(1,t.length-1).forEach(function(t){Object.getOwnPropertyNames(t).forEach(function(n){delete e[n],Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}),e}n.Class={extend:r,cloneDefinitions:o}}(window,document,t),function(t,e,n){"use strict";function i(t,e,i){return t&&(this.data=t,this.eventEmitter.emit("data",{type:"update",data:this.data})),e&&(this.options=n.extend({},i?this.options:this.defaultOptions,e),this.initializeTimeoutId||(this.optionsProvider.removeMediaQueryListeners(),this.optionsProvider=n.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter))),this.initializeTimeoutId||this.createChart(this.optionsProvider.getCurrentOptions()),this}function r(){return this.initializeTimeoutId?t.clearTimeout(this.initializeTimeoutId):(t.removeEventListener("resize",this.resizeListener),this.optionsProvider.removeMediaQueryListeners()),this}function o(t,e){return this.eventEmitter.addEventHandler(t,e),this}function a(t,e){return this.eventEmitter.removeEventHandler(t,e),this}function s(){t.addEventListener("resize",this.resizeListener),this.optionsProvider=n.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter),this.eventEmitter.addEventHandler("optionsChanged",function(){this.update()}.bind(this)),this.options.plugins&&this.options.plugins.forEach(function(t){t instanceof Array?t[0](this,t[1]):t(this)}.bind(this)),this.eventEmitter.emit("data",{type:"initial",data:this.data}),this.createChart(this.optionsProvider.getCurrentOptions()),this.initializeTimeoutId=void 0}function u(t,e,i,r,o){this.container=n.querySelector(t),this.data=e,this.defaultOptions=i,this.options=r,this.responsiveOptions=o,this.eventEmitter=n.EventEmitter(),this.supportsForeignObject=n.Svg.isSupported("Extensibility"),this.supportsAnimations=n.Svg.isSupported("AnimationEventsAttribute"),this.resizeListener=function(){this.update()}.bind(this),this.container&&(this.container.__chartist__&&this.container.__chartist__.detach(),this.container.__chartist__=this),this.initializeTimeoutId=setTimeout(s.bind(this),0)}n.Base=n.Class.extend({constructor:u,optionsProvider:void 0,container:void 0,svg:void 0,eventEmitter:void 0,createChart:function(){throw new Error("Base chart type can't be instantiated!")},update:i,detach:r,on:o,off:a,version:n.version,supportsForeignObject:!1})}(window,document,t),function(t,e,n){"use strict";function i(t,i,r,o,a){t instanceof Element?this._node=t:(this._node=e.createElementNS(n.namespaces.svg,t),"svg"===t&&this.attr({"xmlns:ct":n.namespaces.ct})),i&&this.attr(i),r&&this.addClass(r),o&&(a&&o._node.firstChild?o._node.insertBefore(this._node,o._node.firstChild):o._node.appendChild(this._node))}function r(t,e){return"string"==typeof t?e?this._node.getAttributeNS(e,t):this._node.getAttribute(t):(Object.keys(t).forEach(function(e){if(void 0!==t[e])if(-1!==e.indexOf(":")){var i=e.split(":");this._node.setAttributeNS(n.namespaces[i[0]],e,t[e])}else this._node.setAttribute(e,t[e])}.bind(this)),this)}function o(t,e,i,r){return new n.Svg(t,e,i,this,r)}function a(){return this._node.parentNode instanceof SVGElement?new n.Svg(this._node.parentNode):null}function s(){for(var t=this._node;"svg"!==t.nodeName;)t=t.parentNode;return new n.Svg(t)}function u(t){var e=this._node.querySelector(t);return e?new n.Svg(e):null}function l(t){var e=this._node.querySelectorAll(t);return e.length?new n.Svg.List(e):null}function c(t,i,r,o){if("string"==typeof t){var a=e.createElement("div");a.innerHTML=t,t=a.firstChild}t.setAttribute("xmlns",n.namespaces.xmlns);var s=this.elem("foreignObject",i,r,o);return s._node.appendChild(t),s}function h(t){return this._node.appendChild(e.createTextNode(t)),this}function f(){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);return this}function d(){return this._node.parentNode.removeChild(this._node),this.parent()}function p(t){return this._node.parentNode.replaceChild(t._node,this._node),t}function m(t,e){return e&&this._node.firstChild?this._node.insertBefore(t._node,this._node.firstChild):this._node.appendChild(t._node),this}function v(){return this._node.getAttribute("class")?this._node.getAttribute("class").trim().split(/\s+/):[]}function y(t){return this._node.setAttribute("class",this.classes(this._node).concat(t.trim().split(/\s+/)).filter(function(t,e,n){return n.indexOf(t)===e}).join(" ")),this}function g(t){var e=t.trim().split(/\s+/);return this._node.setAttribute("class",this.classes(this._node).filter(function(t){return-1===e.indexOf(t)}).join(" ")),this}function _(){return this._node.setAttribute("class",""),this}function x(){return this._node.getBoundingClientRect().height}function b(){return this._node.getBoundingClientRect().width}function w(t,e,i){return void 0===e&&(e=!0),Object.keys(t).forEach(function(r){function o(t,e){var o,a,s,u={};t.easing&&(s=t.easing instanceof Array?t.easing:n.Svg.Easing[t.easing],delete t.easing),t.begin=n.ensureUnit(t.begin,"ms"),t.dur=n.ensureUnit(t.dur,"ms"),s&&(t.calcMode="spline",t.keySplines=s.join(" "),t.keyTimes="0;1"),e&&(t.fill="freeze",u[r]=t.from,this.attr(u),a=n.quantity(t.begin||0).value,t.begin="indefinite"),o=this.elem("animate",n.extend({attributeName:r},t)),e&&setTimeout(function(){try{o._node.beginElement()}catch(e){u[r]=t.to,this.attr(u),o.remove()}}.bind(this),a),i&&o._node.addEventListener("beginEvent",function(){i.emit("animationBegin",{element:this,animate:o._node,params:t})}.bind(this)),o._node.addEventListener("endEvent",function(){i&&i.emit("animationEnd",{element:this,animate:o._node,params:t}),e&&(u[r]=t.to,this.attr(u),o.remove())}.bind(this))}t[r]instanceof Array?t[r].forEach(function(t){o.bind(this)(t,!1)}.bind(this)):o.bind(this)(t[r],e)}.bind(this)),this}function S(t){var e=this;this.svgElements=[];for(var i=0;i<t.length;i++)this.svgElements.push(new n.Svg(t[i]));Object.keys(n.Svg.prototype).filter(function(t){return-1===["constructor","parent","querySelector","querySelectorAll","replace","append","classes","height","width"].indexOf(t)}).forEach(function(t){e[t]=function(){var i=Array.prototype.slice.call(arguments,0);return e.svgElements.forEach(function(e){n.Svg.prototype[t].apply(e,i)}),e}})}n.Svg=n.Class.extend({constructor:i,attr:r,elem:o,parent:a,root:s,querySelector:u,querySelectorAll:l,foreignObject:c,text:h,empty:f,remove:d,replace:p,append:m,classes:v,addClass:y,removeClass:g,removeAllClasses:_,height:x,width:b,animate:w}),n.Svg.isSupported=function(t){return e.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#"+t,"1.1")};var M={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]};n.Svg.Easing=M,n.Svg.List=n.Class.extend({constructor:S})}(window,document,t),function(t,e,n){"use strict";function i(t,e,i,r,o,a){var s=n.extend({command:o?t.toLowerCase():t.toUpperCase()},e,a?{data:a}:{});i.splice(r,0,s)}function r(t,e){t.forEach(function(n,i){x[n.command.toLowerCase()].forEach(function(r,o){e(n,r,i,o,t)})})}function o(t,e){this.pathElements=[],this.pos=0,this.close=t,this.options=n.extend({},b,e)}function a(t){return void 0!==t?(this.pos=Math.max(0,Math.min(this.pathElements.length,t)),this):this.pos}function s(t){return this.pathElements.splice(this.pos,t),this}function u(t,e,n,r){return i("M",{x:+t,y:+e},this.pathElements,this.pos++,n,r),this}function l(t,e,n,r){return i("L",{x:+t,y:+e},this.pathElements,this.pos++,n,r),this}function c(t,e,n,r,o,a,s,u){return i("C",{x1:+t,y1:+e,x2:+n,y2:+r,x:+o,y:+a},this.pathElements,this.pos++,s,u),this}function h(t,e,n,r,o,a,s,u,l){return i("A",{rx:+t,ry:+e,xAr:+n,lAf:+r,sf:+o,x:+a,y:+s},this.pathElements,this.pos++,u,l),
this}function f(t){var e=t.replace(/([A-Za-z])([0-9])/g,"$1 $2").replace(/([0-9])([A-Za-z])/g,"$1 $2").split(/[\s,]+/).reduce(function(t,e){return e.match(/[A-Za-z]/)&&t.push([]),t[t.length-1].push(e),t},[]);"Z"===e[e.length-1][0].toUpperCase()&&e.pop();var i=e.map(function(t){var e=t.shift(),i=x[e.toLowerCase()];return n.extend({command:e},i.reduce(function(e,n,i){return e[n]=+t[i],e},{}))}),r=[this.pos,0];return Array.prototype.push.apply(r,i),Array.prototype.splice.apply(this.pathElements,r),this.pos+=i.length,this}function d(){var t=Math.pow(10,this.options.accuracy);return this.pathElements.reduce(function(e,n){var i=x[n.command.toLowerCase()].map(function(e){return this.options.accuracy?Math.round(n[e]*t)/t:n[e]}.bind(this));return e+n.command+i.join(",")}.bind(this),"")+(this.close?"Z":"")}function p(t,e){return r(this.pathElements,function(n,i){n[i]*="x"===i[0]?t:e}),this}function m(t,e){return r(this.pathElements,function(n,i){n[i]+="x"===i[0]?t:e}),this}function v(t){return r(this.pathElements,function(e,n,i,r,o){var a=t(e,n,i,r,o);(a||0===a)&&(e[n]=a)}),this}function y(t){var e=new n.Svg.Path(t||this.close);return e.pos=this.pos,e.pathElements=this.pathElements.slice().map(function(t){return n.extend({},t)}),e.options=n.extend({},this.options),e}function g(t){var e=[new n.Svg.Path];return this.pathElements.forEach(function(i){i.command===t.toUpperCase()&&0!==e[e.length-1].pathElements.length&&e.push(new n.Svg.Path),e[e.length-1].pathElements.push(i)}),e}function _(t,e,i){for(var r=new n.Svg.Path(e,i),o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.pathElements.length;s++)r.pathElements.push(a.pathElements[s]);return r}var x={m:["x","y"],l:["x","y"],c:["x1","y1","x2","y2","x","y"],a:["rx","ry","xAr","lAf","sf","x","y"]},b={accuracy:3};n.Svg.Path=n.Class.extend({constructor:o,position:a,remove:s,move:u,line:l,curve:c,arc:h,scale:p,translate:m,transform:v,parse:f,stringify:d,clone:y,splitByCommand:g}),n.Svg.Path.elementDescriptions=x,n.Svg.Path.join=_}(window,document,t),function(t,e,n){"use strict";function i(t,e,n,i){this.units=t,this.counterUnits=t===o.x?o.y:o.x,this.chartRect=e,this.axisLength=e[t.rectEnd]-e[t.rectStart],this.gridOffset=e[t.rectOffset],this.ticks=n,this.options=i}function r(t,e,i,r,o){var a=r["axis"+this.units.pos.toUpperCase()],s=this.ticks.map(this.projectValue.bind(this)),u=this.ticks.map(a.labelInterpolationFnc);s.forEach(function(l,c){var h,f={x:0,y:0};h=s[c+1]?s[c+1]-l:Math.max(this.axisLength-l,30),n.isFalseyButZero(u[c])&&""!==u[c]||("x"===this.units.pos?(l=this.chartRect.x1+l,f.x=r.axisX.labelOffset.x,"start"===r.axisX.position?f.y=this.chartRect.padding.top+r.axisX.labelOffset.y+(i?5:20):f.y=this.chartRect.y1+r.axisX.labelOffset.y+(i?5:20)):(l=this.chartRect.y1-l,f.y=r.axisY.labelOffset.y-(i?h:0),"start"===r.axisY.position?f.x=i?this.chartRect.padding.left+r.axisY.labelOffset.x:this.chartRect.x1-10:f.x=this.chartRect.x2+r.axisY.labelOffset.x+10),a.showGrid&&n.createGrid(l,c,this,this.gridOffset,this.chartRect[this.counterUnits.len](),t,[r.classNames.grid,r.classNames[this.units.dir]],o),a.showLabel&&n.createLabel(l,h,c,u,this,a.offset,f,e,[r.classNames.label,r.classNames[this.units.dir],r.classNames[a.position]],i,o))}.bind(this))}var o={x:{pos:"x",len:"width",dir:"horizontal",rectStart:"x1",rectEnd:"x2",rectOffset:"y2"},y:{pos:"y",len:"height",dir:"vertical",rectStart:"y2",rectEnd:"y1",rectOffset:"x1"}};n.Axis=n.Class.extend({constructor:i,createGridAndLabels:r,projectValue:function(t,e,n){throw new Error("Base axis can't be instantiated!")}}),n.Axis.units=o}(window,document,t),function(t,e,n){"use strict";function i(t,e,i,r){var o=r.highLow||n.getHighLow(e.normalized,r,t.pos);this.bounds=n.getBounds(i[t.rectEnd]-i[t.rectStart],o,r.scaleMinSpace||20,r.onlyInteger),this.range={min:this.bounds.min,max:this.bounds.max},n.AutoScaleAxis["super"].constructor.call(this,t,i,this.bounds.values,r)}function r(t){return this.axisLength*(+n.getMultiValue(t,this.units.pos)-this.bounds.min)/this.bounds.range}n.AutoScaleAxis=n.Axis.extend({constructor:i,projectValue:r})}(window,document,t),function(t,e,n){"use strict";function i(t,e,i,r){var o=r.highLow||n.getHighLow(e.normalized,r,t.pos);this.divisor=r.divisor||1,this.ticks=r.ticks||n.times(this.divisor).map(function(t,e){return o.low+(o.high-o.low)/this.divisor*e}.bind(this)),this.ticks.sort(function(t,e){return t-e}),this.range={min:o.low,max:o.high},n.FixedScaleAxis["super"].constructor.call(this,t,i,this.ticks,r),this.stepLength=this.axisLength/this.divisor}function r(t){return this.axisLength*(+n.getMultiValue(t,this.units.pos)-this.range.min)/(this.range.max-this.range.min)}n.FixedScaleAxis=n.Axis.extend({constructor:i,projectValue:r})}(window,document,t),function(t,e,n){"use strict";function i(t,e,i,r){n.StepAxis["super"].constructor.call(this,t,i,r.ticks,r),this.stepLength=this.axisLength/(r.ticks.length-(r.stretch?1:0))}function r(t,e){return this.stepLength*e}n.StepAxis=n.Axis.extend({constructor:i,projectValue:r})}(window,document,t),function(t,e,n){"use strict";function i(t){this.data=n.normalizeData(this.data);var e={raw:this.data,normalized:n.getDataArray(this.data,t.reverseData,!0)};this.svg=n.createSvg(this.container,t.width,t.height,t.classNames.chart);var i,r,a=this.svg.elem("g").addClass(t.classNames.gridGroup),s=this.svg.elem("g"),u=this.svg.elem("g").addClass(t.classNames.labelGroup),l=n.createChartRect(this.svg,t,o.padding);i=void 0===t.axisX.type?new n.StepAxis(n.Axis.units.x,e,l,n.extend({},t.axisX,{ticks:e.raw.labels,stretch:t.fullWidth})):t.axisX.type.call(n,n.Axis.units.x,e,l,t.axisX),r=void 0===t.axisY.type?new n.AutoScaleAxis(n.Axis.units.y,e,l,n.extend({},t.axisY,{high:n.isNum(t.high)?t.high:t.axisY.high,low:n.isNum(t.low)?t.low:t.axisY.low})):t.axisY.type.call(n,n.Axis.units.y,e,l,t.axisY),i.createGridAndLabels(a,u,this.supportsForeignObject,t,this.eventEmitter),r.createGridAndLabels(a,u,this.supportsForeignObject,t,this.eventEmitter),e.raw.series.forEach(function(o,a){var u=s.elem("g");u.attr({"ct:series-name":o.name,"ct:meta":n.serialize(o.meta)}),u.addClass([t.classNames.series,o.className||t.classNames.series+"-"+n.alphaNumerate(a)].join(" "));var c=[],h=[];e.normalized[a].forEach(function(t,s){var u={x:l.x1+i.projectValue(t,s,e.normalized[a]),y:l.y1-r.projectValue(t,s,e.normalized[a])};c.push(u.x,u.y),h.push({value:t,valueIndex:s,meta:n.getMetaData(o,s)})}.bind(this));var f={lineSmooth:n.getSeriesOption(o,t,"lineSmooth"),showPoint:n.getSeriesOption(o,t,"showPoint"),showLine:n.getSeriesOption(o,t,"showLine"),showArea:n.getSeriesOption(o,t,"showArea"),areaBase:n.getSeriesOption(o,t,"areaBase")},d="function"==typeof f.lineSmooth?f.lineSmooth:f.lineSmooth?n.Interpolation.cardinal():n.Interpolation.none(),p=d(c,h);if(f.showPoint&&p.pathElements.forEach(function(e){var s=u.elem("line",{x1:e.x,y1:e.y,x2:e.x+.01,y2:e.y},t.classNames.point).attr({"ct:value":[e.data.value.x,e.data.value.y].filter(n.isNum).join(","),"ct:meta":e.data.meta});this.eventEmitter.emit("draw",{type:"point",value:e.data.value,index:e.data.valueIndex,meta:e.data.meta,series:o,seriesIndex:a,axisX:i,axisY:r,group:u,element:s,x:e.x,y:e.y})}.bind(this)),f.showLine){var m=u.elem("path",{d:p.stringify()},t.classNames.line,!0);this.eventEmitter.emit("draw",{type:"line",values:e.normalized[a],path:p.clone(),chartRect:l,index:a,series:o,seriesIndex:a,axisX:i,axisY:r,group:u,element:m})}if(f.showArea&&r.range){var v=Math.max(Math.min(f.areaBase,r.range.max),r.range.min),y=l.y1-r.projectValue(v);p.splitByCommand("M").filter(function(t){return t.pathElements.length>1}).map(function(t){var e=t.pathElements[0],n=t.pathElements[t.pathElements.length-1];return t.clone(!0).position(0).remove(1).move(e.x,y).line(e.x,e.y).position(t.pathElements.length+1).line(n.x,y)}).forEach(function(n){var s=u.elem("path",{d:n.stringify()},t.classNames.area,!0);this.eventEmitter.emit("draw",{type:"area",values:e.normalized[a],path:n.clone(),series:o,seriesIndex:a,axisX:i,axisY:r,chartRect:l,index:a,group:u,element:s})}.bind(this))}}.bind(this)),this.eventEmitter.emit("created",{bounds:r.bounds,chartRect:l,axisX:i,axisY:r,svg:this.svg,options:t})}function r(t,e,i,r){n.Line["super"].constructor.call(this,t,e,o,n.extend({},o,i),r)}var o={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:n.noop,type:void 0},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:n.noop,type:void 0,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,showLine:!0,showPoint:!0,showArea:!1,areaBase:0,lineSmooth:!0,low:void 0,high:void 0,chartPadding:{top:15,right:15,bottom:5,left:10},fullWidth:!1,reverseData:!1,classNames:{chart:"ct-chart-line",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",line:"ct-line",point:"ct-point",area:"ct-area",grid:"ct-grid",gridGroup:"ct-grids",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};n.Line=n.Base.extend({constructor:r,createChart:i})}(window,document,t),function(t,e,n){"use strict";function i(t){this.data=n.normalizeData(this.data);var e,i={raw:this.data,normalized:t.distributeSeries?n.getDataArray(this.data,t.reverseData,t.horizontalBars?"x":"y").map(function(t){return[t]}):n.getDataArray(this.data,t.reverseData,t.horizontalBars?"x":"y")};this.svg=n.createSvg(this.container,t.width,t.height,t.classNames.chart+(t.horizontalBars?" "+t.classNames.horizontalBars:""));var r=this.svg.elem("g").addClass(t.classNames.gridGroup),a=this.svg.elem("g"),s=this.svg.elem("g").addClass(t.classNames.labelGroup);if(t.stackBars&&0!==i.normalized.length){var u=n.serialMap(i.normalized,function(){return Array.prototype.slice.call(arguments).map(function(t){return t}).reduce(function(t,e){return{x:t.x+(e&&e.x)||0,y:t.y+(e&&e.y)||0}},{x:0,y:0})});e=n.getHighLow([u],n.extend({},t,{referenceValue:0}),t.horizontalBars?"x":"y")}else e=n.getHighLow(i.normalized,n.extend({},t,{referenceValue:0}),t.horizontalBars?"x":"y");e.high=+t.high||(0===t.high?0:e.high),e.low=+t.low||(0===t.low?0:e.low);var l,c,h,f,d,p=n.createChartRect(this.svg,t,o.padding);c=t.distributeSeries&&t.stackBars?i.raw.labels.slice(0,1):i.raw.labels,t.horizontalBars?(l=f=void 0===t.axisX.type?new n.AutoScaleAxis(n.Axis.units.x,i,p,n.extend({},t.axisX,{highLow:e,referenceValue:0})):t.axisX.type.call(n,n.Axis.units.x,i,p,n.extend({},t.axisX,{highLow:e,referenceValue:0})),h=d=void 0===t.axisY.type?new n.StepAxis(n.Axis.units.y,i,p,{ticks:c}):t.axisY.type.call(n,n.Axis.units.y,i,p,t.axisY)):(h=f=void 0===t.axisX.type?new n.StepAxis(n.Axis.units.x,i,p,{ticks:c}):t.axisX.type.call(n,n.Axis.units.x,i,p,t.axisX),l=d=void 0===t.axisY.type?new n.AutoScaleAxis(n.Axis.units.y,i,p,n.extend({},t.axisY,{highLow:e,referenceValue:0})):t.axisY.type.call(n,n.Axis.units.y,i,p,n.extend({},t.axisY,{highLow:e,referenceValue:0})));var m=t.horizontalBars?p.x1+l.projectValue(0):p.y1-l.projectValue(0),v=[];h.createGridAndLabels(r,s,this.supportsForeignObject,t,this.eventEmitter),l.createGridAndLabels(r,s,this.supportsForeignObject,t,this.eventEmitter),i.raw.series.forEach(function(e,r){var o,s,u=r-(i.raw.series.length-1)/2;o=t.distributeSeries&&!t.stackBars?h.axisLength/i.normalized.length/2:t.distributeSeries&&t.stackBars?h.axisLength/2:h.axisLength/i.normalized[r].length/2,s=a.elem("g"),s.attr({"ct:series-name":e.name,"ct:meta":n.serialize(e.meta)}),s.addClass([t.classNames.series,e.className||t.classNames.series+"-"+n.alphaNumerate(r)].join(" ")),i.normalized[r].forEach(function(a,c){var y,g,_,x;if(x=t.distributeSeries&&!t.stackBars?r:t.distributeSeries&&t.stackBars?0:c,y=t.horizontalBars?{x:p.x1+l.projectValue(a&&a.x?a.x:0,c,i.normalized[r]),y:p.y1-h.projectValue(a&&a.y?a.y:0,x,i.normalized[r])}:{x:p.x1+h.projectValue(a&&a.x?a.x:0,x,i.normalized[r]),y:p.y1-l.projectValue(a&&a.y?a.y:0,c,i.normalized[r])},h instanceof n.StepAxis&&(h.options.stretch||(y[h.units.pos]+=o*(t.horizontalBars?-1:1)),y[h.units.pos]+=t.stackBars||t.distributeSeries?0:u*t.seriesBarDistance*(t.horizontalBars?-1:1)),_=v[c]||m,v[c]=_-(m-y[h.counterUnits.pos]),void 0!==a){var b={};b[h.units.pos+"1"]=y[h.units.pos],b[h.units.pos+"2"]=y[h.units.pos],!t.stackBars||"accumulate"!==t.stackMode&&t.stackMode?(b[h.counterUnits.pos+"1"]=m,b[h.counterUnits.pos+"2"]=y[h.counterUnits.pos]):(b[h.counterUnits.pos+"1"]=_,b[h.counterUnits.pos+"2"]=v[c]),b.x1=Math.min(Math.max(b.x1,p.x1),p.x2),b.x2=Math.min(Math.max(b.x2,p.x1),p.x2),b.y1=Math.min(Math.max(b.y1,p.y2),p.y1),b.y2=Math.min(Math.max(b.y2,p.y2),p.y1),g=s.elem("line",b,t.classNames.bar).attr({"ct:value":[a.x,a.y].filter(n.isNum).join(","),"ct:meta":n.getMetaData(e,c)}),this.eventEmitter.emit("draw",n.extend({type:"bar",value:a,index:c,meta:n.getMetaData(e,c),series:e,seriesIndex:r,axisX:f,axisY:d,chartRect:p,group:s,element:g},b))}}.bind(this))}.bind(this)),this.eventEmitter.emit("created",{bounds:l.bounds,chartRect:p,axisX:f,axisY:d,svg:this.svg,options:t})}function r(t,e,i,r){n.Bar["super"].constructor.call(this,t,e,o,n.extend({},o,i),r)}var o={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:n.noop,scaleMinSpace:30,onlyInteger:!1},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:n.noop,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,high:void 0,low:void 0,chartPadding:{top:15,right:15,bottom:5,left:10},seriesBarDistance:15,stackBars:!1,stackMode:"accumulate",horizontalBars:!1,distributeSeries:!1,reverseData:!1,classNames:{chart:"ct-chart-bar",horizontalBars:"ct-horizontal-bars",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",bar:"ct-bar",grid:"ct-grid",gridGroup:"ct-grids",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};n.Bar=n.Base.extend({constructor:r,createChart:i})}(window,document,t),function(t,e,n){"use strict";function i(t,e,n){var i=e.x>t.x;return i&&"explode"===n||!i&&"implode"===n?"start":i&&"implode"===n||!i&&"explode"===n?"end":"middle"}function r(t){this.data=n.normalizeData(this.data);var e,r,o,s,u,l=[],c=t.startAngle,h=n.getDataArray(this.data,t.reverseData);this.svg=n.createSvg(this.container,t.width,t.height,t.donut?t.classNames.chartDonut:t.classNames.chartPie),r=n.createChartRect(this.svg,t,a.padding),o=Math.min(r.width()/2,r.height()/2),u=t.total||h.reduce(function(t,e){return t+e},0);var f=n.quantity(t.donutWidth);"%"===f.unit&&(f.value*=o/100),o-=t.donut?f.value/2:0,s="outside"===t.labelPosition||t.donut?o:"center"===t.labelPosition?0:o/2,s+=t.labelOffset;var d={x:r.x1+r.width()/2,y:r.y2+r.height()/2},p=1===this.data.series.filter(function(t){return t.hasOwnProperty("value")?0!==t.value:0!==t}).length;t.showLabel&&(e=this.svg.elem("g",null,null,!0));for(var m=0;m<this.data.series.length;m++)if(0!==h[m]||!t.ignoreEmptyValues){var v=this.data.series[m];l[m]=this.svg.elem("g",null,null,!0),l[m].attr({"ct:series-name":v.name}),l[m].addClass([t.classNames.series,v.className||t.classNames.series+"-"+n.alphaNumerate(m)].join(" "));var y=c+h[m]/u*360,g=Math.max(0,c-(0===m||p?0:.2));y-g>=359.99&&(y=g+359.99);var _=n.polarToCartesian(d.x,d.y,o,g),x=n.polarToCartesian(d.x,d.y,o,y),b=new n.Svg.Path(!t.donut).move(x.x,x.y).arc(o,o,0,y-c>180,0,_.x,_.y);t.donut||b.line(d.x,d.y);var w=l[m].elem("path",{d:b.stringify()},t.donut?t.classNames.sliceDonut:t.classNames.slicePie);if(w.attr({"ct:value":h[m],"ct:meta":n.serialize(v.meta)}),t.donut&&w.attr({style:"stroke-width: "+f.value+"px"}),this.eventEmitter.emit("draw",{type:"slice",value:h[m],totalDataSum:u,index:m,meta:v.meta,series:v,group:l[m],element:w,path:b.clone(),center:d,radius:o,startAngle:c,endAngle:y}),t.showLabel){var S=n.polarToCartesian(d.x,d.y,s,c+(y-c)/2),M=t.labelInterpolationFnc(this.data.labels&&!n.isFalseyButZero(this.data.labels[m])?this.data.labels[m]:h[m],m);if(M||0===M){var E=e.elem("text",{dx:S.x,dy:S.y,"text-anchor":i(d,S,t.labelDirection)},t.classNames.label).text(""+M);this.eventEmitter.emit("draw",{type:"label",index:m,group:e,element:E,text:""+M,x:S.x,y:S.y})}}c=y}this.eventEmitter.emit("created",{chartRect:r,svg:this.svg,options:t})}function o(t,e,i,r){n.Pie["super"].constructor.call(this,t,e,a,n.extend({},a,i),r)}var a={width:void 0,height:void 0,chartPadding:5,classNames:{chartPie:"ct-chart-pie",chartDonut:"ct-chart-donut",series:"ct-series",slicePie:"ct-slice-pie",sliceDonut:"ct-slice-donut",label:"ct-label"},startAngle:0,total:void 0,donut:!1,donutWidth:60,showLabel:!0,labelOffset:0,labelPosition:"inside",labelInterpolationFnc:n.noop,labelDirection:"neutral",reverseData:!1,ignoreEmptyValues:!1};n.Pie=n.Base.extend({constructor:o,createChart:r,determineAnchorPosition:i})}(window,document,t),t}),!function(t,e){"function"==typeof define&&define.amd?define([],function(){return t.returnExportsGlobal=e()}):"object"==typeof exports?module.exports=e():t["Chartist.plugins.tooltips"]=e()}(this,function(){return function(t,e,n){"use strict";function i(t){t.style.display="block"}function r(t){t.style.display="none"}function o(t,e){return(" "+t.getAttribute("class")+" ").indexOf(" "+e+" ")>-1}function a(t,e){do t=t.nextSibling;while(t&&!o(t,e));return t}function s(t){return t.innerText||t.textContent}var u={currency:void 0,tooltipOffset:{x:0,y:-20}};n.plugins=n.plugins||{},n.plugins.tooltip=function(t){return t=n.extend({},u,t),function(u){function l(t,e,n){f.addEventListener(t,function(t){(!e||o(t.target,e))&&n(t)})}function c(e){p=p||d.offsetHeight,m=m||d.offsetWidth,d.style.top=(e.layerY||e.offsetY)-p+t.tooltipOffset.y+"px",d.style.left=(e.layerX||e.offsetX)-m/2+t.tooltipOffset.x+"px"}var h="ct-point";u instanceof n.Bar?h="ct-bar":u instanceof n.Pie&&(h=u.options.donut?"ct-slice-donut":"ct-slice-pie");var f=u.container,d=f.querySelector(".chartist-tooltip");d||(d=e.createElement("div"),d.className="chartist-tooltip",f.appendChild(d));var p=d.offsetHeight,m=d.offsetWidth;r(d),l("mouseover",h,function(e){var r=e.target,o="",l=r.getAttribute("ct:meta")||"",h=r.getAttribute("ct:value");if(t.tooltipFnc)o=t.tooltipFnc(l,h);else{if(l)o+=l+"<br>";else if(u instanceof n.Pie){var f=a(r,"ct-label");f.length>0&&(o+=s(f)+"<br>")}t.currency&&(h=t.currency+h.replace(/(\d)(?=(\d{3})+(?:\.\d+)?$)/g,"$1,")),o+=h}d.innerHTML=o,c(e),i(d),p=d.offsetHeight,m=d.offsetWidth}),l("mouseout",h,function(){r(d)}),l("mousemove",null,function(t){c(t)})}}}(window,document,Chartist),Chartist.plugins.tooltips}),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.mapboxgl=t()}}(function(){var t;return function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return r(n?n:e)},c,c.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){"use strict";function i(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layer=t.layer,this.layers=[this.layer.id],this.type=this.layer.type,this.features=[],this.id=this.layer.id,this["source-layer"]=this.layer["source-layer"],this.interactive=this.layer.interactive,this.minZoom=this.layer.minzoom,this.maxZoom=this.layer.maxzoom,t.elementGroups&&(this.elementGroups=t.elementGroups,this.buffers=f.mapObject(t.buffers,function(t){return new c(t)}))}function r(t,e,n){for(var i=[],r=0;r<e.attributes.length;r++)i=i.concat(e.attributes[r].value);var o="return this.buffers."+n+".push("+i.join(", ")+");";return d[o]||(d[o]=new Function(e.attributeArgs,o)),d[o]}function o(t){return function(e,n,i){return t.push(e,n,i)}}function a(t){return new c({type:c.BufferType.ELEMENT,attributes:[{name:"vertices",components:t||3,type:c.ELEMENT_ATTRIBUTE_TYPE}]})}function s(t){return t.charAt(0).toUpperCase()+t.slice(1)}function u(t,e,n){this.vertexStartIndex=t,this.elementStartIndex=e,this.secondElementStartIndex=n,this.elementLength=0,this.vertexLength=0,this.secondElementLength=0}var l=t("feature-filter"),c=t("./buffer"),h=t("../style/style_layer"),f=t("../util/util");e.exports=i,i.create=function(e){var n={fill:t("./bucket/fill_bucket"),line:t("./bucket/line_bucket"),circle:t("./bucket/circle_bucket"),symbol:t("./bucket/symbol_bucket")};return new n[e.layer.type](e)},i.AttributeType=c.AttributeType,i.EXTENT=8192,i.prototype.populateBuffers=function(){this.createStyleLayer(),this.createBuffers();for(var t=0;t<this.features.length;t++)this.addFeature(this.features[t]);this.trimBuffers()},i.prototype.makeRoomFor=function(t,e){var n=this.elementGroups[t],i=n.length&&n[n.length-1];if(!i||i.vertexLength+e>65535){var r=this.buffers[this.getBufferName(t,"vertex")],o=this.buffers[this.getBufferName(t,"element")],a=this.buffers[this.getBufferName(t,"secondElement")];i=new u(r.length,o&&o.length,a&&a.length),n.push(i)}return i},i.prototype.createBuffers=function(){var t=this.elementGroups={},e=this.buffers={};for(var n in this.shaderInterfaces){var i=this.shaderInterfaces[n];if(i.vertexBuffer){var s=this.getBufferName(n,"vertex"),u=this.getAddMethodName(n,"vertex");e[s]=new c({type:c.BufferType.VERTEX,attributes:i.attributes}),this[u]=this[u]||r(n,i,this.getBufferName(n,"vertex"))}if(i.elementBuffer){var l=this.getBufferName(n,"element");e[l]=a(i.elementBufferComponents),this[this.getAddMethodName(n,"element")]=o(this.buffers[l])}if(i.secondElementBuffer){var h=this.getBufferName(n,"secondElement");e[h]=a(i.secondElementBufferComponents),this[this.getAddMethodName(n,"secondElement")]=o(this.buffers[h])}t[n]=[]}},i.prototype.destroy=function(t){for(var e in this.buffers)this.buffers[e].destroy(t)},i.prototype.trimBuffers=function(){for(var t in this.buffers)this.buffers[t].trim()},i.prototype.getAddMethodName=function(t,e){return"add"+s(t)+s(e)},i.prototype.getBufferName=function(t,e){return t+s(e)},i.prototype.serialize=function(){return{layer:{id:this.layer.id,type:this.layer.type},zoom:this.zoom,elementGroups:this.elementGroups,buffers:f.mapObject(this.buffers,function(t){return t.serialize()})}},i.prototype.createStyleLayer=function(){this.layer instanceof h||(this.layer=h.create(this.layer),this.layer.recalculate(this.zoom,{lastIntegerZoom:1/0,lastIntegerZoomTime:0,lastZoom:0}))},i.prototype.createFilter=function(){this.filter||(this.filter=l(this.layer.filter))};var d={}},{"../style/style_layer":46,"../util/util":98,"./bucket/circle_bucket":2,"./bucket/fill_bucket":3,"./bucket/line_bucket":4,"./bucket/symbol_bucket":5,"./buffer":6,"feature-filter":100}],2:[function(t,e,n){"use strict";function i(){r.apply(this,arguments)}var r=t("../bucket"),o=t("../../util/util"),a=t("../load_geometry"),s=r.EXTENT;e.exports=i,i.prototype=o.inherit(r,{}),i.prototype.shaderInterfaces={circle:{vertexBuffer:!0,elementBuffer:!0,attributeArgs:["x","y","extrudeX","extrudeY"],attributes:[{name:"pos",components:2,type:r.AttributeType.SHORT,value:["(x * 2) + ((extrudeX + 1) / 2)","(y * 2) + ((extrudeY + 1) / 2)"]}]}},i.prototype.addFeature=function(t){for(var e=a(t),n=0;n<e.length;n++)for(var i=e[n],r=0;r<i.length;r++){var o=this.makeRoomFor("circle",4),u=i[r].x,l=i[r].y;if(!(0>u||u>=s||0>l||l>=s)){var c=this.addCircleVertex(u,l,-1,-1)-o.vertexStartIndex;this.addCircleVertex(u,l,1,-1),this.addCircleVertex(u,l,1,1),this.addCircleVertex(u,l,-1,1),o.vertexLength+=4,this.addCircleElement(c,c+1,c+2),this.addCircleElement(c,c+3,c+2),o.elementLength+=2}}}},{"../../util/util":98,"../bucket":1,"../load_geometry":8}],3:[function(t,e,n){"use strict";function i(){r.apply(this,arguments)}var r=t("../bucket"),o=t("../../util/util"),a=t("../load_geometry");e.exports=i,i.prototype=o.inherit(r,{}),i.prototype.shaderInterfaces={fill:{vertexBuffer:!0,elementBuffer:!0,secondElementBuffer:!0,secondElementBufferComponents:2,attributeArgs:["x","y"],attributes:[{name:"pos",components:2,type:r.AttributeType.SHORT,value:["x","y"]}]}},i.prototype.addFeature=function(t){for(var e=a(t),n=0;n<e.length;n++)this.addFill(e[n])},i.prototype.addFill=function(t){if(!(t.length<3))for(var e,n,i=t.length,r=this.makeRoomFor("fill",i+1),o=0;o<t.length;o++){var a=t[o],s=this.addFillVertex(a.x,a.y)-r.vertexStartIndex;r.vertexLength++,0===o&&(e=s),o>=2&&(a.x!==t[0].x||a.y!==t[0].y)&&(this.addFillElement(e,n,s),r.elementLength++),o>=1&&(this.addFillSecondElement(n,s),r.secondElementLength++),n=s}}},{"../../util/util":98,"../bucket":1,"../load_geometry":8}],4:[function(t,e,n){"use strict";function i(){r.apply(this,arguments)}var r=t("../bucket"),o=t("../../util/util"),a=t("../load_geometry"),s=r.EXTENT,u=63,l=Math.cos(37.5*(Math.PI/180)),c=15,h=14,f=.5,d=Math.pow(2,h)/f;e.exports=i,i.prototype=o.inherit(r,{}),i.prototype.shaderInterfaces={line:{vertexBuffer:!0,elementBuffer:!0,attributeArgs:["point","extrude","tx","ty","dir","linesofar"],attributes:[{name:"pos",components:2,type:r.AttributeType.SHORT,value:["(point.x << 1) | tx","(point.y << 1) | ty"]},{name:"data",components:4,type:r.AttributeType.UNSIGNED_BYTE,value:["Math.round("+u+" * extrude.x) + 128","Math.round("+u+" * extrude.y) + 128","((dir === 0 ? 0 : (dir < 0 ? -1 : 1)) + 1) | (((linesofar * "+f+") & 0x3F) << 2)","(linesofar * "+f+") >> 6"]}]}},i.prototype.addFeature=function(t){for(var e=a(t),n=0;n<e.length;n++)this.addLine(e[n],this.layer.layout["line-join"],this.layer.layout["line-cap"],this.layer.layout["line-miter-limit"],this.layer.layout["line-round-limit"])},i.prototype.addLine=function(t,e,n,i,r){for(var o=t.length;o>2&&t[o-1].equals(t[o-2]);)o--;if(!(t.length<2)){"bevel"===e&&(i=1.05);var a=c*(s/(512*this.overscaling)),u=t[0],h=t[o-1],f=u.equals(h);if(this.makeRoomFor("line",10*o),2!==o||!f){this.distance=0;var d,p,m,v,y,g,_,x=n,b=f?"butt":n,w=!0;this.e1=this.e2=this.e3=-1,f&&(d=t[o-2],y=u.sub(d)._unit()._perp());for(var S=0;o>S;S++)if(m=f&&S===o-1?t[1]:t[S+1],!m||!t[S].equals(m)){y&&(v=y),d&&(p=d),d=t[S],y=m?m.sub(d)._unit()._perp():v,v=v||y;var M=v.add(y)._unit(),E=M.x*y.x+M.y*y.y,T=1/E,D=l>E&&p&&m;if(D&&S>0){var I=d.dist(p);if(I>2*a){var z=d.sub(d.sub(p)._mult(a/I)._round());this.distance+=z.dist(p),this.addCurrentVertex(z,this.distance,v.mult(1),0,0,!1),p=z}}var A=p&&m,k=A?e:m?x:b;if(A&&"round"===k&&(r>T?k="miter":2>=T&&(k="fakeround")),"miter"===k&&T>i&&(k="bevel"),"bevel"===k&&(T>2&&(k="flipbevel"),i>T&&(k="miter")),p&&(this.distance+=d.dist(p)),"miter"===k)M._mult(T),this.addCurrentVertex(d,this.distance,M,0,0,!1);else if("flipbevel"===k){if(T>100)M=y.clone();else{var L=v.x*y.y-v.y*y.x>0?-1:1,C=T*v.add(y).mag()/v.sub(y).mag();M._perp()._mult(C*L)}this.addCurrentVertex(d,this.distance,M,0,0,!1),this.addCurrentVertex(d,this.distance,M.mult(-1),0,0,!1)}else if("bevel"===k||"fakeround"===k){var P=v.x*y.y-v.y*y.x>0,F=-Math.sqrt(T*T-1);if(P?(_=0,g=F):(g=0,_=F),w||this.addCurrentVertex(d,this.distance,v,g,_,!1),"fakeround"===k){for(var j,O=Math.floor(8*(.5-(E-.5))),R=0;O>R;R++)j=y.mult((R+1)/(O+1))._add(v)._unit(),this.addPieSliceVertex(d,this.distance,j,P);this.addPieSliceVertex(d,this.distance,M,P);for(var N=O-1;N>=0;N--)j=v.mult((N+1)/(O+1))._add(y)._unit(),this.addPieSliceVertex(d,this.distance,j,P)}m&&this.addCurrentVertex(d,this.distance,y,-g,-_,!1)}else"butt"===k?(w||this.addCurrentVertex(d,this.distance,v,0,0,!1),m&&this.addCurrentVertex(d,this.distance,y,0,0,!1)):"square"===k?(w||(this.addCurrentVertex(d,this.distance,v,1,1,!1),this.e1=this.e2=-1),m&&this.addCurrentVertex(d,this.distance,y,-1,-1,!1)):"round"===k&&(w||(this.addCurrentVertex(d,this.distance,v,0,0,!1),this.addCurrentVertex(d,this.distance,v,1,1,!0),this.e1=this.e2=-1),m&&(this.addCurrentVertex(d,this.distance,y,-1,-1,!0),this.addCurrentVertex(d,this.distance,y,0,0,!1)));if(D&&o-1>S){var B=d.dist(m);if(B>2*a){var q=d.add(m.sub(d)._mult(a/B)._round());this.distance+=q.dist(d),this.addCurrentVertex(q,this.distance,y.mult(1),0,0,!1),d=q}}w=!1}}}},i.prototype.addCurrentVertex=function(t,e,n,i,r,o){var a,s=o?1:0,u=this.elementGroups.line[this.elementGroups.line.length-1];u.vertexLength+=2,a=n.clone(),i&&a._sub(n.perp()._mult(i)),this.e3=this.addLineVertex(t,a,s,0,i,e)-u.vertexStartIndex,this.e1>=0&&this.e2>=0&&(this.addLineElement(this.e1,this.e2,this.e3),u.elementLength++),this.e1=this.e2,this.e2=this.e3,a=n.mult(-1),r&&a._sub(n.perp()._mult(r)),this.e3=this.addLineVertex(t,a,s,1,-r,e)-u.vertexStartIndex,this.e1>=0&&this.e2>=0&&(this.addLineElement(this.e1,this.e2,this.e3),u.elementLength++),this.e1=this.e2,this.e2=this.e3,e>d/2&&(this.distance=0,this.addCurrentVertex(t,this.distance,n,i,r,o))},i.prototype.addPieSliceVertex=function(t,e,n,i){var r=i?1:0;n=n.mult(i?-1:1);var o=this.elementGroups.line[this.elementGroups.line.length-1];this.e3=this.addLineVertex(t,n,0,r,0,e)-o.vertexStartIndex,o.vertexLength++,this.e1>=0&&this.e2>=0&&(this.addLineElement(this.e1,this.e2,this.e3),o.elementLength++),i?this.e2=this.e3:this.e1=this.e3}},{"../../util/util":98,"../bucket":1,"../load_geometry":8}],5:[function(t,e,n){"use strict";function i(t){a.apply(this,arguments),this.collisionDebug=t.collisionDebug,this.overscaling=t.overscaling}function r(t,e,n,i,r,o,a,s,u,l,c,h,f){this.x=t.x,this.y=t.y,this.index=a,this.hasText=!!n,this.hasIcon=!!i,this.hasText&&(this.glyphQuads=o?x(t,n,s,e,r,l):[],this.textCollisionFeature=new y(e,t,n,s,u,l,!1)),this.hasIcon&&(this.iconQuads=o?b(t,i,c,e,r,f):[],this.iconCollisionFeature=new y(e,t,i,c,h,f,!0))}var o=t("point-geometry"),a=t("../bucket"),s=t("../../symbol/anchor"),u=t("../../symbol/get_anchors"),l=t("../../util/token"),c=t("../../symbol/quads"),h=t("../../symbol/shaping"),f=t("../../symbol/resolve_text"),d=t("../../symbol/mergelines"),p=t("../../symbol/clip_line"),m=t("../../util/util"),v=t("../load_geometry"),y=t("../../symbol/collision_feature"),g=h.shapeText,_=h.shapeIcon,x=c.getGlyphQuads,b=c.getIconQuads,w=a.EXTENT;e.exports=i,i.prototype=m.inherit(a,{});var S=["x","y","ox","oy","tx","ty","minzoom","maxzoom","labelminzoom"],M=[{name:"pos",components:2,type:a.AttributeType.SHORT,value:["x","y"]},{name:"offset",components:2,type:a.AttributeType.SHORT,value:["Math.round(ox * 64)","Math.round(oy * 64)"]},{name:"data1",components:4,type:a.AttributeType.UNSIGNED_BYTE,value:["tx / 4","ty / 4","(labelminzoom || 0) * 10","0"]},{name:"data2",components:2,type:a.AttributeType.UNSIGNED_BYTE,value:["(minzoom || 0) * 10","Math.min(maxzoom || 25, 25) * 10"]}];i.prototype.shaderInterfaces={glyph:{vertexBuffer:!0,elementBuffer:!0,attributeArgs:S,attributes:M},icon:{vertexBuffer:!0,elementBuffer:!0,attributeArgs:S,attributes:M},collisionBox:{vertexBuffer:!0,attributeArgs:["point","extrude","maxZoom","placementZoom"],attributes:[{name:"pos",components:2,type:a.AttributeType.SHORT,value:["point.x","point.y"]},{name:"extrude",components:2,type:a.AttributeType.SHORT,value:["Math.round(extrude.x)","Math.round(extrude.y)"]},{name:"data",components:2,type:a.AttributeType.UNSIGNED_BYTE,value:["maxZoom * 10","placementZoom * 10"]}]}},i.prototype.populateBuffers=function(t,e,n){this.createStyleLayer();var i={lastIntegerZoom:1/0,lastIntegerZoomTime:0,lastZoom:0};this.adjustedTextMaxSize=this.layer.getLayoutValue("text-size",18,i),this.adjustedTextSize=this.layer.getLayoutValue("text-size",this.zoom+1,i),this.adjustedIconMaxSize=this.layer.getLayoutValue("icon-size",18,i),this.adjustedIconSize=this.layer.getLayoutValue("icon-size",this.zoom+1,i);var r=512*this.overscaling;this.tilePixelRatio=w/r,this.compareText={},this.symbolInstances=[],this.iconsNeedLinear=!1;var o=this.layer.layout,a=this.features,s=this.textFeatures,u=.5,c=.5;switch(o["text-anchor"]){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(o["text-anchor"]){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}for(var h="right"===o["text-justify"]?1:"left"===o["text-justify"]?0:.5,f=24,p=o["text-line-height"]*f,m="line"!==o["symbol-placement"]?o["text-max-width"]*f:0,y=o["text-letter-spacing"]*f,x=[o["text-offset"][0]*f,o["text-offset"][1]*f],b=o["text-font"].join(","),S=[],M=0;M<a.length;M++)S.push(v(a[M]));
if("line"===o["symbol-placement"]){var E=d(a,s,S);S=E.geometries,a=E.features,s=E.textFeatures}for(var T,D,I=0;I<a.length;I++)if(S[I]){if(T=s[I]?g(s[I],e[b],m,p,u,c,h,y,x):null,o["icon-image"]){var z=l(a[I].properties,o["icon-image"]),A=n[z];D=_(A,o),A&&(void 0===this.sdfIcons?this.sdfIcons=A.sdf:this.sdfIcons!==A.sdf&&console.warn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),1!==A.pixelRatio&&(this.iconsNeedLinear=!0))}else D=null;(T||D)&&this.addFeature(S[I],T,D)}this.placeFeatures(t,this.collisionDebug),this.trimBuffers()},i.prototype.addFeature=function(t,e,n){var i=this.layer.layout,o=24,a=this.adjustedTextSize/o,l=void 0!==this.adjustedTextMaxSize?this.adjustedTextMaxSize:this.adjustedTextSize,c=this.tilePixelRatio*a,h=this.tilePixelRatio*l/o,f=this.tilePixelRatio*this.adjustedIconSize,d=this.tilePixelRatio*i["symbol-spacing"],m=i["symbol-avoid-edges"],v=i["text-padding"]*this.tilePixelRatio,y=i["icon-padding"]*this.tilePixelRatio,g=i["text-max-angle"]/180*Math.PI,_="map"===i["text-rotation-alignment"]&&"line"===i["symbol-placement"],x="map"===i["icon-rotation-alignment"]&&"line"===i["symbol-placement"],b=i["text-allow-overlap"]||i["icon-allow-overlap"]||i["text-ignore-placement"]||i["icon-ignore-placement"],S="line"===i["symbol-placement"],M=d/2;S&&(t=p(t,0,0,w,w));for(var E=0;E<t.length;E++){var T,D=t[E];T=S?u(D,d,g,e,n,o,h,this.overscaling,w):[new s(D[0].x,D[0].y,0)];for(var I=0,z=T.length;z>I;I++){var A=T[I];if(!(e&&S&&this.anchorIsTooClose(e.text,M,A))){var k=!(A.x<0||A.x>w||A.y<0||A.y>w);if(!m||k){var L=k||b;this.symbolInstances.push(new r(A,D,e,n,i,L,this.symbolInstances.length,c,v,_,f,y,x))}}}}},i.prototype.anchorIsTooClose=function(t,e,n){var i=this.compareText;if(t in i){for(var r=i[t],o=r.length-1;o>=0;o--)if(n.dist(r[o])<e)return!0}else i[t]=[];return i[t].push(n),!1},i.prototype.placeFeatures=function(t,e){this.createBuffers();var n=this.elementGroups={glyph:[],icon:[],sdfIcons:this.sdfIcons,iconsNeedLinear:this.iconsNeedLinear},i=this.layer.layout,r=t.maxScale;n.glyph.adjustedSize=this.adjustedTextSize,n.icon.adjustedSize=this.adjustedIconSize,n.glyph.fontstack=i["text-font"].join(",");var o="map"===i["text-rotation-alignment"]&&"line"===i["symbol-placement"],a="map"===i["icon-rotation-alignment"]&&"line"===i["symbol-placement"],s=i["text-allow-overlap"]||i["icon-allow-overlap"]||i["text-ignore-placement"]||i["icon-ignore-placement"];if(s){var u=t.angle,l=Math.sin(u),c=Math.cos(u);this.symbolInstances.sort(function(t,e){var n=l*t.x+c*t.y|0,i=l*e.x+c*e.y|0;return n-i||e.index-t.index})}for(var h=0;h<this.symbolInstances.length;h++){var f=this.symbolInstances[h],d=f.hasText,p=f.hasIcon,m=i["text-optional"]||!d,v=i["icon-optional"]||!p,y=d?t.placeCollisionFeature(f.textCollisionFeature,i["text-allow-overlap"],i["symbol-avoid-edges"]):t.minScale,g=p?t.placeCollisionFeature(f.iconCollisionFeature,i["icon-allow-overlap"],i["symbol-avoid-edges"]):t.minScale;m||v?!v&&y?y=Math.max(g,y):!m&&g&&(g=Math.max(g,y)):g=y=Math.max(g,y),d&&(i["text-ignore-placement"]||t.insertCollisionFeature(f.textCollisionFeature,y),r>=y&&this.addSymbols("glyph",f.glyphQuads,y,i["text-keep-upright"],o,t.angle)),p&&(i["icon-ignore-placement"]||t.insertCollisionFeature(f.iconCollisionFeature,g),r>=g&&this.addSymbols("icon",f.iconQuads,g,i["icon-keep-upright"],a,t.angle))}e&&this.addToDebugBuffers(t)},i.prototype.addSymbols=function(t,e,n,i,r,o){for(var a=this.makeRoomFor(t,4*e.length),s=this[this.getAddMethodName(t,"element")].bind(this),u=this[this.getAddMethodName(t,"vertex")].bind(this),l=this.zoom,c=Math.max(Math.log(n)/Math.LN2+l,0),h=0;h<e.length;h++){var f=e[h],d=f.angle,p=(d+o+Math.PI)%(2*Math.PI);if(!(i&&r&&(p<=Math.PI/2||p>3*Math.PI/2))){var m=f.tl,v=f.tr,y=f.bl,g=f.br,_=f.tex,x=f.anchorPoint,b=Math.max(l+Math.log(f.minScale)/Math.LN2,c),w=Math.min(l+Math.log(f.maxScale)/Math.LN2,25);if(!(b>=w)){b===c&&(b=0);var S=u(x.x,x.y,m.x,m.y,_.x,_.y,b,w,c)-a.vertexStartIndex;u(x.x,x.y,v.x,v.y,_.x+_.w,_.y,b,w,c),u(x.x,x.y,y.x,y.y,_.x,_.y+_.h,b,w,c),u(x.x,x.y,g.x,g.y,_.x+_.w,_.y+_.h,b,w,c),a.vertexLength+=4,s(S,S+1,S+2),s(S+1,S+2,S+3),a.elementLength+=2}}}},i.prototype.updateIcons=function(t){this.createStyleLayer();var e=this.layer.layout["icon-image"];if(e)for(var n=0;n<this.features.length;n++){var i=l(this.features[n].properties,e);i&&(t[i]=!0)}},i.prototype.updateFont=function(t){this.createStyleLayer();var e=this.layer.layout["text-font"],n=t[e]=t[e]||{};this.textFeatures=f(this.features,this.layer.layout,n)},i.prototype.addToDebugBuffers=function(t){this.elementGroups.collisionBox=[];for(var e=this.makeRoomFor("collisionBox",0),n=-t.angle,i=t.yStretch,r=0;r<this.symbolInstances.length;r++)for(var a=0;2>a;a++){var s=this.symbolInstances[r][0===a?"textCollisionFeature":"iconCollisionFeature"];if(s)for(var u=s.boxes,l=0;l<u.length;l++){var c=u[l],h=c.anchorPoint,f=new o(c.x1,c.y1*i)._rotate(n),d=new o(c.x2,c.y1*i)._rotate(n),p=new o(c.x1,c.y2*i)._rotate(n),m=new o(c.x2,c.y2*i)._rotate(n),v=Math.max(0,Math.min(25,this.zoom+Math.log(c.maxScale)/Math.LN2)),y=Math.max(0,Math.min(25,this.zoom+Math.log(c.placementScale)/Math.LN2));this.addCollisionBoxVertex(h,f,v,y),this.addCollisionBoxVertex(h,d,v,y),this.addCollisionBoxVertex(h,d,v,y),this.addCollisionBoxVertex(h,m,v,y),this.addCollisionBoxVertex(h,m,v,y),this.addCollisionBoxVertex(h,p,v,y),this.addCollisionBoxVertex(h,p,v,y),this.addCollisionBoxVertex(h,f,v,y),e.vertexLength+=8}}}},{"../../symbol/anchor":56,"../../symbol/clip_line":58,"../../symbol/collision_feature":60,"../../symbol/get_anchors":62,"../../symbol/mergelines":65,"../../symbol/quads":66,"../../symbol/resolve_text":67,"../../symbol/shaping":68,"../../util/token":97,"../../util/util":98,"../bucket":1,"../load_geometry":8,"point-geometry":148}],6:[function(t,e,n){"use strict";function i(t){if(this.type=t.type,t.arrayBuffer)this.capacity=t.capacity,this.arrayBuffer=t.arrayBuffer,this.attributes=t.attributes,this.itemSize=t.itemSize,this.length=t.length;else{this.capacity=r(i.CAPACITY_DEFAULT,i.CAPACITY_ALIGNMENT),this.arrayBuffer=new ArrayBuffer(this.capacity),this.attributes=[],this.itemSize=0,this.length=0;var e=this.type===i.BufferType.VERTEX?i.VERTEX_ATTRIBUTE_ALIGNMENT:1;this.attributes=t.attributes.map(function(t){var n={};return n.name=t.name,n.components=t.components||1,n.type=t.type||i.AttributeType.UNSIGNED_BYTE,n.size=n.type.size*n.components,n.offset=this.itemSize,this.itemSize=r(n.offset+n.size,e),n},this),this._createPushMethod(),this._refreshViews()}}function r(t,e){e=e||1;var n=t%e;return 1!==e&&0!==n&&(t+=e-n),t}i.prototype.serialize=function(){return{type:this.type,capacity:this.capacity,arrayBuffer:this.arrayBuffer,attributes:this.attributes,itemSize:this.itemSize,length:this.length}},i.prototype.bind=function(t){var e=t[this.type];this.buffer?t.bindBuffer(e,this.buffer):(this.buffer=t.createBuffer(),t.bindBuffer(e,this.buffer),t.bufferData(e,this.arrayBuffer,t.STATIC_DRAW),this.arrayBuffer=null)},i.prototype.destroy=function(t){this.buffer&&t.deleteBuffer(this.buffer)},i.prototype.setAttribPointers=function(t,e,n){for(var i=0;i<this.attributes.length;i++){var r=this.attributes[i];t.vertexAttribPointer(e["a_"+r.name],r.components,t[r.type.name],!1,this.itemSize,n+r.offset)}},i.prototype.trim=function(){this.capacity=r(this.itemSize*this.length,i.CAPACITY_ALIGNMENT),this.arrayBuffer=this.arrayBuffer.slice(0,this.capacity),this._refreshViews()},i.prototype.get=function(t){this._refreshViews();for(var e={},n=t*this.itemSize,i=0;i<this.attributes.length;i++)for(var r=this.attributes[i],o=e[r.name]=[],a=0;a<r.components;a++){var s=(n+r.offset)/r.type.size+a;o.push(this.views[r.type.name][s])}return e},i.prototype.validate=function(t){for(var e=0;e<this.attributes.length;e++)for(var n=0;n<this.attributes[e].components;n++);},i.prototype._resize=function(t){var e=this.views.UNSIGNED_BYTE;this.capacity=r(t,i.CAPACITY_ALIGNMENT),this.arrayBuffer=new ArrayBuffer(this.capacity),this._refreshViews(),this.views.UNSIGNED_BYTE.set(e)},i.prototype._refreshViews=function(){this.views={UNSIGNED_BYTE:new Uint8Array(this.arrayBuffer),BYTE:new Int8Array(this.arrayBuffer),UNSIGNED_SHORT:new Uint16Array(this.arrayBuffer),SHORT:new Int16Array(this.arrayBuffer)}};var o={};i.prototype._createPushMethod=function(){var t="",e=[];t+="var i = this.length++;\n",t+="var o = i * "+this.itemSize+";\n",t+="if (o + "+this.itemSize+" > this.capacity) { this._resize(this.capacity * "+i.CAPACITY_RESIZE_MULTIPLIER+"); }\n";for(var n=0;n<this.attributes.length;n++){var r=this.attributes[n],a="o"+n;t+="\nvar "+a+" = (o + "+r.offset+") / "+r.type.size+";\n";for(var s=0;s<r.components;s++){var u="v"+e.length,l="this.views."+r.type.name+"["+a+" + "+s+"]";t+=l+" = "+u+";\n",e.push(u)}}t+="\nreturn i;\n",o[t]||(o[t]=new Function(e,t)),this.push=o[t]},i.BufferType={VERTEX:"ARRAY_BUFFER",ELEMENT:"ELEMENT_ARRAY_BUFFER"},i.AttributeType={BYTE:{size:1,name:"BYTE"},UNSIGNED_BYTE:{size:1,name:"UNSIGNED_BYTE"},SHORT:{size:2,name:"SHORT"},UNSIGNED_SHORT:{size:2,name:"UNSIGNED_SHORT"}},i.ELEMENT_ATTRIBUTE_TYPE=i.AttributeType.UNSIGNED_SHORT,i.CAPACITY_DEFAULT=1024,i.CAPACITY_RESIZE_MULTIPLIER=5,i.CAPACITY_ALIGNMENT=2,i.VERTEX_ATTRIBUTE_ALIGNMENT=4,e.exports=i},{}],7:[function(t,e,n){"use strict";function i(t,e){this.x=t.x,this.y=t.y,this.z=t.z-Math.log(e)/Math.LN2,this.rtree=p(9),this.toBeInserted=[]}function r(t,e,n){return"Point"===e?u(t,n):"LineString"===e?a(t,n):"Polygon"===e?o(t,n)||a(t,n):!1}function o(t,e){return f(t,new m(e[0],e[1]))||f(t,new m(e[0],e[3]))||f(t,new m(e[2],e[1]))||f(t,new m(e[2],e[3]))?!0:a(t,e)}function a(t,e){for(var n=0;n<t.length;n++)for(var i=t[n],r=0,o=i.length-1;r<i.length;o=r++){var a=i[r],l=i[o],c=new m(a.y,a.x),h=new m(l.y,l.x);if(s(a,l,e[0],e[2],e[1])||s(a,l,e[0],e[2],e[3])||s(c,h,e[1],e[3],e[0])||s(c,h,e[1],e[3],e[2]))return!0}return u(t,e)}function s(t,e,n,i,r){if(e.y===t.y)return e.y===r&&Math.min(t.x,e.x)<=i&&Math.max(t.x,e.x)>=n;var o=(r-t.y)/(e.y-t.y),a=t.x+o*(e.x-t.x);return a>=n&&i>=a&&1>=o&&o>=0}function u(t,e){for(var n=0;n<t.length;n++)for(var i=t[n],r=0;r<i.length;r++)if(i[r].x>=e[0]&&i[r].y>=e[1]&&i[r].x<=e[2]&&i[r].y<=e[3])return!0;return!1}function l(t,e,n,i){return"Point"===e?d(t,n,i):"LineString"===e?h(t,n,i):"Polygon"===e?f(t,n)||h(t,n,i):!1}function c(t,e,n){var i=e.distSqr(n);if(0===i)return t.distSqr(e);var r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return 0>r?t.distSqr(e):r>1?t.distSqr(n):t.distSqr(n.sub(e)._mult(r)._add(e))}function h(t,e,n){for(var i=n*n,r=0;r<t.length;r++)for(var o=t[r],a=1;a<o.length;a++){var s=o[a-1],u=o[a];if(c(e,s,u)<i)return!0}return!1}function f(t,e){for(var n,i,r,o=!1,a=0;a<t.length;a++){n=t[a];for(var s=0,u=n.length-1;s<n.length;u=s++)i=n[s],r=n[u],i.y>e.y!=r.y>e.y&&e.x<(r.x-i.x)*(e.y-i.y)/(r.y-i.y)+i.x&&(o=!o)}return o}function d(t,e,n){for(var i=n*n,r=0;r<t.length;r++)for(var o=t[r],a=0;a<o.length;a++)if(o[a].distSqr(e)<=i)return!0;return!1}var p=t("rbush"),m=t("point-geometry"),v=t("vector-tile"),y=t("../util/util"),g=t("./load_geometry"),_=t("./bucket").EXTENT;e.exports=i,i.prototype.insert=function(t,e,n){var i=_/n.extent;t[0]*=i,t[1]*=i,t[2]*=i,t[3]*=i,t.layers=e,t.feature=n,this.toBeInserted.push(t)},i.prototype._load=function(){this.rtree.load(this.toBeInserted),this.toBeInserted=[]},i.prototype.query=function(t,e){this.toBeInserted.length&&this._load();var n,i,o=t.params||{},a=t.x,s=t.y,u=[];"undefined"!=typeof a&&"undefined"!=typeof s?(n=(o.radius||0)*_/t.tileSize/t.scale,i=[a-n,s-n,a+n,s+n]):i=[t.minX,t.minY,t.maxX,t.maxY];for(var c=this.rtree.search(i),h=0;h<c.length;h++){var f=c[h].feature,d=c[h].layers,p=v.VectorTileFeature.types[f.type];if((!o.$type||p===o.$type)&&(!n||l(g(f),p,new m(a,s),n))&&r(g(f),p,i)){var x=f.toGeoJSON(this.x,this.y,this.z);o.includeGeometry||(x.geometry=null);for(var b=0;b<d.length;b++){var w=d[b];o.layerIds&&o.layerIds.indexOf(w)<0||u.push(y.extend({layer:w},x))}}}e(null,u)}},{"../util/util":98,"./bucket":1,"./load_geometry":8,"point-geometry":148,rbush:150,"vector-tile":157}],8:[function(t,e,n){"use strict";var i=t("./bucket").EXTENT;e.exports=function(t){for(var e=i/t.extent,n=t.loadGeometry(),r=0;r<n.length;r++)for(var o=n[r],a=0;a<o.length;a++){var s=o[a];s.x=Math.round(s.x*e),s.y=Math.round(s.y*e)}return n}},{"./bucket":1}],9:[function(t,e,n){"use strict";function i(t,e,n){this.column=t,this.row=e,this.zoom=n}e.exports=i,i.prototype={clone:function(){return new i(this.column,this.row,this.zoom)},zoomTo:function(t){return this.clone()._zoomTo(t)},sub:function(t){return this.clone()._sub(t)},_zoomTo:function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},_sub:function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this}}},{}],10:[function(t,e,n){"use strict";function i(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}e.exports=i;var r=t("../util/util").wrap;i.prototype.wrap=function(){return new i(r(this.lng,-180,180),this.lat)},i.prototype.toArray=function(){return[this.lng,this.lat]},i.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t}},{"../util/util":98}],11:[function(t,e,n){"use strict";function i(t,e){t&&(e?this.extend(t).extend(e):4===t.length?this.extend([t[0],t[1]]).extend([t[2],t[3]]):this.extend(t[0]).extend(t[1]))}e.exports=i;var r=t("./lng_lat");i.prototype={extend:function(t){var e,n,o=this._sw,a=this._ne;if(t instanceof r)e=t,n=t;else{if(!(t instanceof i))return t?this.extend(r.convert(t)||i.convert(t)):this;if(e=t._sw,n=t._ne,!e||!n)return this}return o||a?(o.lng=Math.min(e.lng,o.lng),o.lat=Math.min(e.lat,o.lat),a.lng=Math.max(n.lng,a.lng),a.lat=Math.max(n.lat,a.lat)):(this._sw=new r(e.lng,e.lat),this._ne=new r(n.lng,n.lat)),this},getCenter:function(){return new r((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},getNorthWest:function(){return new r(this.getWest(),this.getNorth())},getSouthEast:function(){return new r(this.getEast(),this.getSouth())},getWest:function(){return this._sw.lng},getSouth:function(){return this._sw.lat},getEast:function(){return this._ne.lng},getNorth:function(){return this._ne.lat},toArray:function(){return[this._sw.toArray(),this._ne.toArray()]},toString:function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"}},i.convert=function(t){return!t||t instanceof i?t:new i(t)}},{"./lng_lat":10}],12:[function(t,e,n){"use strict";function i(t,e){this.tileSize=512,this._minZoom=t||0,this._maxZoom=e||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this._center=new r(0,0),this.zoom=0,this.angle=0,this._altitude=1.5,this._pitch=0,this._unmodified=!0}var r=t("./lng_lat"),o=t("point-geometry"),a=t("./coordinate"),s=t("../util/util").wrap,u=t("../util/interpolate"),l=t("gl-matrix"),c=l.vec4,h=l.mat4,f=l.mat2;e.exports=i,i.prototype={get minZoom(){return this._minZoom},set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},get maxZoom(){return this._maxZoom},set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},get worldSize(){return this.tileSize*this.scale},get centerPoint(){return this.size._div(2)},get size(){return new o(this.width,this.height)},get bearing(){return-this.angle/Math.PI*180},set bearing(t){var e=-s(t,-180,180)*Math.PI/180;this.angle!==e&&(this._unmodified=!1,this.angle=e,this._calcProjMatrix(),this.rotationMatrix=f.create(),f.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},get pitch(){return this._pitch/Math.PI*180},set pitch(t){var e=Math.min(60,t)/180*Math.PI;this._pitch!==e&&(this._unmodified=!1,this._pitch=e,this._calcProjMatrix())},get altitude(){return this._altitude},set altitude(t){var e=Math.max(.75,t);this._altitude!==e&&(this._unmodified=!1,this._altitude=e,this._calcProjMatrix())},get zoom(){return this._zoom},set zoom(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._calcProjMatrix(),this._constrain())},get center(){return this._center},set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._calcProjMatrix(),this._constrain())},resize:function(t,e){this.width=t,this.height=e,this.exMatrix=h.create(),h.ortho(this.exMatrix,0,t,e,0,0,-1),this._calcProjMatrix(),this._constrain()},get unmodified(){return this._unmodified},zoomScale:function(t){return Math.pow(2,t)},scaleZoom:function(t){return Math.log(t)/Math.LN2},project:function(t,e){return new o(this.lngX(t.lng,e),this.latY(t.lat,e))},unproject:function(t,e){return new r(this.xLng(t.x,e),this.yLat(t.y,e))},get x(){return this.lngX(this.center.lng)},get y(){return this.latY(this.center.lat)},get point(){return new o(this.x,this.y)},lngX:function(t,e){return(180+t)*(e||this.worldSize)/360},latY:function(t,e){var n=180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360));return(180-n)*(e||this.worldSize)/360},xLng:function(t,e){return 360*t/(e||this.worldSize)-180},yLat:function(t,e){var n=180-360*t/(e||this.worldSize);return 360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90},panBy:function(t){var e=this.centerPoint._add(t);this.center=this.pointLocation(e)},setLocationAtPoint:function(t,e){var n=this.locationCoordinate(t),i=this.pointCoordinate(e),r=this.pointCoordinate(this.centerPoint),o=i._sub(n);this._unmodified=!1,this.center=this.coordinateLocation(r._sub(o))},locationPoint:function(t){return this.coordinatePoint(this.locationCoordinate(t))},pointLocation:function(t){return this.coordinateLocation(this.pointCoordinate(t))},locationCoordinate:function(t){var e=this.zoomScale(this.tileZoom)/this.worldSize,n=r.convert(t);return new a(this.lngX(n.lng)*e,this.latY(n.lat)*e,this.tileZoom)},coordinateLocation:function(t){var e=this.zoomScale(t.zoom);return new r(this.xLng(t.column,e),this.yLat(t.row,e))},pointCoordinate:function(t,e){void 0===e&&(e=0);var n=this.coordinatePointMatrix(this.tileZoom);if(h.invert(n,n),!n)throw new Error("failed to invert matrix");var i=[t.x,t.y,0,1],r=[t.x,t.y,1,1];c.transformMat4(i,i,n),c.transformMat4(r,r,n);var o=i[3],s=r[3],l=i[0]/o,f=r[0]/s,d=i[1]/o,p=r[1]/s,m=i[2]/o,v=r[2]/s,y=m===v?0:(e-m)/(v-m);return new a(u(l,f,y),u(d,p,y),this.tileZoom)},coordinatePoint:function(t){var e=this.coordinatePointMatrix(t.zoom),n=[t.column,t.row,0,1];return c.transformMat4(n,n,e),new o(n[0]/n[3],n[1]/n[3])},coordinatePointMatrix:function(t){var e=h.copy(new Float64Array(16),this.projMatrix),n=this.worldSize/this.zoomScale(t);return h.scale(e,e,[n,n,1]),h.multiply(e,this.getPixelMatrix(),e),e},getPixelMatrix:function(){var t=h.create();return h.scale(t,t,[this.width/2,-this.height/2,1]),h.translate(t,t,[1,-1,0]),t},_constrain:function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,e,n,i,r,a,s,u,l=this.size,c=this._unmodified;this.latRange&&(t=this.latY(this.latRange[1]),e=this.latY(this.latRange[0]),r=e-t<l.y?l.y/(e-t):0),this.lngRange&&(n=this.lngX(this.lngRange[0]),i=this.lngX(this.lngRange[1]),a=i-n<l.x?l.x/(i-n):0);var h=Math.max(a||0,r||0);if(h)return this.center=this.unproject(new o(a?(i+n)/2:this.x,r?(e+t)/2:this.y)),this.zoom+=this.scaleZoom(h),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var f=this.y,d=l.y/2;t>f-d&&(u=t+d),f+d>e&&(u=e-d)}if(this.lngRange){var p=this.x,m=l.x/2;n>p-m&&(s=n+m),p+m>i&&(s=i-m)}void 0===s&&void 0===u||(this.center=this.unproject(new o(void 0!==s?s:this.x,void 0!==u?u:this.y))),this._unmodified=c,this._constraining=!1}},_calcProjMatrix:function(){var t=new Float64Array(16),e=Math.atan(.5/this.altitude),n=Math.sin(e)*this.altitude/Math.sin(Math.PI/2-this._pitch-e),i=Math.cos(Math.PI/2-this._pitch)*n+this.altitude;h.perspective(t,2*Math.atan(this.height/2/this.altitude),this.width/this.height,.1,i),h.translate(t,t,[0,0,-this.altitude]),h.scale(t,t,[1,-1,1/this.height]),h.rotateX(t,t,this._pitch),h.rotateZ(t,t,this.angle),h.translate(t,t,[-this.x,-this.y,0]),this.projMatrix=t}}},{"../util/interpolate":94,"../util/util":98,"./coordinate":9,"./lng_lat":10,"gl-matrix":108,"point-geometry":148}],13:[function(t,e,n){"use strict";var i={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]};e.exports=function(t,e,n,r){r=r||1;var o,a,s,u,l,c,h,f,d=[];for(o=0,a=t.length;a>o;o++)if(l=i[t[o]]){for(f=null,s=0,u=l[1].length;u>s;s+=2)-1===l[1][s]&&-1===l[1][s+1]?f=null:(c=e+l[1][s]*r,h=n-l[1][s+1]*r,f&&d.push(f.x,f.y,c,h),f={x:c,y:h});e+=l[0]*r}return d}},{}],14:[function(t,e,n){"use strict";var i=e.exports={};i.Map=t("./ui/map"),i.Control=t("./ui/control/control"),i.Navigation=t("./ui/control/navigation"),i.Attribution=t("./ui/control/attribution"),i.Popup=t("./ui/popup"),i.GeoJSONSource=t("./source/geojson_source"),i.VideoSource=t("./source/video_source"),i.ImageSource=t("./source/image_source"),i.Style=t("./style/style"),i.LngLat=t("./geo/lng_lat"),i.LngLatBounds=t("./geo/lng_lat_bounds"),i.Point=t("point-geometry"),i.Evented=t("./util/evented"),i.util=t("./util/util"),i.supported=t("./util/browser").supported;var r=t("./util/ajax");i.util.getJSON=r.getJSON,i.util.getArrayBuffer=r.getArrayBuffer;var o=t("./util/config");i.config=o,Object.defineProperty(i,"accessToken",{get:function(){return o.ACCESS_TOKEN},set:function(t){o.ACCESS_TOKEN=t}})},{"./geo/lng_lat":10,"./geo/lng_lat_bounds":11,"./source/geojson_source":28,"./source/image_source":30,"./source/video_source":37,"./style/style":43,"./ui/control/attribution":71,"./ui/control/control":72,"./ui/control/navigation":73,"./ui/map":83,"./ui/popup":84,"./util/ajax":86,"./util/browser":87,"./util/config":91,"./util/evented":92,"./util/util":98,"point-geometry":148}],15:[function(t,e,n){"use strict";function i(t,e,n){var i,r=t.gl,u=t.transform,l=a.premultiply(n.paint["background-color"],n.paint["background-opacity"]),c=n.paint["background-pattern"],h=n.paint["background-opacity"],f=c?t.spriteAtlas.getPosition(c.from,!0):null,d=c?t.spriteAtlas.getPosition(c.to,!0):null;if(t.setDepthSublayer(0),f&&d){if(t.isOpaquePass)return;i=t.patternShader,r.switchShader(i),r.uniform1i(i.u_image,0),r.uniform2fv(i.u_pattern_tl_a,f.tl),r.uniform2fv(i.u_pattern_br_a,f.br),r.uniform2fv(i.u_pattern_tl_b,d.tl),r.uniform2fv(i.u_pattern_br_b,d.br),r.uniform1f(i.u_opacity,h),r.uniform1f(i.u_mix,c.t);var p=s/u.tileSize/Math.pow(2,0);r.uniform2fv(i.u_patternscale_a,[1/(f.size[0]*p*c.fromScale),1/(f.size[1]*p*c.fromScale)]),r.uniform2fv(i.u_patternscale_b,[1/(d.size[0]*p*c.toScale),1/(d.size[1]*p*c.toScale)]),t.spriteAtlas.bind(r,!0)}else{if(t.isOpaquePass!==(1===l[3]))return;i=t.fillShader,r.switchShader(i),r.uniform4fv(i.u_color,l)}r.disable(r.STENCIL_TEST),r.bindBuffer(r.ARRAY_BUFFER,t.tileExtentBuffer),r.vertexAttribPointer(i.a_pos,t.tileExtentBuffer.itemSize,r.SHORT,!1,0,0);for(var m=o.coveringTiles(u),v=0;v<m.length;v++)r.setPosMatrix(t.calculatePosMatrix(m[v])),r.drawArrays(r.TRIANGLE_STRIP,0,t.tileExtentBuffer.itemCount);r.stencilMask(0),r.stencilFunc(r.EQUAL,128,128)}var r=t("../source/tile_pyramid"),o=new r({tileSize:512}),a=t("../util/util"),s=t("../data/bucket").EXTENT;e.exports=i},{"../data/bucket":1,"../source/tile_pyramid":35,"../util/util":98}],16:[function(t,e,n){"use strict";function i(t,e,n,i){if(!t.isOpaquePass){var a=t.gl,s=t.circleShader;t.gl.switchShader(s),t.setDepthSublayer(0),t.depthMask(!1),a.disable(a.STENCIL_TEST);var u=1/r.devicePixelRatio/n.paint["circle-radius"],l=o.premultiply(n.paint["circle-color"],n.paint["circle-opacity"]);a.uniform4fv(s.u_color,l),a.uniform1f(s.u_blur,Math.max(n.paint["circle-blur"],u)),a.uniform1f(s.u_size,n.paint["circle-radius"]);for(var c=0;c<i.length;c++){var h=i[c],f=e.getTile(h),d=f.getBucket(n);if(d){var p=d.elementGroups.circle;if(p){var m=d.buffers.circleVertex,v=d.buffers.circleElement;a.setPosMatrix(t.translatePosMatrix(t.calculatePosMatrix(h,e.maxzoom),f,n.paint["circle-translate"],n.paint["circle-translate-anchor"])),a.setExMatrix(t.transform.exMatrix);for(var y=0;y<p.length;y++){var g=p[y],_=g.vertexStartIndex*m.itemSize;m.bind(a),m.setAttribPointers(a,s,_),v.bind(a);var x=3*g.elementLength,b=g.elementStartIndex*v.itemSize;a.drawElements(a.TRIANGLES,x,a.UNSIGNED_SHORT,b)}}}}}}var r=t("../util/browser"),o=t("../util/util");e.exports=i},{"../util/browser":87,"../util/util":98}],17:[function(t,e,n){"use strict";function i(t,e,n,i){var r=t.gl,o=t.collisionBoxShader;r.enable(r.STENCIL_TEST),r.switchShader(o);for(var a=0;a<i.length;a++){var s=i[a],u=e.getTile(s),l=u.getBucket(n);if(l){var c=l.elementGroups.collisionBox;if(c&&l.buffers&&0!==c[0].vertexLength){var h=l.buffers.collisionBoxVertex;h.bind(r),h.setAttribPointers(r,o,0);var f=t.calculatePosMatrix(s,e.maxzoom);r.setPosMatrix(f),t.enableTileClippingMask(s),r.lineWidth(1),r.uniform1f(o.u_scale,Math.pow(2,t.transform.zoom-u.coord.z)),
r.uniform1f(o.u_zoom,10*t.transform.zoom),r.uniform1f(o.u_maxzoom,10*(u.coord.z+1)),r.drawArrays(r.LINES,c[0].vertexStartIndex,c[0].vertexLength)}}}}e.exports=i},{}],18:[function(t,e,n){"use strict";function i(t,e,n){if(!t.isOpaquePass&&t.options.debug)for(var i=0;i<n.length;i++)r(t,e,n[i])}function r(t,e,n){var i=t.gl;i.disable(i.STENCIL_TEST),i.lineWidth(1*a.devicePixelRatio);var r=t.calculatePosMatrix(n,e.maxzoom),l=t.debugShader;i.switchShader(l,r),i.bindBuffer(i.ARRAY_BUFFER,t.debugBuffer),i.vertexAttribPointer(l.a_pos,t.debugBuffer.itemSize,i.SHORT,!1,0,0),i.uniform4f(l.u_color,1,0,0,1),i.drawArrays(i.LINE_STRIP,0,t.debugBuffer.itemCount);var c=o(n.toString(),50,200,5);i.bindBuffer(i.ARRAY_BUFFER,t.debugTextBuffer),i.bufferData(i.ARRAY_BUFFER,new Int16Array(c),i.STREAM_DRAW),i.vertexAttribPointer(l.a_pos,t.debugTextBuffer.itemSize,i.SHORT,!1,0,0),i.uniform4f(l.u_color,1,1,1,1);for(var h=e.getTile(n).tileSize,f=u/(Math.pow(2,t.transform.zoom-n.z)*h),d=[[-1,-1],[-1,1],[1,-1],[1,1]],p=0;p<d.length;p++){var m=d[p];i.setPosMatrix(s.translate([],r,[f*m[0],f*m[1],0])),i.drawArrays(i.LINES,0,c.length/t.debugTextBuffer.itemSize)}i.uniform4f(l.u_color,0,0,0,1),i.setPosMatrix(r),i.drawArrays(i.LINES,0,c.length/t.debugTextBuffer.itemSize)}var o=t("../lib/debugtext"),a=t("../util/browser"),s=t("gl-matrix").mat4,u=t("../data/bucket").EXTENT;e.exports=i},{"../data/bucket":1,"../lib/debugtext":13,"../util/browser":87,"gl-matrix":108}],19:[function(t,e,n){"use strict";function i(t,e,n,i){var u=t.gl;u.enable(u.STENCIL_TEST);var l=s.premultiply(n.paint["fill-color"],n.paint["fill-opacity"]),c=n.paint["fill-pattern"],h=s.premultiply(n.paint["fill-outline-color"],n.paint["fill-opacity"]);if(c?!t.isOpaquePass:t.isOpaquePass===(1===l[3]))for(var f=0;f<i.length;f++)r(t,e,n,i[f]);if(!t.isOpaquePass&&n.paint["fill-antialias"]&&(!n.paint["fill-pattern"]||h)){u.switchShader(t.outlineShader),u.lineWidth(2*a.devicePixelRatio*10),h?t.setDepthSublayer(2):t.setDepthSublayer(0),u.uniform2f(t.outlineShader.u_world,u.drawingBufferWidth,u.drawingBufferHeight),u.uniform4fv(t.outlineShader.u_color,h?h:l);for(var d=0;d<i.length;d++)o(t,e,n,i[d])}}function r(t,e,n,i){var r=e.getTile(i),o=r.getBucket(n);if(o){var a=o.elementGroups.fill;if(a){var u=t.gl,l=s.premultiply(n.paint["fill-color"],n.paint["fill-opacity"]),c=n.paint["fill-pattern"],h=n.paint["fill-opacity"],f=t.calculatePosMatrix(i,e.maxzoom),d=t.translatePosMatrix(f,r,n.paint["fill-translate"],n.paint["fill-translate-anchor"]);t.setDepthSublayer(1),u.stencilMask(7),u.clear(u.STENCIL_BUFFER_BIT),t.enableTileClippingMask(i),u.stencilOpSeparate(u.FRONT,u.KEEP,u.KEEP,u.INCR_WRAP),u.stencilOpSeparate(u.BACK,u.KEEP,u.KEEP,u.DECR_WRAP),u.colorMask(!1,!1,!1,!1),t.depthMask(!1),u.switchShader(t.fillShader,d);var p=o.buffers.fillVertex;p.bind(u);var m=o.buffers.fillElement;m.bind(u);for(var v=0;v<a.length;v++){var y=a[v],g=y.vertexStartIndex*p.itemSize;p.setAttribPointers(u,t.fillShader,g);var _=3*y.elementLength,x=y.elementStartIndex*m.itemSize;u.drawElements(u.TRIANGLES,_,u.UNSIGNED_SHORT,x)}u.colorMask(!0,!0,!0,!0),t.depthMask(!0),u.stencilOp(u.KEEP,u.KEEP,u.KEEP),u.stencilMask(0);var b;if(c){var w=t.spriteAtlas.getPosition(c.from,!0),S=t.spriteAtlas.getPosition(c.to,!0);if(!w||!S)return;b=t.patternShader,u.switchShader(b,f),u.uniform1i(b.u_image,0),u.uniform2fv(b.u_pattern_tl_a,w.tl),u.uniform2fv(b.u_pattern_br_a,w.br),u.uniform2fv(b.u_pattern_tl_b,S.tl),u.uniform2fv(b.u_pattern_br_b,S.br),u.uniform1f(b.u_opacity,h),u.uniform1f(b.u_mix,c.t);var M=[w.size[0]*c.fromScale,w.size[1]*c.fromScale],E=[S.size[0]*c.toScale,S.size[1]*c.toScale];u.uniform2fv(b.u_patternscale_a,[1/r.pixelsToTileUnits(M[0],t.transform.tileZoom),1/r.pixelsToTileUnits(M[1],t.transform.tileZoom)]),u.uniform2fv(b.u_patternscale_b,[1/r.pixelsToTileUnits(E[0],t.transform.tileZoom),1/r.pixelsToTileUnits(E[1],t.transform.tileZoom)]);var T=r.tileSize*Math.pow(2,t.transform.tileZoom-r.coord.z),D=T/M[0]%1*(r.coord.x+i.w*Math.pow(2,r.coord.z)),I=T/M[1]%1*r.coord.y,z=T/E[0]%1*(r.coord.x+i.w*Math.pow(2,r.coord.z)),A=T/E[1]%1*r.coord.y;u.uniform2fv(b.u_offset_a,[D,I]),u.uniform2fv(b.u_offset_b,[z,A]),t.spriteAtlas.bind(u,!0)}else b=t.fillShader,u.switchShader(b,f),u.uniform4fv(b.u_color,l);u.stencilFunc(u.NOTEQUAL,0,7),u.bindBuffer(u.ARRAY_BUFFER,t.tileExtentBuffer),u.vertexAttribPointer(b.a_pos,t.tileExtentBuffer.itemSize,u.SHORT,!1,0,0),u.drawArrays(u.TRIANGLE_STRIP,0,t.tileExtentBuffer.itemCount),u.stencilMask(0)}}}function o(t,e,n,i){var r=e.getTile(i),o=r.getBucket(n);if(o){var a=t.gl,s=o.elementGroups.fill;a.setPosMatrix(t.translatePosMatrix(t.calculatePosMatrix(i,e.maxzoom),r,n.paint["fill-translate"],n.paint["fill-translate-anchor"]));var u=o.buffers.fillVertex,l=o.buffers.fillSecondElement;u.bind(a),l.bind(a),t.enableTileClippingMask(i);for(var c=0;c<s.length;c++){var h=s[c],f=h.vertexStartIndex*u.itemSize;u.setAttribPointers(a,t.outlineShader,f);var d=2*h.secondElementLength,p=h.secondElementStartIndex*l.itemSize;a.drawElements(a.LINES,d,a.UNSIGNED_SHORT,p)}}}var a=t("../util/browser"),s=t("../util/util");e.exports=i},{"../util/browser":87,"../util/util":98}],20:[function(t,e,n){"use strict";var i=t("../util/browser"),r=t("gl-matrix").mat2,o=t("../util/util");e.exports=function(t,e,n,a){if(!t.isOpaquePass){t.setDepthSublayer(0),t.depthMask(!1);var s=a.some(function(t){var i=e.getTile(t).getBucket(n);return i&&i.elementGroups.line});if(s){var u=t.gl;if(u.enable(u.STENCIL_TEST),!(n.paint["line-width"]<=0)){var l=1/i.devicePixelRatio,c=n.paint["line-blur"]+l,h=n.paint["line-width"]/2,f=-1,d=0,p=0;n.paint["line-gap-width"]>0&&(f=n.paint["line-gap-width"]/2+.5*l,h=n.paint["line-width"],d=f-l/2);var m=d+h+l/2+p,v=o.premultiply(n.paint["line-color"],n.paint["line-opacity"]),y=t.transform,g=r.create();r.scale(g,g,[1,Math.cos(y._pitch)]),r.rotate(g,g,t.transform.angle);var _,x,b,w,S,M=Math.sqrt(y.height*y.height/4*(1+y.altitude*y.altitude)),E=y.height/2*Math.tan(y._pitch),T=(M+E)/M-1,D=n.paint["line-dasharray"],I=n.paint["line-pattern"];if(D)_=t.linesdfpatternShader,u.switchShader(_),u.uniform2fv(_.u_linewidth,[m,f]),u.uniform1f(_.u_blur,c),u.uniform4fv(_.u_color,v),x=t.lineAtlas.getDash(D.from,"round"===n.layout["line-cap"]),b=t.lineAtlas.getDash(D.to,"round"===n.layout["line-cap"]),t.lineAtlas.bind(u),u.uniform1f(_.u_tex_y_a,x.y),u.uniform1f(_.u_tex_y_b,b.y),u.uniform1i(_.u_image,0),u.uniform1f(_.u_mix,D.t),u.uniform1f(_.u_extra,T),u.uniform1f(_.u_offset,-n.paint["line-offset"]),u.uniformMatrix2fv(_.u_antialiasingmatrix,!1,g);else if(I){if(w=t.spriteAtlas.getPosition(I.from,!0),S=t.spriteAtlas.getPosition(I.to,!0),!w||!S)return;t.spriteAtlas.bind(u,!0),_=t.linepatternShader,u.switchShader(_),u.uniform2fv(_.u_linewidth,[m,f]),u.uniform1f(_.u_blur,c),u.uniform2fv(_.u_pattern_tl_a,w.tl),u.uniform2fv(_.u_pattern_br_a,w.br),u.uniform2fv(_.u_pattern_tl_b,S.tl),u.uniform2fv(_.u_pattern_br_b,S.br),u.uniform1f(_.u_fade,I.t),u.uniform1f(_.u_opacity,n.paint["line-opacity"]),u.uniform1f(_.u_extra,T),u.uniform1f(_.u_offset,-n.paint["line-offset"]),u.uniformMatrix2fv(_.u_antialiasingmatrix,!1,g)}else _=t.lineShader,u.switchShader(_),u.uniform2fv(_.u_linewidth,[m,f]),u.uniform1f(_.u_blur,c),u.uniform1f(_.u_extra,T),u.uniform1f(_.u_offset,-n.paint["line-offset"]),u.uniformMatrix2fv(_.u_antialiasingmatrix,!1,g),u.uniform4fv(_.u_color,v);for(var z=0;z<a.length;z++){var A=a[z],k=e.getTile(A),L=k.getBucket(n);if(L){var C=L.elementGroups.line;if(C){t.enableTileClippingMask(A);var P=t.translatePosMatrix(t.calculatePosMatrix(A,e.maxzoom),k,n.paint["line-translate"],n.paint["line-translate-anchor"]);u.setPosMatrix(P),u.setExMatrix(t.transform.exMatrix);var F=1/k.pixelsToTileUnits(1,t.transform.zoom);if(D){var j=x.width*D.fromScale,O=b.width*D.toScale,R=[1/k.pixelsToTileUnits(j,t.transform.tileZoom),-x.height/2],N=[1/k.pixelsToTileUnits(O,t.transform.tileZoom),-b.height/2],B=t.lineAtlas.width/(256*Math.min(j,O)*i.devicePixelRatio)/2;u.uniform1f(_.u_ratio,F),u.uniform2fv(_.u_patternscale_a,R),u.uniform2fv(_.u_patternscale_b,N),u.uniform1f(_.u_sdfgamma,B)}else I?(u.uniform1f(_.u_ratio,F),u.uniform2fv(_.u_pattern_size_a,[k.pixelsToTileUnits(w.size[0]*I.fromScale,t.transform.tileZoom),S.size[1]]),u.uniform2fv(_.u_pattern_size_b,[k.pixelsToTileUnits(S.size[0]*I.toScale,t.transform.tileZoom),S.size[1]])):u.uniform1f(_.u_ratio,F);var q=L.buffers.lineVertex;q.bind(u);var U=L.buffers.lineElement;U.bind(u);for(var V=0;V<C.length;V++){var H=C[V],G=H.vertexStartIndex*q.itemSize;u.vertexAttribPointer(_.a_pos,2,u.SHORT,!1,8,G+0),u.vertexAttribPointer(_.a_data,4,u.UNSIGNED_BYTE,!1,8,G+4);var Y=3*H.elementLength,X=H.elementStartIndex*U.itemSize;u.drawElements(u.TRIANGLES,Y,u.UNSIGNED_SHORT,X)}}}}}}}}},{"../util/browser":87,"../util/util":98,"gl-matrix":108}],21:[function(t,e,n){"use strict";function i(t,e,n,i){if(!t.isOpaquePass){var o=t.gl;o.enable(o.DEPTH_TEST),t.depthMask(!0),o.depthFunc(o.LESS);for(var a=i.length&&i[0].z,s=0;s<i.length;s++){var u=i[s];t.setDepthSublayer(u.z-a),r(t,e,n,u)}o.depthFunc(o.LEQUAL)}}function r(t,e,n,i){var r=t.gl;r.disable(r.STENCIL_TEST);var l=e.getTile(i),c=t.calculatePosMatrix(i,e.maxzoom),h=t.rasterShader;r.switchShader(h,c),r.uniform1f(h.u_brightness_low,n.paint["raster-brightness-min"]),r.uniform1f(h.u_brightness_high,n.paint["raster-brightness-max"]),r.uniform1f(h.u_saturation_factor,s(n.paint["raster-saturation"])),r.uniform1f(h.u_contrast_factor,a(n.paint["raster-contrast"])),r.uniform3fv(h.u_spin_weights,o(n.paint["raster-hue-rotate"]));var f,d,p=l.source&&l.source._pyramid.findLoadedParent(i,0,{}),m=u(l,p,n,t.transform);r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l.texture),p?(r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,p.texture),f=Math.pow(2,p.coord.z-l.coord.z),d=[l.coord.x*f%1,l.coord.y*f%1]):m[1]=0,r.uniform2fv(h.u_tl_parent,d||[0,0]),r.uniform1f(h.u_scale_parent,f||1),r.uniform1f(h.u_buffer_scale,1),r.uniform1f(h.u_opacity0,m[0]),r.uniform1f(h.u_opacity1,m[1]),r.uniform1i(h.u_image0,0),r.uniform1i(h.u_image1,1),r.bindBuffer(r.ARRAY_BUFFER,l.boundsBuffer||t.tileExtentBuffer),r.vertexAttribPointer(h.a_pos,2,r.SHORT,!1,8,0),r.vertexAttribPointer(h.a_texture_pos,2,r.SHORT,!1,8,4),r.drawArrays(r.TRIANGLE_STRIP,0,4)}function o(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}function a(t){return t>0?1/(1-t):1+t}function s(t){return t>0?1-1/(1.001-t):-t}function u(t,e,n,i){var r=[1,0],o=n.paint["raster-fade-duration"];if(t.source&&o>0){var a=(new Date).getTime(),s=(a-t.timeAdded)/o,u=e?(a-e.timeAdded)/o:-1,c=t.source._pyramid.coveringZoomLevel(i),h=e?Math.abs(e.coord.z-c)>Math.abs(t.coord.z-c):!1;!e||h?(r[0]=l.clamp(s,0,1),r[1]=1-r[0]):(r[0]=l.clamp(1-u,0,1),r[1]=1-r[0])}var f=n.paint["raster-opacity"];return r[0]*=f,r[1]*=f,r}var l=t("../util/util");e.exports=i},{"../util/util":98}],22:[function(t,e,n){"use strict";function i(t,e,n,i){if(!t.isOpaquePass){var o=!(n.layout["text-allow-overlap"]||n.layout["icon-allow-overlap"]||n.layout["text-ignore-placement"]||n.layout["icon-ignore-placement"]),a=t.gl;o?a.disable(a.STENCIL_TEST):a.enable(a.STENCIL_TEST),t.setDepthSublayer(0),t.depthMask(!1),a.disable(a.DEPTH_TEST);for(var u,l,c,h,f=0;f<i.length;f++)u=e.getTile(i[f]),c=u.getBucket(n),c&&(l=c.elementGroups,l.icon.length&&(h=t.calculatePosMatrix(i[f],e.maxzoom),t.enableTileClippingMask(i[f]),r(t,n,h,u,c,l.icon,"icon",l.sdfIcons,l.iconsNeedLinear)));for(var d=0;d<i.length;d++)u=e.getTile(i[d]),c=u.getBucket(n),c&&(l=c.elementGroups,l.glyph.length&&(h=t.calculatePosMatrix(i[d],e.maxzoom),t.enableTileClippingMask(i[d]),r(t,n,h,u,c,l.glyph,"text",!0,!1)));a.enable(a.DEPTH_TEST),s(t,e,n,i)}}function r(t,e,n,i,r,s,c,h,f){var d=t.gl;n=t.translatePosMatrix(n,i,e.paint[c+"-translate"],e.paint[c+"-translate-anchor"]);var p,m,v,y=t.transform,g="map"===e.layout[c+"-rotation-alignment"],_=g;_?(p=o.create(),m=i.pixelsToTileUnits(1,t.transform.zoom),v=1/Math.cos(y._pitch)):(p=o.clone(t.transform.exMatrix),m=t.transform.altitude,v=1),o.scale(p,p,[m,m,1]);var x=e.layout[c+"-size"],b=x/l[c];o.scale(p,p,[b,b,1]);var w,S,M,E,T=Math.sqrt(y.height*y.height/4*(1+y.altitude*y.altitude)),D=y.height/2*Math.tan(y._pitch),I=(T+D)/T-1,z="text"===c;if(z||t.style.sprite.loaded()){if(d.activeTexture(d.TEXTURE0),w=h?t.sdfShader:t.iconShader,z){var A=s.fontstack,k=A&&t.glyphSource.getGlyphAtlas(A);if(!k)return;k.updateTexture(d),S=r.buffers.glyphVertex,M=r.buffers.glyphElement,E=[k.width/4,k.height/4]}else{var L=t.options.rotating||t.options.zooming,C=1!==b||a.devicePixelRatio!==t.spriteAtlas.pixelRatio||f,P=g||t.transform.pitch;t.spriteAtlas.bind(d,h||L||C||P),S=r.buffers.iconVertex,M=r.buffers.iconElement,E=[t.spriteAtlas.width/4,t.spriteAtlas.height/4]}d.switchShader(w,n,p),d.uniform1i(w.u_texture,0),d.uniform2fv(w.u_texsize,E),d.uniform1i(w.u_skewed,_),d.uniform1f(w.u_extra,I);var F=Math.log(x/s.adjustedSize)/Math.LN2||0;d.uniform1f(w.u_zoom,10*(t.transform.zoom-F));var j=t.frameHistory.getFadeProperties(300);d.uniform1f(w.u_fadedist,10*j.fadedist),d.uniform1f(w.u_minfadezoom,Math.floor(10*j.minfadezoom)),d.uniform1f(w.u_maxfadezoom,Math.floor(10*j.maxfadezoom)),d.uniform1f(w.u_fadezoom,10*(t.transform.zoom+j.bump));var O,R,N,B;if(M.bind(d),h){var q=8,U=1.19,V=6,H=.105*l[c]/x/a.devicePixelRatio;if(e.paint[c+"-halo-width"]){var G=u.premultiply(e.paint[c+"-halo-color"],e.paint[c+"-opacity"]);d.uniform1f(w.u_gamma,(e.paint[c+"-halo-blur"]*U/b/q+H)*v),d.uniform4fv(w.u_color,G),d.uniform1f(w.u_buffer,(V-e.paint[c+"-halo-width"]/b)/q);for(var Y=0;Y<s.length;Y++)O=s[Y],R=O.vertexStartIndex*S.itemSize,S.bind(d),S.setAttribPointers(d,w,R),N=3*O.elementLength,B=O.elementStartIndex*M.itemSize,d.drawElements(d.TRIANGLES,N,d.UNSIGNED_SHORT,B)}var X=u.premultiply(e.paint[c+"-color"],e.paint[c+"-opacity"]);d.uniform1f(w.u_gamma,H*v),d.uniform4fv(w.u_color,X),d.uniform1f(w.u_buffer,.75);for(var $=0;$<s.length;$++)O=s[$],R=O.vertexStartIndex*S.itemSize,S.bind(d),S.setAttribPointers(d,w,R),N=3*O.elementLength,B=O.elementStartIndex*M.itemSize,d.drawElements(d.TRIANGLES,N,d.UNSIGNED_SHORT,B)}else{d.uniform1f(w.u_opacity,e.paint["icon-opacity"]);for(var W=0;W<s.length;W++)O=s[W],R=O.vertexStartIndex*S.itemSize,S.bind(d),S.setAttribPointers(d,w,R),N=3*O.elementLength,B=O.elementStartIndex*M.itemSize,d.drawElements(d.TRIANGLES,N,d.UNSIGNED_SHORT,B)}}}var o=t("gl-matrix").mat4,a=t("../util/browser"),s=t("./draw_collision_debug"),u=t("../util/util");e.exports=i;var l={icon:1,text:24}},{"../util/browser":87,"../util/util":98,"./draw_collision_debug":17,"gl-matrix":108}],23:[function(t,e,n){"use strict";function i(){this.frameHistory=[]}e.exports=i,i.prototype.getFadeProperties=function(t){void 0===t&&(t=300);for(var e=(new Date).getTime();this.frameHistory.length>3&&this.frameHistory[1].time+t<e;)this.frameHistory.shift();this.frameHistory[1].time+t<e&&(this.frameHistory[0].z=this.frameHistory[1].z);var n=this.frameHistory.length;3>n&&console.warn("there should never be less than three frames in the history");var i=this.frameHistory[0].z,r=this.frameHistory[n-1],o=r.z,a=Math.min(i,o),s=Math.max(i,o),u=r.z-this.frameHistory[1].z,l=r.time-this.frameHistory[1].time,c=u/(l/t);isNaN(c)&&console.warn("fadedist should never be NaN");var h=(e-r.time)/t*c;return{fadedist:c,minfadezoom:a,maxfadezoom:s,bump:h}},i.prototype.record=function(t){var e=(new Date).getTime();this.frameHistory.length||this.frameHistory.push({time:0,z:t},{time:0,z:t}),2!==this.frameHistory.length&&this.frameHistory[this.frameHistory.length-1].z===t||this.frameHistory.push({time:e,z:t})}},{}],24:[function(t,e,n){"use strict";var i=t("./shaders"),r=t("../util/util");n.extend=function(t){var e=t.lineWidth,n=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE);return t.lineWidth=function(i){e.call(t,r.clamp(i,n[0],n[1]))},t.getShader=function(t,e){var n=e===this.FRAGMENT_SHADER?"fragment":"vertex";if(!i[t]||!i[t][n])throw new Error("Could not find shader "+t);var r=this.createShader(e),o=i[t][n];if(this.shaderSource(r,o),this.compileShader(r),!this.getShaderParameter(r,this.COMPILE_STATUS))throw new Error(t+" "+n+this.getShaderInfoLog(r));return r},t.initializeShader=function(t,e,n){var i={program:this.createProgram(),fragment:this.getShader(t,this.FRAGMENT_SHADER),vertex:this.getShader(t,this.VERTEX_SHADER),attributes:[]};if(this.attachShader(i.program,i.vertex),this.attachShader(i.program,i.fragment),this.linkProgram(i.program),this.getProgramParameter(i.program,this.LINK_STATUS)){for(var r=0;r<e.length;r++)i[e[r]]=this.getAttribLocation(i.program,e[r]),i.attributes.push(i[e[r]]);for(var o=0;o<n.length;o++)i[n[o]]=this.getUniformLocation(i.program,n[o])}else console.error(t+" ERROR: "+this.getProgramInfoLog(i.program));return i},t.switchShader=function(e,n,i){if(this.currentShader!==e){this.useProgram(e.program);for(var r=this.currentShader?this.currentShader.attributes:[],o=e.attributes,a=0;a<r.length;a++)o.indexOf(r[a])<0&&this.disableVertexAttribArray(r[a]);for(var s=0;s<o.length;s++)r.indexOf(o[s])<0&&this.enableVertexAttribArray(o[s]);this.currentShader=e}void 0!==n&&t.setPosMatrix(n),void 0!==i&&t.setExMatrix(i)},t.setPosMatrix=function(t){var e=this.currentShader;e.posMatrix!==t&&(this.uniformMatrix4fv(e.u_matrix,!1,t),e.posMatrix=t)},t.setExMatrix=function(t){var e=this.currentShader;t&&e.exMatrix!==t&&e.u_exmatrix&&(this.uniformMatrix4fv(e.u_exmatrix,!1,t),e.exMatrix=t)},t.vertexAttrib2fv=function(e,n){t.vertexAttrib2f(e,n[0],n[1])},t.vertexAttrib3fv=function(e,n){t.vertexAttrib3f(e,n[0],n[1],n[2])},t.vertexAttrib4fv=function(e,n){t.vertexAttrib4f(e,n[0],n[1],n[2],n[3])},t}},{"../util/util":98,"./shaders":27}],25:[function(t,e,n){"use strict";function i(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}}e.exports=i,i.prototype.setSprite=function(t){this.sprite=t},i.prototype.getDash=function(t,e){var n=t.join(",")+e;return this.positions[n]||(this.positions[n]=this.addDash(t,e)),this.positions[n]},i.prototype.addDash=function(t,e){var n=e?7:0,i=2*n+1,r=128;if(this.nextRow+i>this.height)return console.warn("LineAtlas out of space"),null;for(var o=0,a=0;a<t.length;a++)o+=t[a];for(var s=this.width/o,u=s/2,l=t.length%2===1,c=-n;n>=c;c++)for(var h=this.nextRow+n+c,f=this.width*h,d=l?-t[t.length-1]:0,p=t[0],m=1,v=0;v<this.width;v++){for(;v/s>p;)d=p,p+=t[m],l&&m===t.length-1&&(p+=t[0]),m++;var y,g=Math.abs(v-d*s),_=Math.abs(v-p*s),x=Math.min(g,_),b=m%2===1;if(e){var w=n?c/n*(u+1):0;if(b){var S=u-Math.abs(w);y=Math.sqrt(x*x+S*S)}else y=u-Math.sqrt(x*x+w*w)}else y=(b?1:-1)*x;this.data[3+4*(f+v)]=Math.max(0,Math.min(255,y+r))}var M={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:o};return this.nextRow+=i,this.dirty=!0,M},i.prototype.bind=function(t){this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,this.data))}},{}],26:[function(t,e,n){"use strict";function i(t,e){this.gl=r.extend(t),this.transform=e,this.reusableTextures={},this.preFbos={},this.frameHistory=new s,this.setup(),this.numSublayers=l.maxUnderzooming+l.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16)}var r=t("./gl_util"),o=t("../util/browser"),a=t("gl-matrix").mat4,s=t("./frame_history"),u=t("../source/tile_coord"),l=t("../source/tile_pyramid"),c=t("../data/bucket").EXTENT;e.exports=i,i.prototype.resize=function(t,e){var n=this.gl;this.width=t*o.devicePixelRatio,this.height=e*o.devicePixelRatio,n.viewport(0,0,this.width,this.height)},i.prototype.setup=function(){var t=this.gl;t.verbose=!0,t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.enable(t.STENCIL_TEST),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),this._depthMask=!1,t.depthMask(!1),this.debugShader=t.initializeShader("debug",["a_pos"],["u_matrix","u_color"]),this.rasterShader=t.initializeShader("raster",["a_pos","a_texture_pos"],["u_matrix","u_brightness_low","u_brightness_high","u_saturation_factor","u_spin_weights","u_contrast_factor","u_opacity0","u_opacity1","u_image0","u_image1","u_tl_parent","u_scale_parent","u_buffer_scale"]),this.circleShader=t.initializeShader("circle",["a_pos"],["u_matrix","u_exmatrix","u_blur","u_size","u_color"]),this.lineShader=t.initializeShader("line",["a_pos","a_data"],["u_matrix","u_linewidth","u_color","u_ratio","u_blur","u_extra","u_antialiasingmatrix","u_offset","u_exmatrix"]),this.linepatternShader=t.initializeShader("linepattern",["a_pos","a_data"],["u_matrix","u_linewidth","u_ratio","u_pattern_size_a","u_pattern_size_b","u_pattern_tl_a","u_pattern_br_a","u_pattern_tl_b","u_pattern_br_b","u_blur","u_fade","u_opacity","u_extra","u_antialiasingmatrix","u_offset"]),this.linesdfpatternShader=t.initializeShader("linesdfpattern",["a_pos","a_data"],["u_matrix","u_linewidth","u_color","u_ratio","u_blur","u_patternscale_a","u_tex_y_a","u_patternscale_b","u_tex_y_b","u_image","u_sdfgamma","u_mix","u_extra","u_antialiasingmatrix","u_offset"]),this.sdfShader=t.initializeShader("sdf",["a_pos","a_offset","a_data1","a_data2"],["u_matrix","u_exmatrix","u_texture","u_texsize","u_color","u_gamma","u_buffer","u_zoom","u_fadedist","u_minfadezoom","u_maxfadezoom","u_fadezoom","u_skewed","u_extra"]),this.iconShader=t.initializeShader("icon",["a_pos","a_offset","a_data1","a_data2"],["u_matrix","u_exmatrix","u_texture","u_texsize","u_zoom","u_fadedist","u_minfadezoom","u_maxfadezoom","u_fadezoom","u_opacity","u_skewed","u_extra"]),this.outlineShader=t.initializeShader("outline",["a_pos"],["u_matrix","u_color","u_world"]),this.patternShader=t.initializeShader("pattern",["a_pos"],["u_matrix","u_pattern_tl_a","u_pattern_br_a","u_pattern_tl_b","u_pattern_br_b","u_mix","u_patternscale_a","u_patternscale_b","u_opacity","u_image","u_offset_a","u_offset_b"]),this.fillShader=t.initializeShader("fill",["a_pos"],["u_matrix","u_color"]),this.collisionBoxShader=t.initializeShader("collisionbox",["a_pos","a_extrude","a_data"],["u_matrix","u_scale","u_zoom","u_maxzoom"]),this.identityMatrix=a.create(),this.backgroundBuffer=t.createBuffer(),this.backgroundBuffer.itemSize=2,this.backgroundBuffer.itemCount=4,t.bindBuffer(t.ARRAY_BUFFER,this.backgroundBuffer),t.bufferData(t.ARRAY_BUFFER,new Int16Array([-1,-1,1,-1,-1,1,1,1]),t.STATIC_DRAW),this.tileExtentBuffer=t.createBuffer(),this.tileExtentBuffer.itemSize=4,this.tileExtentBuffer.itemCount=4,t.bindBuffer(t.ARRAY_BUFFER,this.tileExtentBuffer),t.bufferData(t.ARRAY_BUFFER,new Int16Array([0,0,0,0,c,0,32767,0,0,c,0,32767,c,c,32767,32767]),t.STATIC_DRAW),this.debugBuffer=t.createBuffer(),this.debugBuffer.itemSize=2,this.debugBuffer.itemCount=5,t.bindBuffer(t.ARRAY_BUFFER,this.debugBuffer),t.bufferData(t.ARRAY_BUFFER,new Int16Array([0,0,c,0,c,c,0,c,0,0]),t.STATIC_DRAW),this.debugTextBuffer=t.createBuffer(),this.debugTextBuffer.itemSize=2},i.prototype.clearColor=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},i.prototype.clearStencil=function(){var t=this.gl;t.clearStencil(0),t.stencilMask(255),t.clear(t.STENCIL_BUFFER_BIT)},i.prototype.clearDepth=function(){var t=this.gl;t.clearDepth(1),this.depthMask(!0),t.clear(t.DEPTH_BUFFER_BIT)},i.prototype._renderTileClippingMasks=function(t,e){var n=this.gl;n.colorMask(!1,!1,!1,!1),this.depthMask(!1),n.disable(n.DEPTH_TEST),n.enable(n.STENCIL_TEST),n.stencilMask(248),n.stencilOp(n.KEEP,n.KEEP,n.REPLACE);var i=1;this._tileClippingMaskIDs={};for(var r=0;r<t.length;r++){var o=t[r],a=this._tileClippingMaskIDs[o.id]=i++<<3;n.stencilFunc(n.ALWAYS,a,248),n.switchShader(this.fillShader,this.calculatePosMatrix(o,e)),n.bindBuffer(n.ARRAY_BUFFER,this.tileExtentBuffer),n.vertexAttribPointer(this.fillShader.a_pos,this.tileExtentBuffer.itemSize,n.SHORT,!1,8,0),n.drawArrays(n.TRIANGLE_STRIP,0,this.tileExtentBuffer.itemCount)}n.stencilMask(0),n.colorMask(!0,!0,!0,!0),this.depthMask(!0),n.enable(n.DEPTH_TEST)},i.prototype.enableTileClippingMask=function(t){var e=this.gl;e.stencilFunc(e.EQUAL,this._tileClippingMaskIDs[t.id],248)},i.prototype.prepareBuffers=function(){},i.prototype.bindDefaultFramebuffer=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)};var h={symbol:t("./draw_symbol"),circle:t("./draw_circle"),line:t("./draw_line"),fill:t("./draw_fill"),raster:t("./draw_raster"),background:t("./draw_background"),debug:t("./draw_debug")};i.prototype.render=function(t,e){this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.spriteAtlas=t.spriteAtlas,this.spriteAtlas.setSprite(t.sprite),this.glyphSource=t.glyphSource,this.frameHistory.record(this.transform.zoom),this.prepareBuffers(),this.clearColor(),this.clearDepth(),this.depthRange=(t._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass({isOpaquePass:!0}),this.renderPass({isOpaquePass:!1})},i.prototype.renderPass=function(t){var e=this.style._groups,n=t.isOpaquePass;this.currentLayer=n?this.style._order.length:-1;for(var i=0;i<e.length;i++){var r=e[n?e.length-1-i:i],o=this.style.sources[r.source],a=[];o&&(a=o.getVisibleCoordinates(),this.clearStencil(),o.prepare&&o.prepare(),o.isTileClipped&&this._renderTileClippingMasks(a,o.maxzoom)),n?(this.gl.disable(this.gl.BLEND),this.isOpaquePass=!0):(this.gl.enable(this.gl.BLEND),this.isOpaquePass=!1,a.reverse());for(var s=0;s<r.length;s++){var u=r[n?r.length-1-s:s];this.currentLayer+=n?-1:1,this.renderLayer(this,o,u,a)}o&&h.debug(this,o,a)}},i.prototype.depthMask=function(t){t!==this._depthMask&&(this._depthMask=t,this.gl.depthMask(t))},i.prototype.renderLayer=function(t,e,n,i){n.isHidden(this.transform.zoom)||("background"===n.type||i.length)&&h[n.type](t,e,n,i)},i.prototype.drawStencilBuffer=function(){var t=this.gl;t.switchShader(this.fillShader,this.identityMatrix),t.stencilMask(0),t.stencilFunc(t.EQUAL,128,128),t.bindBuffer(t.ARRAY_BUFFER,this.backgroundBuffer),t.vertexAttribPointer(this.fillShader.a_pos,this.backgroundBuffer.itemSize,t.SHORT,!1,0,0),t.uniform4fv(this.fillShader.u_color,[0,0,0,.5]),t.drawArrays(t.TRIANGLE_STRIP,0,this.tileExtentBuffer.itemCount)},i.prototype.setDepthSublayer=function(t){var e=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon,n=e-1+this.depthRange;this.gl.depthRange(n,e)},i.prototype.translatePosMatrix=function(t,e,n,i){if(!n[0]&&!n[1])return t;if("viewport"===i){var r=Math.sin(-this.transform.angle),o=Math.cos(-this.transform.angle);n=[n[0]*o-n[1]*r,n[0]*r+n[1]*o]}var s=[e.pixelsToTileUnits(n[0],this.transform.zoom),e.pixelsToTileUnits(n[1],this.transform.zoom),0],u=new Float32Array(16);return a.translate(u,t,s),u},i.prototype.calculatePosMatrix=function(t,e){t instanceof u&&(t=t.toCoordinate());var n=this.transform;void 0===e&&(e=1/0);var i=Math.min(t.zoom,e),r=t.column,o=t.row,s=n.worldSize/Math.pow(2,i),l=new Float64Array(16);return a.identity(l),a.translate(l,l,[r*s,o*s,0]),a.scale(l,l,[s/c,s/c,1]),a.multiply(l,n.projMatrix,l),new Float32Array(l)},i.prototype.saveTexture=function(t){var e=this.reusableTextures[t.size];e?e.push(t):this.reusableTextures[t.size]=[t]},i.prototype.getTexture=function(t){var e=this.reusableTextures[t];return e&&e.length>0?e.pop():null}},{"../data/bucket":1,"../source/tile_coord":34,"../source/tile_pyramid":35,"../util/browser":87,"./draw_background":15,"./draw_circle":16,"./draw_debug":18,"./draw_fill":19,"./draw_line":20,"./draw_raster":21,"./draw_symbol":22,"./frame_history":23,"./gl_util":24,"gl-matrix":108}],27:[function(t,e,n){"use strict";t("path");e.exports={debug:{fragment:"precision mediump float;\n\nuniform lowp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertex:"precision highp float;\n\nattribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, step(32767.0, a_pos.x), 1);\n}\n"},fill:{fragment:"precision mediump float;\n\nuniform lowp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertex:"precision highp float;\n\nattribute vec2 a_pos;\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},circle:{fragment:"precision mediump float;\n\nuniform lowp vec4 u_color;\nuniform lowp float u_blur;\n\nvarying vec2 v_extrude;\n\nvoid main() {\n    float t = smoothstep(1.0 - u_blur, 1.0, length(v_extrude));\n    gl_FragColor = u_color * (1.0 - t);\n}\n",vertex:"precision highp float;\n\nuniform mat4 u_matrix;\nuniform mat4 u_exmatrix;\nuniform mediump float u_size;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\nvoid main(void) {\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    v_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    vec4 extrude = u_exmatrix * vec4(v_extrude * u_size, 0, 0);\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    gl_Position = u_matrix * vec4(floor(a_pos * 0.5), 0, 1);\n\n    // gl_Position is divided by gl_Position.w after this shader runs.\n    // Multiply the extrude by it so that it isn't affected by it.\n    gl_Position += extrude * gl_Position.w;\n}\n"},line:{fragment:"precision mediump float;\n\nuniform vec2 u_linewidth;\nuniform lowp vec4 u_color;\nuniform float u_blur;\n\nvarying vec2 v_normal;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\nvoid main() {\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * u_linewidth.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_linewidth.t) or when fading out\n    // (v_linewidth.s)\n    float blur = u_blur * v_gamma_scale;\n    float alpha = clamp(min(dist - (u_linewidth.t - blur), u_linewidth.s - dist) / blur, 0.0, 1.0);\n\n    gl_FragColor = u_color * alpha;\n}\n",vertex:"precision highp float;\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform float u_ratio;\nuniform mediump vec2 u_linewidth;\nuniform float u_extra;\nuniform mat2 u_antialiasingmatrix;\nuniform mediump float u_offset;\n\nvarying vec2 v_normal;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\nvoid main() {\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec4 dist = vec4(u_linewidth.s * a_extrude * scale, 0.0, 0.0);\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset = u_offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit of the position before scaling it with the\n    // model/view matrix.\n    gl_Position = u_matrix * vec4(floor(a_pos * 0.5) + (offset + dist.xy) / u_ratio, 0.0, 1.0);\n\n    // position of y on the screen\n    float y = gl_Position.y / gl_Position.w;\n\n    // how much features are squished in the y direction by the tilt\n    float squish_scale = length(a_extrude) / length(u_antialiasingmatrix * a_extrude);\n\n    // how much features are squished in all directions by the perspectiveness\n    float perspective_scale = 1.0 / (1.0 - min(y * u_extra, 0.9));\n\n    v_gamma_scale = perspective_scale * squish_scale;\n}\n"
},linepattern:{fragment:"precision mediump float;\n\nuniform vec2 u_linewidth;\nuniform float u_point;\nuniform float u_blur;\n\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform float u_fade;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\nvoid main() {\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * u_linewidth.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_linewidth.t) or when fading out\n    // (v_linewidth.s)\n    float blur = u_blur * v_gamma_scale;\n    float alpha = clamp(min(dist - (u_linewidth.t - blur), u_linewidth.s - dist) / blur, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n    float y_a = 0.5 + (v_normal.y * u_linewidth.s / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * u_linewidth.s / u_pattern_size_b.y);\n    vec2 pos = mix(u_pattern_tl_a, u_pattern_br_a, vec2(x_a, y_a));\n    vec2 pos2 = mix(u_pattern_tl_b, u_pattern_br_b, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos), texture2D(u_image, pos2), u_fade);\n\n    alpha *= u_opacity;\n\n    gl_FragColor = color * alpha;\n}\n",vertex:"precision highp float;\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform mediump vec2 u_linewidth;\nuniform float u_extra;\nuniform mat2 u_antialiasingmatrix;\nuniform mediump float u_offset;\n\nvarying vec2 v_normal;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\nvoid main() {\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 extrude = a_extrude * scale;\n    mediump vec2 dist = u_linewidth.s * extrude;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset = u_offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit of the position before scaling it with the\n    // model/view matrix.\n    gl_Position = u_matrix * vec4(floor(a_pos * 0.5) + (offset + dist.xy) / u_ratio, 0.0, 1.0);\n    v_linesofar = a_linesofar;\n\n    // position of y on the screen\n    float y = gl_Position.y / gl_Position.w;\n\n    // how much features are squished in the y direction by the tilt\n    float squish_scale = length(a_extrude) / length(u_antialiasingmatrix * a_extrude);\n\n    // how much features are squished in all directions by the perspectiveness\n    float perspective_scale = 1.0 / (1.0 - min(y * u_extra, 0.9));\n\n    v_gamma_scale = perspective_scale * squish_scale;\n}\n"},linesdfpattern:{fragment:"precision mediump float;\n\nuniform vec2 u_linewidth;\nuniform lowp vec4 u_color;\nuniform float u_blur;\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\nvoid main() {\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * u_linewidth.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_linewidth.t) or when fading out\n    // (v_linewidth.s)\n    float blur = u_blur * v_gamma_scale;\n    float alpha = clamp(min(dist - (u_linewidth.t - blur), u_linewidth.s - dist) / blur, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma, 0.5 + u_sdfgamma, sdfdist);\n\n    gl_FragColor = u_color * alpha;\n}\n",vertex:"precision highp float;\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump vec2 u_linewidth;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform float u_extra;\nuniform mat2 u_antialiasingmatrix;\nuniform mediump float u_offset;\n\nvarying vec2 v_normal;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\nvoid main() {\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec4 dist = vec4(u_linewidth.s * a_extrude * scale, 0.0, 0.0);\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset = u_offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit of the position before scaling it with the\n    // model/view matrix.\n    gl_Position = u_matrix * vec4(floor(a_pos * 0.5) + (offset + dist.xy) / u_ratio, 0.0, 1.0);\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    // position of y on the screen\n    float y = gl_Position.y / gl_Position.w;\n\n    // how much features are squished in the y direction by the tilt\n    float squish_scale = length(a_extrude) / length(u_antialiasingmatrix * a_extrude);\n\n    // how much features are squished in all directions by the perspectiveness\n    float perspective_scale = 1.0 / (1.0 - min(y * u_extra, 0.9));\n\n    v_gamma_scale = perspective_scale * squish_scale;\n}\n"},outline:{fragment:"precision mediump float;\n\nuniform lowp vec4 u_color;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = smoothstep(1.0, 0.0, dist);\n    gl_FragColor = u_color * alpha;\n}\n",vertex:"precision highp float;\n\nattribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy/gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},pattern:{fragment:"precision mediump float;\n\nuniform float u_opacity;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a, u_pattern_br_a, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b, u_pattern_br_b, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n}\n",vertex:"precision highp float;\n\nuniform mat4 u_matrix;\nuniform vec2 u_patternscale_a;\nuniform vec2 u_patternscale_b;\nuniform vec2 u_offset_a;\nuniform vec2 u_offset_b;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos_a = u_patternscale_a * a_pos + u_offset_a;\n    v_pos_b = u_patternscale_b * a_pos + u_offset_b;\n}\n"},raster:{fragment:"precision mediump float;\n\nuniform float u_opacity0;\nuniform float u_opacity1;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    vec4 color = color0 * u_opacity0 + color1 * u_opacity1;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb), color.a);\n}\n",vertex:"precision highp float;\n\nuniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos0 = (((a_texture_pos / 32767.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},icon:{fragment:"precision mediump float;\n\nuniform sampler2D u_texture;\n\nvarying vec2 v_tex;\nvarying float v_alpha;\n\nvoid main() {\n    gl_FragColor = texture2D(u_texture, v_tex) * v_alpha;\n}\n",vertex:"precision highp float;\n\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec4 a_data1;\nattribute vec4 a_data2;\n\n\n// matrix is for the vertex position, exmatrix is for rotating and projecting\n// the extrusion vector.\nuniform mat4 u_matrix;\nuniform mat4 u_exmatrix;\nuniform mediump float u_zoom;\nuniform mediump float u_fadedist;\nuniform mediump float u_minfadezoom;\nuniform mediump float u_maxfadezoom;\nuniform mediump float u_fadezoom;\nuniform lowp float u_opacity;\nuniform bool u_skewed;\nuniform float u_extra;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_alpha;\n\nvoid main() {\n    vec2 a_tex = a_data1.xy;\n    mediump float a_labelminzoom = a_data1[2];\n    mediump vec2 a_zoom = a_data2.st;\n    mediump float a_minzoom = a_zoom[0];\n    mediump float a_maxzoom = a_zoom[1];\n\n    float a_fadedist = 10.0;\n\n    // u_zoom is the current zoom level adjusted for the change in font size\n    mediump float z = 2.0 - step(a_minzoom, u_zoom) - (1.0 - step(a_maxzoom, u_zoom));\n\n    // fade out labels\n    mediump float alpha = clamp((u_fadezoom - a_labelminzoom) / u_fadedist, 0.0, 1.0);\n\n    if (u_fadedist >= 0.0) {\n        v_alpha = alpha;\n    } else {\n        v_alpha = 1.0 - alpha;\n    }\n    if (u_maxfadezoom < a_labelminzoom) {\n        v_alpha = 0.0;\n    }\n    if (u_minfadezoom >= a_labelminzoom) {\n        v_alpha = 1.0;\n    }\n\n    // if label has been faded out, clip it\n    z += step(v_alpha, 0.0);\n\n    if (u_skewed) {\n        vec4 extrude = u_exmatrix * vec4(a_offset / 64.0, 0, 0);\n        gl_Position = u_matrix * vec4(a_pos + extrude.xy, 0, 1);\n        gl_Position.z += z * gl_Position.w;\n    } else {\n        vec4 extrude = u_exmatrix * vec4(a_offset / 64.0, z, 0);\n        gl_Position = u_matrix * vec4(a_pos, 0, 1) + extrude;\n    }\n\n    v_tex = a_tex / u_texsize;\n\n    v_alpha *= u_opacity;\n}\n"},sdf:{fragment:"precision mediump float;\n\nuniform sampler2D u_texture;\nuniform lowp vec4 u_color;\nuniform lowp float u_buffer;\nuniform lowp float u_gamma;\n\nvarying vec2 v_tex;\nvarying float v_alpha;\nvarying float v_gamma_scale;\n\nvoid main() {\n    lowp float gamma = u_gamma * v_gamma_scale;\n    lowp float dist = texture2D(u_texture, v_tex).a;\n    lowp float alpha = smoothstep(u_buffer - gamma, u_buffer + gamma, dist) * v_alpha;\n    gl_FragColor = u_color * alpha;\n}\n",vertex:"precision highp float;\n\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec4 a_data1;\nattribute vec4 a_data2;\n\n\n// matrix is for the vertex position, exmatrix is for rotating and projecting\n// the extrusion vector.\nuniform mat4 u_matrix;\nuniform mat4 u_exmatrix;\n\nuniform mediump float u_zoom;\nuniform mediump float u_fadedist;\nuniform mediump float u_minfadezoom;\nuniform mediump float u_maxfadezoom;\nuniform mediump float u_fadezoom;\nuniform bool u_skewed;\nuniform float u_extra;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_alpha;\nvarying float v_gamma_scale;\n\nvoid main() {\n    vec2 a_tex = a_data1.xy;\n    mediump float a_labelminzoom = a_data1[2];\n    mediump vec2 a_zoom = a_data2.st;\n    mediump float a_minzoom = a_zoom[0];\n    mediump float a_maxzoom = a_zoom[1];\n\n    // u_zoom is the current zoom level adjusted for the change in font size\n    mediump float z = 2.0 - step(a_minzoom, u_zoom) - (1.0 - step(a_maxzoom, u_zoom));\n\n    // fade out labels\n    mediump float alpha = clamp((u_fadezoom - a_labelminzoom) / u_fadedist, 0.0, 1.0);\n\n    if (u_fadedist >= 0.0) {\n        v_alpha = alpha;\n    } else {\n        v_alpha = 1.0 - alpha;\n    }\n    if (u_maxfadezoom < a_labelminzoom) {\n        v_alpha = 0.0;\n    }\n    if (u_minfadezoom >= a_labelminzoom) {\n        v_alpha = 1.0;\n    }\n\n    // if label has been faded out, clip it\n    z += step(v_alpha, 0.0);\n\n    if (u_skewed) {\n        vec4 extrude = u_exmatrix * vec4(a_offset / 64.0, 0, 0);\n        gl_Position = u_matrix * vec4(a_pos + extrude.xy, 0, 1);\n        gl_Position.z += z * gl_Position.w;\n    } else {\n        vec4 extrude = u_exmatrix * vec4(a_offset / 64.0, z, 0);\n        gl_Position = u_matrix * vec4(a_pos, 0, 1) + extrude;\n    }\n\n    // position of y on the screen\n    float y = gl_Position.y / gl_Position.w;\n    // how much features are squished in all directions by the perspectiveness\n    float perspective_scale = 1.0 / (1.0 - y * u_extra);\n    v_gamma_scale = perspective_scale;\n\n    v_tex = a_tex / u_texsize;\n}\n"},collisionbox:{fragment:"precision mediump float;\n\nuniform float u_zoom;\nuniform float u_maxzoom;\n\nvarying float v_max_zoom;\nvarying float v_placement_zoom;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0) * alpha;\n\n    if (v_placement_zoom > u_zoom) {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n    }\n\n    if (u_zoom >= v_max_zoom) {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0) * alpha * 0.25;\n    }\n\n    if (v_placement_zoom >= u_maxzoom) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0) * alpha * 0.2;\n    }\n}\n",vertex:"precision highp float;\n\nattribute vec2 a_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_data;\n\nuniform mat4 u_matrix;\nuniform float u_scale;\n\nvarying float v_max_zoom;\nvarying float v_placement_zoom;\n\nvoid main() {\n     gl_Position = u_matrix * vec4(a_pos + a_extrude / u_scale, 0.0, 1.0);\n\n     v_max_zoom = a_data.x;\n     v_placement_zoom = a_data.y;\n}\n"}}},{path:145}],28:[function(t,e,n){"use strict";function i(t){t=t||{},this._data=t.data,void 0!==t.maxzoom&&(this.maxzoom=t.maxzoom);var e=l/this.tileSize;this.geojsonVtOptions={buffer:(void 0!==t.buffer?t.buffer:128)*e,tolerance:(void 0!==t.tolerance?t.tolerance:.375)*e,extent:l,maxZoom:this.maxzoom},this.cluster=t.cluster||!1,this.superclusterOptions={maxZoom:Math.max(t.clusterMaxZoom,this.maxzoom-1)||this.maxzoom-1,extent:l,radius:(t.clusterRadius||50)*e,log:!1},this._pyramid=new a({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!0,load:this._loadTile.bind(this),abort:this._abortTile.bind(this),unload:this._unloadTile.bind(this),add:this._addTile.bind(this),remove:this._removeTile.bind(this),redoPlacement:this._redoTilePlacement.bind(this)})}var r=t("../util/util"),o=t("../util/evented"),a=t("./tile_pyramid"),s=t("./source"),u=t("resolve-url"),l=t("../data/bucket").EXTENT;e.exports=i,i.prototype=r.inherit(o,{minzoom:0,maxzoom:14,tileSize:512,_dirty:!0,isTileClipped:!0,setData:function(t){return this._data=t,this._dirty=!0,this.fire("change"),this.map&&this.update(this.map.transform),this},onAdd:function(t){this.map=t},loaded:function(){return this._loaded&&this._pyramid.loaded()},update:function(t){this._dirty&&this._updateData(),this._loaded&&this._pyramid.update(this.used,t)},reload:function(){this._loaded&&this._pyramid.reload()},serialize:function(){return{type:"geojson",data:this._data}},getVisibleCoordinates:s._getVisibleCoordinates,getTile:s._getTile,featuresAt:s._vectorFeaturesAt,featuresIn:s._vectorFeaturesIn,_updateData:function(){this._dirty=!1;var t={tileSize:this.tileSize,source:this.id,geojsonVtOptions:this.geojsonVtOptions,cluster:this.cluster,superclusterOptions:this.superclusterOptions},e=this._data;"string"==typeof e?t.url="undefined"!=typeof window?u(window.location.href,e):e:t.data=JSON.stringify(e),this.workerID=this.dispatcher.send("parse geojson",t,function(t){this._loaded=!0,t?this.fire("error",{error:t}):(this._pyramid.reload(),this.fire("change"))}.bind(this))},_loadTile:function(t){var e=t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,n={uid:t.uid,coord:t.coord,zoom:t.coord.z,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,overscaling:e,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug};t.workerID=this.dispatcher.send("load geojson tile",n,function(e,n){if(t.unloadVectorData(this.map.painter),!t.aborted){if(e)return void this.fire("tile.error",{tile:t});t.loadVectorData(n),t.redoWhenDone&&(t.redoWhenDone=!1,t.redoPlacement(this)),this.fire("tile.load",{tile:t})}}.bind(this),this.workerID)},_abortTile:function(t){t.aborted=!0},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.unloadVectorData(this.map.painter),this.dispatcher.send("remove tile",{uid:t.uid,source:this.id},null,t.workerID)},redoPlacement:s.redoPlacement,_redoTilePlacement:function(t){t.redoPlacement(this)}})},{"../data/bucket":1,"../util/evented":92,"../util/util":98,"./source":32,"./tile_pyramid":35,"resolve-url":151}],29:[function(t,e,n){"use strict";function i(t){this.features=t,this.length=t.length}function r(t){this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=s}var o=t("point-geometry"),a=t("vector-tile").VectorTileFeature,s=t("../data/bucket").EXTENT;e.exports=i,i.prototype.feature=function(t){return new r(this.features[t])},r.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var n=t[e],i=[],r=0;r<n.length;r++)i.push(new o(n[r][0],n[r][1]));this.geometry.push(i)}return this.geometry},r.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-(1/0),i=1/0,r=-(1/0),o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var u=a[s];e=Math.min(e,u.x),n=Math.max(n,u.x),i=Math.min(i,u.y),r=Math.max(r,u.y)}return[e,i,n,r]},r.prototype.toGeoJSON=a.prototype.toGeoJSON},{"../data/bucket":1,"point-geometry":148,"vector-tile":157}],30:[function(t,e,n){"use strict";function i(t){this.urls=t.urls,this.coordinates=t.coordinates,c.getImage(t.url,function(e,n){e||(this.image=n,this.image.addEventListener("load",function(){this.map._rerender()}.bind(this)),this._loaded=!0,this.map&&this.setCoordinates(t.coordinates))}.bind(this))}var r=t("../util/util"),o=t("./tile"),a=t("./tile_coord"),s=t("../geo/lng_lat"),u=t("point-geometry"),l=t("../util/evented"),c=t("../util/ajax"),h=t("../data/bucket").EXTENT;e.exports=i,i.prototype=r.inherit(l,{onAdd:function(t){this.map=t,this.image&&this.setCoordinates(this.coordinates)},setCoordinates:function(t){this.coordinates=t;var e=this.map,n=t.map(function(t){return e.transform.locationCoordinate(s.convert(t)).zoomTo(0)}),i=this.centerCoord=r.getCoordinatesCenter(n);i.column=Math.round(i.column),i.row=Math.round(i.row);var l=n.map(function(t){var e=t.zoomTo(i.zoom);return new u(Math.round((e.column-i.column)*h),Math.round((e.row-i.row)*h))}),c=e.painter.gl,f=32767,d=new Int16Array([l[0].x,l[0].y,0,0,l[1].x,l[1].y,f,0,l[3].x,l[3].y,0,f,l[2].x,l[2].y,f,f]);return this.tile=new o(new a(i.zoom,i.column,i.row)),this.tile.buckets={},this.tile.boundsBuffer=c.createBuffer(),c.bindBuffer(c.ARRAY_BUFFER,this.tile.boundsBuffer),c.bufferData(c.ARRAY_BUFFER,d,c.STATIC_DRAW),this.fire("change"),this},loaded:function(){return this.image&&this.image.complete},update:function(){},reload:function(){},prepare:function(){if(this._loaded&&this.loaded()){var t=this.map.painter,e=t.gl;this.tile.texture?(e.bindTexture(e.TEXTURE_2D,this.tile.texture),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.image)):(this.tile.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.tile.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.image))}},getVisibleCoordinates:function(){return this.tile?[this.tile.coord]:[]},getTile:function(){return this.tile},featuresAt:function(t,e,n){return n(null,[])},featuresIn:function(t,e,n){return n(null,[])},serialize:function(){return{type:"image",urls:this.urls,coordinates:this.coordinates}}})},{"../data/bucket":1,"../geo/lng_lat":10,"../util/ajax":86,"../util/evented":92,"../util/util":98,"./tile":33,"./tile_coord":34,"point-geometry":148}],31:[function(t,e,n){"use strict";function i(t){r.extend(this,r.pick(t,["url","tileSize"])),s._loadTileJSON.call(this,t)}var r=t("../util/util"),o=t("../util/ajax"),a=t("../util/evented"),s=t("./source"),u=t("../util/mapbox").normalizeTileURL;e.exports=i,i.prototype=r.inherit(a,{minzoom:0,maxzoom:22,roundZoom:!0,tileSize:512,_loaded:!1,onAdd:function(t){this.map=t},loaded:function(){return this._pyramid&&this._pyramid.loaded()},update:function(t){this._pyramid&&this._pyramid.update(this.used,t,this.map.style.rasterFadeDuration)},reload:function(){},serialize:function(){return{type:"raster",url:this.url,tileSize:this.tileSize}},getVisibleCoordinates:s._getVisibleCoordinates,getTile:s._getTile,_loadTile:function(t){function e(e,n){if(delete t.request,!t.aborted){if(e)return t.errored=!0,void this.fire("tile.error",{tile:t,error:e});var i=this.map.painter.gl;t.texture=this.map.painter.getTexture(n.width),t.texture?(i.bindTexture(i.TEXTURE_2D,t.texture),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,n)):(t.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,t.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n),t.texture.size=n.width),i.generateMipmap(i.TEXTURE_2D),t.timeAdded=(new Date).getTime(),this.map.animationLoop.set(this.style.rasterFadeDuration),t.source=this,t.loaded=!0,this.fire("tile.load",{tile:t})}}var n=u(t.coord.url(this.tiles),this.url,this.tileSize);t.request=o.getImage(n,e.bind(this))},_abortTile:function(t){t.aborted=!0,t.request&&(t.request.abort(),delete t.request)},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.texture&&this.map.painter.saveTexture(t.texture)},featuresAt:function(t,e,n){n(null,[])},featuresIn:function(t,e,n){n(null,[])}})},{"../util/ajax":86,"../util/evented":92,"../util/mapbox":96,"../util/util":98,"./source":32}],32:[function(t,e,n){"use strict";var i=t("../util/util"),r=t("../util/ajax"),o=t("../util/browser"),a=t("./tile_pyramid"),s=t("../util/mapbox").normalizeSourceURL,u=t("./tile_coord");n._loadTileJSON=function(t){var e=function(t,e){return t?void this.fire("error",{error:t}):(i.extend(this,i.pick(e,["tiles","minzoom","maxzoom","attribution"])),e.vector_layers&&(this.vectorLayers=e.vector_layers,this.vectorLayerIds=this.vectorLayers.map(function(t){return t.id})),this._pyramid=new a({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom,reparseOverscaled:this.reparseOverscaled,load:this._loadTile.bind(this),abort:this._abortTile.bind(this),unload:this._unloadTile.bind(this),add:this._addTile.bind(this),remove:this._removeTile.bind(this),redoPlacement:this._redoTilePlacement?this._redoTilePlacement.bind(this):void 0}),void this.fire("load"))}.bind(this);t.url?r.getJSON(s(t.url),e):o.frame(e.bind(this,null,t))},n.redoPlacement=function(){if(this._pyramid)for(var t=this._pyramid.orderedIDs(),e=0;e<t.length;e++){var n=this._pyramid.getTile(t[e]);this._redoTilePlacement(n)}},n._getTile=function(t){return this._pyramid.getTile(t.id)},n._getVisibleCoordinates=function(){return this._pyramid?this._pyramid.renderedIDs().map(u.fromID):[]},n._vectorFeaturesAt=function(t,e,n){if(!this._pyramid)return n(null,[]);var i=this._pyramid.tileAt(t);return i?void this.dispatcher.send("query features",{uid:i.tile.uid,x:i.x,y:i.y,scale:i.scale,tileSize:i.tileSize,source:this.id,params:e},n,i.tile.workerID):n(null,[])},n._vectorFeaturesIn=function(t,e,n){if(!this._pyramid)return n(null,[]);var r=this._pyramid.tilesIn(t);return r?void i.asyncAll(r,function(t,n){this.dispatcher.send("query features",{uid:t.tile.uid,source:this.id,minX:t.minX,maxX:t.maxX,minY:t.minY,maxY:t.maxY,params:e},n,t.tile.workerID)}.bind(this),function(t,e){n(t,Array.prototype.concat.apply([],e))}):n(null,[])},n.create=function(e){var i={vector:t("./vector_tile_source"),raster:t("./raster_tile_source"),geojson:t("./geojson_source"),video:t("./video_source"),image:t("./image_source")};return n.is(e)?e:new i[e.type](e)},n.is=function(e){var n={vector:t("./vector_tile_source"),raster:t("./raster_tile_source"),geojson:t("./geojson_source"),video:t("./video_source"),image:t("./image_source")};for(var i in n)if(e instanceof n[i])return!0;return!1}},{"../util/ajax":86,"../util/browser":87,"../util/mapbox":96,"../util/util":98,"./geojson_source":28,"./image_source":30,"./raster_tile_source":31,"./tile_coord":34,"./tile_pyramid":35,"./vector_tile_source":36,"./video_source":37}],33:[function(t,e,n){"use strict";function i(t,e,n){this.coord=t,this.uid=o.uniqueId(),this.loaded=!1,this.isUnloaded=!1,this.uses=0,this.tileSize=e,this.sourceMaxZoom=n,this.buckets={}}function r(t){for(var e={},n=0;n<t.length;n++){var i=a.create(t[n]);e[i.id]=i}return e}var o=t("../util/util"),a=t("../data/bucket");e.exports=i,i.prototype={pixelsToTileUnits:function(t,e){return t*(a.EXTENT/(this.tileSize*Math.pow(2,e-this.coord.z)))},positionAt:function(t){var e=t.zoomTo(Math.min(this.coord.z,this.sourceMaxZoom));return{x:(e.column-this.coord.x)*a.EXTENT,y:(e.row-this.coord.y)*a.EXTENT}},loadVectorData:function(t){this.loaded=!0,t&&(this.buckets=r(t.buckets))},reloadSymbolData:function(t,e){if(!this.isUnloaded){for(var n in this.buckets){var i=this.buckets[n];"symbol"===i.type&&(i.destroy(e.gl),delete this.buckets[n])}o.extend(this.buckets,r(t.buckets))}},unloadVectorData:function(t){for(var e in this.buckets){var n=this.buckets[e];n.destroy(t.gl)}this.buckets=null,this.loaded=!1,this.isUnloaded=!0},redoPlacement:function(t){function e(e,n){this.reloadSymbolData(n,t.map.painter),t.fire("tile.load",{tile:this}),this.redoingPlacement=!1,this.redoWhenDone&&(this.redoPlacement(t),this.redoWhenDone=!1)}return!this.loaded||this.redoingPlacement?void(this.redoWhenDone=!0):(this.redoingPlacement=!0,void t.dispatcher.send("redo placement",{uid:this.uid,source:t.id,angle:t.map.transform.angle,pitch:t.map.transform.pitch,collisionDebug:t.map.collisionDebug},e.bind(this),this.workerID))},getBucket:function(t){return this.buckets&&this.buckets[t.ref||t.id]}}},{"../data/bucket":1,"../util/util":98}],34:[function(t,e,n){"use strict";function i(t,e,n,i){isNaN(i)&&(i=0),this.z=+t,this.x=+e,this.y=+n,this.w=+i,i*=2,0>i&&(i=-1*i-1);var r=1<<this.z;this.id=32*(r*r*i+r*this.y+this.x)+this.z}function r(t,e){if(t.row>e.row){var n=t;t=e,e=n}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function o(t,e,n,i,r){var o=Math.max(n,Math.floor(e.y0)),a=Math.min(i,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var u=t.dx/t.dy,l=e.dx/e.dy,c=t.dx>0,h=e.dx<0,f=o;a>f;f++){var d=u*Math.max(0,Math.min(t.dy,f+c-t.y0))+t.x0,p=l*Math.max(0,Math.min(e.dy,f+h-e.y0))+e.x0;r(Math.floor(p),Math.ceil(d),f)}}function a(t,e,n,i,a,s){var u,l=r(t,e),c=r(e,n),h=r(n,t);l.dy>c.dy&&(u=l,l=c,c=u),l.dy>h.dy&&(u=l,l=h,h=u),c.dy>h.dy&&(u=c,c=h,h=u),l.dy&&o(h,l,i,a,s),c.dy&&o(h,c,i,a,s)}var s=t("../geo/coordinate");e.exports=i,i.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y},i.prototype.toCoordinate=function(){var t=this.z,e=Math.pow(2,t),n=this.y,i=this.x+e*this.w;return new s(i,n,t)},i.fromID=function(t){var e=t%32,n=1<<e,r=(t-e)/32,o=r%n,a=(r-o)/n%n,s=Math.floor(r/(n*n));return s%2!==0&&(s=-1*s-1),s/=2,new i(e,o,a,s)},i.prototype.url=function(t,e){return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",Math.min(this.z,e||this.z)).replace("{x}",this.x).replace("{y}",this.y);
},i.prototype.parent=function(t){return 0===this.z?null:this.z>t?new i(this.z-1,this.x,this.y,this.w):new i(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w)},i.prototype.wrapped=function(){return new i(this.z,this.x,this.y,0)},i.prototype.children=function(t){if(this.z>=t)return[new i(this.z+1,this.x,this.y,this.w)];var e=this.z+1,n=2*this.x,r=2*this.y;return[new i(e,n,r,this.w),new i(e,n+1,r,this.w),new i(e,n,r+1,this.w),new i(e,n+1,r+1,this.w)]},i.cover=function(t,e,n){function r(t,e,r){var a,u,l;if(r>=0&&o>=r)for(a=t;e>a;a++)u=(a%o+o)%o,l=new i(n,u,r,Math.floor(a/o)),s[l.id]=l}var o=1<<t,s={};return a(e[0],e[1],e[2],0,o,r),a(e[2],e[3],e[0],0,o,r),Object.keys(s).map(function(t){return s[t]})}},{"../geo/coordinate":9}],35:[function(t,e,n){"use strict";function i(t){this.tileSize=t.tileSize,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this.roundZoom=t.roundZoom,this.reparseOverscaled=t.reparseOverscaled,this._load=t.load,this._abort=t.abort,this._unload=t.unload,this._add=t.add,this._remove=t.remove,this._redoPlacement=t.redoPlacement,this._tiles={},this._cache=new u(0,function(t){return this._unload(t)}.bind(this)),this._filterRendered=this._filterRendered.bind(this)}function r(t,e){return t%32-e%32}var o=t("./tile"),a=t("./tile_coord"),s=t("point-geometry"),u=t("../util/lru_cache"),l=t("../util/util"),c=t("../data/bucket").EXTENT;e.exports=i,i.maxOverzooming=10,i.maxUnderzooming=3,i.prototype={loaded:function(){for(var t in this._tiles)if(!this._tiles[t].loaded&&!this._tiles[t].errored)return!1;return!0},orderedIDs:function(){return Object.keys(this._tiles).map(Number).sort(r)},renderedIDs:function(){return this.orderedIDs().filter(this._filterRendered)},_filterRendered:function(t){return this._tiles[t].loaded&&!this._coveredTiles[t]},reload:function(){this._cache.reset();for(var t in this._tiles)this._load(this._tiles[t])},getTile:function(t){return this._tiles[t]},getZoom:function(t){return t.zoom+Math.log(t.tileSize/this.tileSize)/Math.LN2},coveringZoomLevel:function(t){return(this.roundZoom?Math.round:Math.floor)(this.getZoom(t))},coveringTiles:function(t){var e=this.coveringZoomLevel(t),n=e;if(e<this.minzoom)return[];e>this.maxzoom&&(e=this.maxzoom);var i=t,r=i.locationCoordinate(i.center)._zoomTo(e),o=new s(r.column-.5,r.row-.5);return a.cover(e,[i.pointCoordinate(new s(0,0))._zoomTo(e),i.pointCoordinate(new s(i.width,0))._zoomTo(e),i.pointCoordinate(new s(i.width,i.height))._zoomTo(e),i.pointCoordinate(new s(0,i.height))._zoomTo(e)],this.reparseOverscaled?n:e).sort(function(t,e){return o.dist(t)-o.dist(e)})},findLoadedChildren:function(t,e,n){var i=!1;for(var r in this._tiles){var o=this._tiles[r];if(!(n[r]||!o.loaded||o.coord.z<=t.z||o.coord.z>e)){var a=Math.pow(2,Math.min(o.coord.z,this.maxzoom)-Math.min(t.z,this.maxzoom));if(Math.floor(o.coord.x/a)===t.x&&Math.floor(o.coord.y/a)===t.y)for(n[r]=!0,i=!0;o&&o.coord.z-1>t.z;){var s=o.coord.parent(this.maxzoom).id;o=this._tiles[s],o&&o.loaded&&(delete n[r],n[s]=!0)}}}return i},findLoadedParent:function(t,e,n){for(var i=t.z-1;i>=e;i--){t=t.parent(this.maxzoom);var r=this._tiles[t.id];if(r&&r.loaded)return n[t.id]=!0,r;if(this._cache.has(t.id))return this.addTile(t),n[t.id]=!0,this._tiles[t.id]}},updateCacheSize:function(t){var e=Math.ceil(t.width/t.tileSize)+1,n=Math.ceil(t.height/t.tileSize)+1,i=e*n,r=5;this._cache.setMaxSize(Math.floor(i*r))},update:function(t,e,n){var r,o,s;this.updateCacheSize(e);var u=(this.roundZoom?Math.round:Math.floor)(this.getZoom(e)),c=Math.max(u-i.maxOverzooming,this.minzoom),h=Math.max(u+i.maxUnderzooming,this.minzoom),f={},d=(new Date).getTime();this._coveredTiles={};var p=t?this.coveringTiles(e):[];for(r=0;r<p.length;r++)o=p[r],s=this.addTile(o),f[o.id]=!0,s.loaded||this.findLoadedChildren(o,h,f)||this.findLoadedParent(o,c,f);for(var m={},v=Object.keys(f),y=0;y<v.length;y++){var g=v[y];o=a.fromID(g),s=this._tiles[g],s&&s.timeAdded>d-(n||0)&&(this.findLoadedChildren(o,h,f)&&(f[g]=!0),this.findLoadedParent(o,c,m))}var _;for(_ in m)f[_]||(this._coveredTiles[_]=!0);for(_ in m)f[_]=!0;var x=l.keysDifference(this._tiles,f);for(r=0;r<x.length;r++)this.removeTile(+x[r]);this.transform=e},addTile:function(t){var e=this._tiles[t.id];if(e)return e;var n=t.wrapped();if(e=this._tiles[n.id],e||(e=this._cache.get(n.id),e&&this._redoPlacement&&this._redoPlacement(e)),!e){var i=t.z,r=i>this.maxzoom?Math.pow(2,i-this.maxzoom):1;e=new o(n,this.tileSize*r,this.maxzoom),this._load(e)}return e.uses++,this._tiles[t.id]=e,this._add(e,t),e},removeTile:function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._remove(e),e.uses>0||(e.loaded?this._cache.add(e.coord.wrapped().id,e):(this._abort(e),this._unload(e))))},clearTiles:function(){for(var t in this._tiles)this.removeTile(t);this._cache.reset()},tileAt:function(t){for(var e=this.orderedIDs(),n=0;n<e.length;n++){var i=this._tiles[e[n]],r=i.positionAt(t);if(r&&r.x>=0&&r.x<c&&r.y>=0&&r.y<c)return{tile:i,x:r.x,y:r.y,scale:Math.pow(2,this.transform.zoom-i.coord.z),tileSize:i.tileSize}}},tilesIn:function(t){for(var e=[],n=this.orderedIDs(),i=0;i<n.length;i++){var r=this._tiles[n[i]],o=[r.positionAt(t[0]),r.positionAt(t[1])];o[0].x<c&&o[0].y<c&&o[1].x>=0&&o[1].y>=0&&e.push({tile:r,minX:o[0].x,maxX:o[1].x,minY:o[0].y,maxY:o[1].y})}return e}}},{"../data/bucket":1,"../util/lru_cache":95,"../util/util":98,"./tile":33,"./tile_coord":34,"point-geometry":148}],36:[function(t,e,n){"use strict";function i(t){if(r.extend(this,r.pick(t,["url","tileSize"])),this._options=r.extend({type:"vector"},t),512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");a._loadTileJSON.call(this,t)}var r=t("../util/util"),o=t("../util/evented"),a=t("./source"),s=t("../util/mapbox").normalizeTileURL;e.exports=i,i.prototype=r.inherit(o,{minzoom:0,maxzoom:22,tileSize:512,reparseOverscaled:!0,_loaded:!1,isTileClipped:!0,onAdd:function(t){this.map=t},loaded:function(){return this._pyramid&&this._pyramid.loaded()},update:function(t){this._pyramid&&this._pyramid.update(this.used,t)},reload:function(){this._pyramid&&this._pyramid.reload()},serialize:function(){return r.extend({},this._options)},getVisibleCoordinates:a._getVisibleCoordinates,getTile:a._getTile,featuresAt:a._vectorFeaturesAt,featuresIn:a._vectorFeaturesIn,_loadTile:function(t){var e=t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,n={url:s(t.coord.url(this.tiles,this.maxzoom),this.url),uid:t.uid,coord:t.coord,zoom:t.coord.z,tileSize:this.tileSize*e,source:this.id,overscaling:e,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug};t.workerID?this.dispatcher.send("reload tile",n,this._tileLoaded.bind(this,t),t.workerID):t.workerID=this.dispatcher.send("load tile",n,this._tileLoaded.bind(this,t))},_tileLoaded:function(t,e,n){if(!t.aborted){if(e)return t.errored=!0,void this.fire("tile.error",{tile:t,error:e});t.loadVectorData(n),t.redoWhenDone&&(t.redoWhenDone=!1,t.redoPlacement(this)),this.fire("tile.load",{tile:t}),this.fire("tile.stats",n.bucketStats)}},_abortTile:function(t){t.aborted=!0,this.dispatcher.send("abort tile",{uid:t.uid,source:this.id},null,t.workerID)},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.unloadVectorData(this.map.painter),this.dispatcher.send("remove tile",{uid:t.uid,source:this.id},null,t.workerID)},redoPlacement:a.redoPlacement,_redoTilePlacement:function(t){t.redoPlacement(this)}})},{"../util/evented":92,"../util/mapbox":96,"../util/util":98,"./source":32}],37:[function(t,e,n){"use strict";function i(t){this.urls=t.urls,this.coordinates=t.coordinates,c.getVideo(t.urls,function(e,n){if(!e){this.video=n,this.video.loop=!0;var i;this.video.addEventListener("playing",function(){i=this.map.style.animationLoop.set(1/0),this.map._rerender()}.bind(this)),this.video.addEventListener("pause",function(){this.map.style.animationLoop.cancel(i)}.bind(this)),this._loaded=!0,this.map&&(this.video.play(),this.setCoordinates(t.coordinates))}}.bind(this))}var r=t("../util/util"),o=t("./tile"),a=t("./tile_coord"),s=t("../geo/lng_lat"),u=t("point-geometry"),l=t("../util/evented"),c=t("../util/ajax"),h=t("../data/bucket").EXTENT;e.exports=i,i.prototype=r.inherit(l,{roundZoom:!0,getVideo:function(){return this.video},onAdd:function(t){this.map=t,this.video&&(this.video.play(),this.setCoordinates(this.coordinates))},setCoordinates:function(t){this.coordinates=t;var e=this.map,n=t.map(function(t){return e.transform.locationCoordinate(s.convert(t)).zoomTo(0)}),i=this.centerCoord=r.getCoordinatesCenter(n);i.column=Math.round(i.column),i.row=Math.round(i.row);var l=n.map(function(t){var e=t.zoomTo(i.zoom);return new u(Math.round((e.column-i.column)*h),Math.round((e.row-i.row)*h))}),c=e.painter.gl,f=32767,d=new Int16Array([l[0].x,l[0].y,0,0,l[1].x,l[1].y,f,0,l[3].x,l[3].y,0,f,l[2].x,l[2].y,f,f]);return this.tile=new o(new a(i.zoom,i.column,i.row)),this.tile.buckets={},this.tile.boundsBuffer=c.createBuffer(),c.bindBuffer(c.ARRAY_BUFFER,this.tile.boundsBuffer),c.bufferData(c.ARRAY_BUFFER,d,c.STATIC_DRAW),this.fire("change"),this},loaded:function(){return this.video&&this.video.readyState>=2},update:function(){},reload:function(){},prepare:function(){if(this._loaded&&!(this.video.readyState<2)){var t=this.map.painter.gl;this.tile.texture?(t.bindTexture(t.TEXTURE_2D,this.tile.texture),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.tile.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.tile.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.video)),this._currentTime=this.video.currentTime}},getVisibleCoordinates:function(){return this.tile?[this.tile.coord]:[]},getTile:function(){return this.tile},featuresAt:function(t,e,n){return n(null,[])},featuresIn:function(t,e,n){return n(null,[])},serialize:function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}})},{"../data/bucket":1,"../geo/lng_lat":10,"../util/ajax":86,"../util/evented":92,"../util/util":98,"./tile":33,"./tile_coord":34,"point-geometry":148}],38:[function(t,e,n){"use strict";function i(t){this.self=t,this.actor=new r(t,this),this.loading={},this.loaded={},this.layers=[],this.geoJSONIndexes={}}var r=t("../util/actor"),o=t("./worker_tile"),a=t("../util/util"),s=t("../util/ajax"),u=t("vector-tile"),l=t("pbf"),c=t("supercluster"),h=t("geojson-vt"),f=t("./geojson_wrapper");e.exports=function(t){return new i(t)},a.extend(i.prototype,{"set layers":function(t){this.layers=t},"update layers":function(t){var e,n={};for(e=0;e<t.length;e++)n[t[e].id]=t[e];for(e=0;e<this.layers.length;e++)this.layers[e]=n[this.layers[e].id]||this.layers[e]},"load tile":function(t,e){function n(t,n){return delete this.loading[i][r],t?e(t):(a.data=new u.VectorTile(new l(new Uint8Array(n))),a.parse(a.data,this.layers,this.actor,e),this.loaded[i]=this.loaded[i]||{},void(this.loaded[i][r]=a))}var i=t.source,r=t.uid;this.loading[i]||(this.loading[i]={});var a=this.loading[i][r]=new o(t);a.xhr=s.getArrayBuffer(t.url,n.bind(this))},"reload tile":function(t,e){var n=this.loaded[t.source],i=t.uid;if(n&&n[i]){var r=n[i];r.parse(r.data,this.layers,this.actor,e)}},"abort tile":function(t){var e=this.loading[t.source],n=t.uid;e&&e[n]&&(e[n].xhr.abort(),delete e[n])},"remove tile":function(t){var e=this.loaded[t.source],n=t.uid;e&&e[n]&&delete e[n]},"redo placement":function(t,e){var n=this.loaded[t.source],i=this.loading[t.source],r=t.uid;if(n&&n[r]){var o=n[r],a=o.redoPlacement(t.angle,t.pitch,t.collisionDebug);a.result&&e(null,a.result,a.transferables)}else i&&i[r]&&(i[r].angle=t.angle)},"parse geojson":function(t,e){var n=function(n,i){if(n)return e(n);if("object"!=typeof i)return e(new Error("Input data is not a valid GeoJSON object."));try{this.geoJSONIndexes[t.source]=t.cluster?c(t.superclusterOptions).load(i.features):h(i,t.geojsonVtOptions)}catch(n){return e(n)}e(null)}.bind(this);if(t.url)s.getJSON(t.url,n);else{if("string"!=typeof t.data)return e(new Error("Input data is not a valid GeoJSON object."));n(null,JSON.parse(t.data))}},"load geojson tile":function(t,e){var n=t.source,i=t.coord;if(!this.geoJSONIndexes[n])return e(null,null);var r=this.geoJSONIndexes[n].getTile(Math.min(i.z,t.maxZoom),i.x,i.y);if(!r)return e(null,null);var a=new o(t);a.parse(new f(r.features),this.layers,this.actor,e),this.loaded[n]=this.loaded[n]||{},this.loaded[n][t.uid]=a},"query features":function(t,e){var n=this.loaded[t.source]&&this.loaded[t.source][t.uid];n?n.featureTree.query(t,e):e(null,[])}})},{"../util/actor":85,"../util/ajax":86,"../util/util":98,"./geojson_wrapper":29,"./worker_tile":39,"geojson-vt":103,pbf:147,supercluster:153,"vector-tile":157}],39:[function(t,e,n){"use strict";function i(t){this.coord=t.coord,this.uid=t.uid,this.zoom=t.zoom,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=t.overscaling,this.angle=t.angle,this.pitch=t.pitch,this.collisionDebug=t.collisionDebug}function r(t){for(var e in t.buffers)if(t.buffers[e].length>0)return!0;return!1}function o(t){return t.serialize()}function a(t){var e=[];for(var n in t){var i=t[n];for(var r in i.buffers)e.push(i.buffers[r].arrayBuffer)}return e}var s=t("../data/feature_tree"),u=t("../symbol/collision_tile"),l=t("../data/bucket");e.exports=i,i.prototype.parse=function(t,e,n,i){function c(t,e){for(var n=0;n<t.length;n++){var i=t.feature(n);for(var r in e)e[r].filter(i)&&e[r].features.push(i)}}function h(t){if(t)return i(t);if(z++,2===z){for(var e=S.length-1;e>=0;e--)f(_,S[e]);d()}}function f(t,e){var n=Date.now();e.populateBuffers(E,I,D);var i=Date.now()-n;if(e.interactive)for(var r=0;r<e.features.length;r++){var o=e.features[r];t.featureTree.insert(o.bbox(),e.layers,o)}e.features=null,g._total+=i,g[e.id]=(g[e.id]||0)+i}function d(){_.status="done",_.redoPlacementAfterDone&&(_.redoPlacement(_.angle,_.pitch,null),_.redoPlacementAfterDone=!1),i(null,{buckets:w.filter(r).map(o),bucketStats:g},a(w))}this.status="parsing",this.featureTree=new s(this.coord,this.overscaling);var p,m,v,y,g={_total:0},_=this,x={},b={};for(p=0;p<e.length;p++)m=e[p],m.source===this.source&&(m.ref||m.minzoom&&this.zoom<m.minzoom||m.maxzoom&&this.zoom>=m.maxzoom||m.layout&&"none"===m.layout.visibility||(y=l.create({layer:m,zoom:this.zoom,overscaling:this.overscaling,collisionDebug:this.collisionDebug}),y.createFilter(),x[m.id]=y,t.layers&&(v=m["source-layer"],b[v]=b[v]||{},b[v][m.id]=y)));for(p=0;p<e.length;p++)m=e[p],m.source===this.source&&m.ref&&x[m.ref]&&x[m.ref].layers.push(m.id);if(t.layers)for(v in b)m=t.layers[v],m&&c(m,b[v]);else c(t,x);var w=[],S=this.symbolBuckets=[],M=[],E=new u(this.angle,this.pitch);for(var T in x)y=x[T],0!==y.features.length&&(w.push(y),"symbol"===y.type?S.push(y):M.push(y));var D={},I={},z=0;if(S.length>0){for(p=S.length-1;p>=0;p--)S[p].updateIcons(D),S[p].updateFont(I);for(var A in I)I[A]=Object.keys(I[A]).map(Number);D=Object.keys(D),n.send("get glyphs",{uid:this.uid,stacks:I},function(t,e){I=e,h(t)}),D.length?n.send("get icons",{icons:D},function(t,e){D=e,h(t)}):h()}for(p=M.length-1;p>=0;p--)f(this,M[p]);return 0===S.length?d():void 0},i.prototype.redoPlacement=function(t,e,n){if("done"!==this.status)return this.redoPlacementAfterDone=!0,this.angle=t,{};for(var i=new u(t,e),s=this.symbolBuckets,l=s.length-1;l>=0;l--)s[l].placeFeatures(i,n);return{result:{buckets:s.filter(r).map(o)},transferables:a(s)}}},{"../data/bucket":1,"../data/feature_tree":7,"../symbol/collision_tile":61}],40:[function(t,e,n){"use strict";function i(){this.n=0,this.times=[]}e.exports=i,i.prototype.stopped=function(){return this.times=this.times.filter(function(t){return t.time>=(new Date).getTime()}),!this.times.length},i.prototype.set=function(t){return this.times.push({id:this.n,time:t+(new Date).getTime()}),this.n++},i.prototype.cancel=function(t){this.times=this.times.filter(function(e){return e.id!==t})}},{}],41:[function(t,e,n){"use strict";function i(t){this.base=t,this.retina=s.devicePixelRatio>1;var e=this.retina?"@2x":"";a.getJSON(u(t,e,".json"),function(t,e){return t?void this.fire("error",{error:t}):(this.data=e,void(this.img&&this.fire("load")))}.bind(this)),a.getImage(u(t,e,".png"),function(t,e){if(t)return void this.fire("error",{error:t});for(var n=e.getData(),i=e.data=new Uint8Array(n.length),r=0;r<n.length;r+=4){var o=n[r+3]/255;i[r+0]=n[r+0]*o,i[r+1]=n[r+1]*o,i[r+2]=n[r+2]*o,i[r+3]=n[r+3]}this.img=e,this.data&&this.fire("load")}.bind(this))}function r(){}var o=t("../util/evented"),a=t("../util/ajax"),s=t("../util/browser"),u=t("../util/mapbox").normalizeSpriteURL;e.exports=i,i.prototype=Object.create(o),i.prototype.toJSON=function(){return this.base},i.prototype.loaded=function(){return!(!this.data||!this.img)},i.prototype.resize=function(){if(s.devicePixelRatio>1!==this.retina){var t=new i(this.base);t.on("load",function(){this.img=t.img,this.data=t.data,this.retina=t.retina}.bind(this))}},r.prototype={x:0,y:0,width:0,height:0,pixelRatio:1,sdf:!1},i.prototype.getSpritePosition=function(t){if(!this.loaded())return new r;var e=this.data&&this.data[t];return e&&this.img?e:new r}},{"../util/ajax":86,"../util/browser":87,"../util/evented":92,"../util/mapbox":96}],42:[function(t,e,n){"use strict";function i(t){if(u[t])return u[t];if(Array.isArray(t))return t;if(t&&t.stops)return s.extend({},t,{stops:t.stops.map(r)});if("string"==typeof t){var e=a(t);if(!e)throw new Error("Invalid color "+t);var n=o(e);return u[t]=n,n}throw new Error("Invalid color "+t)}function r(t){return[t[0],i(t[1])]}function o(t){return[t[0]/255,t[1]/255,t[2]/255,t[3]/1]}var a=t("csscolorparser").parseCSSColor,s=t("../util/util"),u={};e.exports=i},{"../util/util":98,csscolorparser:99}],43:[function(t,e,n){"use strict";function i(t,e){this.animationLoop=e||new v,this.dispatcher=new m(Math.max(p.hardwareConcurrency-1,1),this),this.spriteAtlas=new l(512,512),this.lineAtlas=new c(256,512),this._layers={},this._order=[],this._groups=[],this.sources={},this.zoomHistory={},h.bindAll(["_forwardSourceEvent","_forwardTileEvent","_forwardLayerEvent","_redoPlacement"],this);var n=function(t,e){if(t)return void this.fire("error",{error:t});if(!y.emitErrors(this,y(e))){this._loaded=!0,this.stylesheet=e;var n=e.sources;for(var i in n)this.addSource(i,n[i]);e.sprite&&(this.sprite=new s(e.sprite),this.sprite.on("load",this.fire.bind(this,"change"))),this.glyphSource=new u(e.glyphs),this._resolve(),this.fire("load")}}.bind(this);"string"==typeof t?f.getJSON(d(t),n):p.frame(n.bind(this,null,t)),this.on("source.load",function(t){var e=t.source;if(e&&e.vectorLayerIds)for(var n in this._layers){var i=this._layers[n];i.source===e.id&&this._validateLayer(i)}})}var r=t("../util/evented"),o=t("./style_batch"),a=t("./style_layer"),s=t("./image_sprite"),u=t("../symbol/glyph_source"),l=t("../symbol/sprite_atlas"),c=t("../render/line_atlas"),h=t("../util/util"),f=t("../util/ajax"),d=t("../util/mapbox").normalizeStyleURL,p=t("../util/browser"),m=t("../util/dispatcher"),v=t("./animation_loop"),y=t("./validate_style");e.exports=i,i.prototype=h.inherit(r,{_loaded:!1,_validateLayer:function(t){var e=this.sources[t.source];t.sourceLayer&&e&&e.vectorLayerIds&&-1===e.vectorLayerIds.indexOf(t.sourceLayer)&&this.fire("error",{error:new Error('Source layer "'+t.sourceLayer+'" does not exist on source "'+e.id+'" as specified by style layer "'+t.id+'"')})},loaded:function(){if(!this._loaded)return!1;for(var t in this.sources)if(!this.sources[t].loaded())return!1;return!this.sprite||this.sprite.loaded()},_resolve:function(){var t,e;this._layers={},this._order=this.stylesheet.layers.map(function(t){return t.id});for(var n=0;n<this.stylesheet.layers.length;n++)e=this.stylesheet.layers[n],e.ref||(t=a.create(e),this._layers[t.id]=t,t.on("error",this._forwardLayerEvent));for(var i=0;i<this.stylesheet.layers.length;i++)if(e=this.stylesheet.layers[i],e.ref){var r=this.getLayer(e.ref);t=a.create(e,r),this._layers[t.id]=t,t.on("error",this._forwardLayerEvent)}this._groupLayers(),this._broadcastLayers()},_groupLayers:function(){var t;this._groups=[];for(var e=0;e<this._order.length;++e){var n=this._layers[this._order[e]];t&&n.source===t.source||(t=[],t.source=n.source,this._groups.push(t)),t.push(n)}},_broadcastLayers:function(t){this.dispatcher.broadcast(t?"update layers":"set layers",this._serializeLayers(t))},_serializeLayers:function(t){t=t||this._order;for(var e=[],n={includeRefProperties:!0},i=0;i<t.length;i++)e.push(this._layers[t[i]].serialize(n));return e},_cascade:function(t,e){if(this._loaded){e=e||{transition:!0};for(var n in this._layers)this._layers[n].cascade(t,e,this.stylesheet.transition||{},this.animationLoop);this.fire("change")}},_recalculate:function(t){for(var e in this.sources)this.sources[e].used=!1;this._updateZoomHistory(t),this.rasterFadeDuration=300;for(var n in this._layers){var i=this._layers[n];i.recalculate(t,this.zoomHistory),!i.isHidden(t)&&i.source&&(this.sources[i.source].used=!0)}var r=300;Math.floor(this.z)!==Math.floor(t)&&this.animationLoop.set(r),this.z=t,this.fire("zoom")},_updateZoomHistory:function(t){var e=this.zoomHistory;void 0===e.lastIntegerZoom&&(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=0,e.lastZoom=t),Math.floor(e.lastZoom)<Math.floor(t)?(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=Date.now()):Math.floor(e.lastZoom)>Math.floor(t)&&(e.lastIntegerZoom=Math.floor(t+1),e.lastIntegerZoomTime=Date.now()),e.lastZoom=t},batch:function(t){o(this,t)},addSource:function(t,e){return this.batch(function(n){n.addSource(t,e)}),this},removeSource:function(t){return this.batch(function(e){e.removeSource(t)}),this},getSource:function(t){return this.sources[t]},addLayer:function(t,e){return this.batch(function(n){n.addLayer(t,e)}),this},removeLayer:function(t){return this.batch(function(e){e.removeLayer(t)}),this},getLayer:function(t){return this._layers[t]},getReferentLayer:function(t){var e=this.getLayer(t);return e.ref&&(e=this.getLayer(e.ref)),e},setFilter:function(t,e){return this.batch(function(n){n.setFilter(t,e)}),this},setLayerZoomRange:function(t,e,n){return this.batch(function(i){i.setLayerZoomRange(t,e,n)}),this},getFilter:function(t){return this.getReferentLayer(t).filter},getLayoutProperty:function(t,e){return this.getReferentLayer(t).getLayoutProperty(e)},getPaintProperty:function(t,e,n){return this.getLayer(t).getPaintProperty(e,n)},serialize:function(){return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:h.mapObject(this.sources,function(t){return t.serialize()}),layers:this._order.map(function(t){return this._layers[t].serialize()},this)},function(t){return void 0!==t})},featuresAt:function(t,e,n){this._queryFeatures("featuresAt",t,e,n)},featuresIn:function(t,e,n){this._queryFeatures("featuresIn",t,e,n)},_queryFeatures:function(t,e,n,i){var r=[],o=null;n.layer&&(n.layerIds=Array.isArray(n.layer)?n.layer:[n.layer]),h.asyncAll(Object.keys(this.sources),function(i,a){var s=this.sources[i];s[t](e,n,function(t,e){e&&(r=r.concat(e)),t&&(o=t),a()})}.bind(this),function(){return o?i(o):void i(null,r.filter(function(t){return void 0!==this._layers[t.layer]}.bind(this)).map(function(t){return t.layer=this._layers[t.layer].serialize({includeRefProperties:!0}),t}.bind(this)))}.bind(this))},_remove:function(){this.dispatcher.remove()},_reloadSource:function(t){this.sources[t].reload()},_updateSources:function(t){for(var e in this.sources)this.sources[e].update(t)},_redoPlacement:function(){for(var t in this.sources)this.sources[t].redoPlacement&&this.sources[t].redoPlacement()},_forwardSourceEvent:function(t){this.fire("source."+t.type,h.extend({source:t.target},t))},_forwardTileEvent:function(t){this.fire(t.type,h.extend({source:t.target},t))},_forwardLayerEvent:function(t){this.fire("layer."+t.type,h.extend({layer:{id:t.target.id}},t))},"get sprite json":function(t,e){var n=this.sprite;n.loaded()?e(null,{sprite:n.data,retina:n.retina}):n.on("load",function(){e(null,{sprite:n.data,retina:n.retina})})},"get icons":function(t,e){var n=this.sprite,i=this.spriteAtlas;n.loaded()?(i.setSprite(n),i.addIcons(t.icons,e)):n.on("load",function(){i.setSprite(n),i.addIcons(t.icons,e)})},"get glyphs":function(t,e){function n(t,n,i){t&&console.error(t),o[i]=n,r--,0===r&&e(null,o)}var i=t.stacks,r=Object.keys(i).length,o={};for(var a in i)this.glyphSource.getSimpleGlyphs(a,i[a],t.uid,n)}})},{"../render/line_atlas":25,"../symbol/glyph_source":64,"../symbol/sprite_atlas":69,"../util/ajax":86,"../util/browser":87,"../util/dispatcher":89,"../util/evented":92,"../util/mapbox":96,"../util/util":98,"./animation_loop":40,"./image_sprite":41,"./style_batch":44,"./style_layer":46,"./validate_style":55}],44:[function(t,e,n){"use strict";function i(t,e){if(!t._loaded)throw new Error("Style is not done loading");var n=Object.create(i.prototype);if(n._style=t,n._groupLayers=!1,n._updateAllLayers=!1,n._updatedLayers={},n._updatedSources={},n._events=[],n._change=!1,e(n),n._groupLayers&&n._style._groupLayers(),n._updateAllLayers)n._style._broadcastLayers();else{var r=Object.keys(n._updatedLayers);r.length&&n._style._broadcastLayers(r)}Object.keys(n._updatedSources).forEach(function(t){n._style._reloadSource(t)}),n._events.forEach(function(t){n._style.fire.apply(n._style,t)}),n._change&&n._style.fire("change")}var r=t("../source/source"),o=t("./style_layer"),a=t("./validate_style"),s=t("./style_spec"),u=t("../util/util");i.prototype={addLayer:function(t,e){if(!(t instanceof o)){if(a.emitErrors(this._style,a.layer({key:"layers."+t.id,value:t,style:this._style.serialize(),styleSpec:s,arrayIndex:-1})))return this;var n=t.ref&&this._style.getLayer(t.ref);t=o.create(t,n)}return this._style._validateLayer(t),t.on("error",this._style._forwardLayerEvent),this._style._layers[t.id]=t,this._style._order.splice(e?this._style._order.indexOf(e):1/0,0,t.id),this._groupLayers=!0,this._updateAllLayers=!0,t.source&&(this._updatedSources[t.source]=!0),this._events.push(["layer.add",{layer:t}]),this._change=!0,this},removeLayer:function(t){var e=this._style._layers[t];if(void 0===e)throw new Error("There is no layer with this ID");for(var n in this._style._layers)this._style._layers[n].ref===t&&this.removeLayer(n);return e.off("error",this._style._forwardLayerEvent),delete this._style._layers[t],this._style._order.splice(this._style._order.indexOf(t),1),this._groupLayers=!0,this._updateAllLayers=!0,this._events.push(["layer.remove",{layer:e}]),this._change=!0,this},setPaintProperty:function(t,e,n,i){return this._style.getLayer(t).setPaintProperty(e,n,i),this._change=!0,this},setLayoutProperty:function(t,e,n){var i=this._style.getReferentLayer(t);return t=i.id,i.getLayoutProperty(e)===n?this:(i.setLayoutProperty(e,n),this._updatedLayers[t]=!0,i.source&&(this._updatedSources[i.source]=!0),this._change=!0,this)},setFilter:function(t,e){var n=this._style.getReferentLayer(t);return t=n.id,a.emitErrors(this._style,a.filter({key:"layers."+t+".filter",value:e,style:this._style.serialize(),styleSpec:s}))?this:u.deepEqual(n.filter,e)?this:(n.filter=e,this._updatedLayers[t]=!0,n.source&&(this._updatedSources[n.source]=!0),this._change=!0,this)},setLayerZoomRange:function(t,e,n){var i=this._style.getReferentLayer(t);return t=i.id,i.minzoom===e&&i.maxzoom===n?this:(null!=e&&(i.minzoom=e),null!=n&&(i.maxzoom=n),this._updatedLayers[t]=!0,i.source&&(this._updatedSources[i.source]=!0),this._change=!0,this)},addSource:function(t,e){if(!this._style._loaded)throw new Error("Style is not done loading");if(void 0!==this._style.sources[t])throw new Error("There is already a source with this ID");return!r.is(e)&&a.emitErrors(this._style,a.source({key:"sources."+t,style:this._style.serialize(),value:e,styleSpec:s}))?this:(e=r.create(e),this._style.sources[t]=e,e.id=t,e.style=this._style,e.dispatcher=this._style.dispatcher,e.on("load",this._style._forwardSourceEvent).on("error",this._style._forwardSourceEvent).on("change",this._style._forwardSourceEvent).on("tile.add",this._style._forwardTileEvent).on("tile.load",this._style._forwardTileEvent).on("tile.error",this._style._forwardTileEvent).on("tile.remove",this._style._forwardTileEvent).on("tile.stats",this._style._forwardTileEvent),this._events.push(["source.add",{source:e}]),this._change=!0,this)},removeSource:function(t){if(void 0===this._style.sources[t])throw new Error("There is no source with this ID");var e=this._style.sources[t];return delete this._style.sources[t],e.off("load",this._style._forwardSourceEvent).off("error",this._style._forwardSourceEvent).off("change",this._style._forwardSourceEvent).off("tile.add",this._style._forwardTileEvent).off("tile.load",this._style._forwardTileEvent).off("tile.error",this._style._forwardTileEvent).off("tile.remove",this._style._forwardTileEvent).off("tile.stats",this._style._forwardTileEvent),this._events.push(["source.remove",{source:e}]),this._change=!0,this}},e.exports=i},{"../source/source":32,"../util/util":98,"./style_layer":46,"./style_spec":53,"./validate_style":55}],45:[function(t,e,n){"use strict";function i(t,e){this.type=t.type,this.transitionable=t.transition,this.value=e,this.isFunction=!!e.stops,this.json=JSON.stringify(this.value);var n="color"===this.type?a(this.value):e;"interpolated"===t["function"]?this.calculate=o.interpolated(n):(this.calculate=o["piecewise-constant"](n),t.transition&&(this.calculate=r(this.calculate)))}function r(t){return function(e,n,i){var r,o,a,s=e%1,u=Math.min((Date.now()-n.lastIntegerZoomTime)/i,1),l=1,c=1;return e>n.lastIntegerZoom?(r=s+(1-s)*u,l*=2,o=t(e-1),a=t(e)):(r=1-(1-u)*s,a=t(e),o=t(e+1),l/=2),{from:o,fromScale:l,to:a,toScale:c,t:r}}}var o=t("mapbox-gl-function"),a=t("./parse_color");e.exports=i},{"./parse_color":42,"mapbox-gl-function":120}],46:[function(t,e,n){"use strict";function i(t,e){this.id=t.id,this.ref=t.ref,this.metadata=t.metadata,this.type=(e||t).type,this.source=(e||t).source,this.sourceLayer=(e||t)["source-layer"],this.minzoom=(e||t).minzoom,this.maxzoom=(e||t).maxzoom,this.filter=(e||t).filter,this.interactive=(e||t).interactive,this.paint={},this.layout={},this._paintSpecifications=u["paint_"+this.type],this._layoutSpecifications=u["layout_"+this.type],this._paintTransitions={},this._paintTransitionOptions={},this._paintDeclarations={},this._layoutDeclarations={};for(var n in t){var i=n.match(/^paint(?:\.(.*))?$/);if(i){var r=i[1]||"";for(var o in t[n])this.setPaintProperty(o,t[n][o],r)}}if(this.ref)this._layoutDeclarations=e._layoutDeclarations;else for(var a in t.layout)this.setLayoutProperty(a,t.layout[a]);this.recalculateStatic()}function r(t){return t.value}var o=t("../util/util"),a=t("./style_transition"),s=t("./style_declaration"),u=t("./style_spec"),l=t("./validate_style"),c=t("./parse_color"),h=t("../util/evented");e.exports=i;var f="-transition";i.create=function(e,n){var i={background:t("./style_layer/background_style_layer"),circle:t("./style_layer/circle_style_layer"),fill:t("./style_layer/fill_style_layer"),line:t("./style_layer/line_style_layer"),raster:t("./style_layer/raster_style_layer"),symbol:t("./style_layer/symbol_style_layer")};return new i[(n||e).type](e,n)},i.prototype=o.inherit(h,{setLayoutProperty:function(t,e){if(null==e)delete this._layoutDeclarations[t];else{if(l.emitErrors(this,l.layoutProperty({key:"layers."+this.id+".layout."+t,layerType:this.type,objectKey:t,value:e,styleSpec:u})))return;this._layoutDeclarations[t]=new s(this._layoutSpecifications[t],e)}},getLayoutProperty:function(t){return this._layoutDeclarations[t]&&this._layoutDeclarations[t].value},getLayoutValue:function(t,e,n){
var i=this._layoutSpecifications[t],r=this._layoutDeclarations[t];return r?r.calculate(e,n):i["default"]},setPaintProperty:function(t,e,n){var i="layers."+this.id+(n?'["paint.'+n+'"].':".paint.")+t;if(o.endsWith(t,f))if(this._paintTransitionOptions[n||""]||(this._paintTransitionOptions[n||""]={}),null===e||void 0===e)delete this._paintTransitionOptions[n||""][t];else{if(l.emitErrors(this,l.paintProperty({key:i,layerType:this.type,objectKey:t,value:e,styleSpec:u})))return;this._paintTransitionOptions[n||""][t]=e}else if(this._paintDeclarations[n||""]||(this._paintDeclarations[n||""]={}),null===e||void 0===e)delete this._paintDeclarations[n||""][t];else{if(l.emitErrors(this,l.paintProperty({key:i,layerType:this.type,objectKey:t,value:e,styleSpec:u})))return;this._paintDeclarations[n||""][t]=new s(this._paintSpecifications[t],e)}},getPaintProperty:function(t,e){return e=e||"",o.endsWith(t,f)?this._paintTransitionOptions[e]&&this._paintTransitionOptions[e][t]:this._paintDeclarations[e]&&this._paintDeclarations[e][t]&&this._paintDeclarations[e][t].value},getPaintValue:function(t,e,n){var i=this._paintSpecifications[t],r=this._paintTransitions[t];return r?r.at(e,n):"color"===i.type&&i["default"]?c(i["default"]):i["default"]},isHidden:function(t){return this.minzoom&&t<this.minzoom?!0:this.maxzoom&&t>=this.maxzoom?!0:"none"===this.layout.visibility?!0:0===this.paint[this.type+"-opacity"]},cascade:function(t,e,n,i){function r(t,r){var s=e.transition?u[t]:void 0;if(s&&s.declaration.json===r.json)l[t]=s;else{var h=new a(r,s,o.extend({duration:300,delay:0},n,c.getPaintProperty(t+f)));h.instant()||(h.loopID=i.set(h.endTime-(new Date).getTime())),s&&i.cancel(s.loopID),l[t]=h}}var u=this._paintTransitions,l=this._paintTransitions={},c=this;for(var h in this._paintDeclarations)if(""===h||t[h])for(var d in this._paintDeclarations[h])r(d,this._paintDeclarations[h][d]);for(var p=o.keysDifference(u,l),m=0;m<p.length;m++){var v=this._paintSpecifications[p[m]];r(p[m],new s(v,v["default"]))}this.recalculateStatic()},recalculateStatic:function(){for(var t in this._paintSpecifications)t in this._paintTransitions||(this.paint[t]=this.getPaintValue(t));this._layoutFunctions={};for(var e in this._layoutSpecifications){var n=this._layoutDeclarations[e];n&&n.isFunction?this._layoutFunctions[e]=!0:this.layout[e]=this.getLayoutValue(e)}},recalculate:function(t,e){for(var n in this._paintTransitions)this.paint[n]=this.getPaintValue(n,t,e);for(var i in this._layoutFunctions)this.layout[i]=this.getLayoutValue(i,t,e)},serialize:function(t){var e={id:this.id,ref:this.ref,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,interactive:this.interactive};for(var n in this._paintDeclarations){var i=""===n?"paint":"paint."+n;e[i]=o.mapObject(this._paintDeclarations[n],r)}return(!this.ref||t&&t.includeRefProperties)&&o.extend(e,{type:this.type,source:this.source,"source-layer":this.sourceLayer,filter:this.filter,layout:o.mapObject(this._layoutDeclarations,r)}),o.filterObject(e,function(t,e){return void 0!==t&&!("layout"===e&&!Object.keys(t).length)})}})},{"../util/evented":92,"../util/util":98,"./parse_color":42,"./style_declaration":45,"./style_layer/background_style_layer":47,"./style_layer/circle_style_layer":48,"./style_layer/fill_style_layer":49,"./style_layer/line_style_layer":50,"./style_layer/raster_style_layer":51,"./style_layer/symbol_style_layer":52,"./style_spec":53,"./style_transition":54,"./validate_style":55}],47:[function(t,e,n){"use strict";function i(){o.apply(this,arguments)}var r=t("../../util/util"),o=t("../style_layer");e.exports=i,i.prototype=r.inherit(o,{})},{"../../util/util":98,"../style_layer":46}],48:[function(t,e,n){"use strict";function i(){o.apply(this,arguments)}var r=t("../../util/util"),o=t("../style_layer");e.exports=i,i.prototype=r.inherit(o,{})},{"../../util/util":98,"../style_layer":46}],49:[function(t,e,n){"use strict";function i(){o.apply(this,arguments)}var r=t("../../util/util"),o=t("../style_layer");e.exports=i,i.prototype=r.inherit(o,{})},{"../../util/util":98,"../style_layer":46}],50:[function(t,e,n){"use strict";function i(){o.apply(this,arguments)}var r=t("../../util/util"),o=t("../style_layer");e.exports=i,i.prototype=r.inherit(o,{getPaintValue:function(t,e,n){var i=o.prototype.getPaintValue.call(this,t,e,n);if(i&&"line-dasharray"===t){var r=Math.floor(e);this._flooredZoom!==r&&(this._flooredZoom=r,this._flooredLineWidth=this.getPaintValue("line-width",r,1/0)),i.fromScale*=this._flooredLineWidth,i.toScale*=this._flooredLineWidth}return i}})},{"../../util/util":98,"../style_layer":46}],51:[function(t,e,n){"use strict";function i(){o.apply(this,arguments)}var r=t("../../util/util"),o=t("../style_layer");e.exports=i,i.prototype=r.inherit(o,{})},{"../../util/util":98,"../style_layer":46}],52:[function(t,e,n){"use strict";function i(){o.apply(this,arguments)}var r=t("../../util/util"),o=t("../style_layer");e.exports=i,i.prototype=r.inherit(o,{isHidden:function(){if(o.prototype.isHidden.apply(this,arguments))return!0;var t=0===this.paint["text-opacity"]||!this.layout["text-field"],e=0===this.paint["icon-opacity"]||!this.layout["icon-image"];return!(!t||!e)},getLayoutValue:function(t,e,n){return"text-rotation-alignment"===t&&"line"===this.getLayoutValue("symbol-placement",e,n)&&!this.getLayoutProperty("text-rotation-alignment")||"icon-rotation-alignment"===t&&"line"===this.getLayoutValue("symbol-placement",e,n)&&!this.getLayoutProperty("icon-rotation-alignment")?"map":o.prototype.getLayoutValue.apply(this,arguments)}})},{"../../util/util":98,"../style_layer":46}],53:[function(t,e,n){"use strict";e.exports=t("mapbox-gl-style-spec/reference/latest")},{"mapbox-gl-style-spec/reference/latest":141}],54:[function(t,e,n){"use strict";function i(t,e,n){this.declaration=t,this.startTime=this.endTime=(new Date).getTime();var i=t.type;"string"!==i&&"array"!==i||!t.transitionable?this.interp=a[i]:this.interp=r,this.oldTransition=e,this.duration=n.duration||0,this.delay=n.delay||0,this.instant()||(this.endTime=this.startTime+this.duration+this.delay,this.ease=o.easeCubicInOut),e&&e.endTime<=this.startTime&&delete e.oldTransition}function r(t,e,n){return{from:t.to,fromScale:t.toScale,to:e.to,toScale:e.toScale,t:n}}var o=t("../util/util"),a=t("../util/interpolate");e.exports=i,i.prototype.instant=function(){return!this.oldTransition||!this.interp||0===this.duration&&0===this.delay},i.prototype.at=function(t,e,n){var i=this.declaration.calculate(t,e,this.duration);if(this.instant())return i;if(n=n||Date.now(),n<this.endTime){var r=this.oldTransition.at(t,e,this.startTime),o=this.ease((n-this.startTime-this.delay)/this.duration);i=this.interp(r,i,o)}return i}},{"../util/interpolate":94,"../util/util":98}],55:[function(t,e,n){"use strict";e.exports=t("mapbox-gl-style-spec/lib/validate_style.min"),e.exports.emitErrors=function(t,e){if(e&&e.length){for(var n=0;n<e.length;n++)t.fire("error",{error:new Error(e[n].message)});return!0}return!1}},{"mapbox-gl-style-spec/lib/validate_style.min":140}],56:[function(t,e,n){"use strict";function i(t,e,n,i){this.x=t,this.y=e,this.angle=n,void 0!==i&&(this.segment=i)}var r=t("point-geometry");e.exports=i,i.prototype=Object.create(r.prototype),i.prototype.clone=function(){return new i(this.x,this.y,this.angle,this.segment)}},{"point-geometry":148}],57:[function(t,e,n){"use strict";function i(t,e,n,i,r){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-n/2;){if(a--,0>a)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var u=[],l=0;n/2>s;){var c=t[a-1],h=t[a],f=t[a+1];if(!f)return!1;var d=c.angleTo(h)-h.angleTo(f);for(d=Math.abs((d+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:s,angleDelta:d}),l+=d;s-u[0].distance>i;)l-=u.shift().angleDelta;if(l>r)return!1;a++,s+=h.dist(f)}return!0}e.exports=i},{}],58:[function(t,e,n){"use strict";function i(t,e,n,i,o){for(var a=[],s=0;s<t.length;s++)for(var u,l=t[s],c=0;c<l.length-1;c++){var h=l[c],f=l[c+1];h.x<e&&f.x<e||(h.x<e?h=new r(e,h.y+(f.y-h.y)*((e-h.x)/(f.x-h.x)))._round():f.x<e&&(f=new r(e,h.y+(f.y-h.y)*((e-h.x)/(f.x-h.x)))._round()),h.y<n&&f.y<n||(h.y<n?h=new r(h.x+(f.x-h.x)*((n-h.y)/(f.y-h.y)),n)._round():f.y<n&&(f=new r(h.x+(f.x-h.x)*((n-h.y)/(f.y-h.y)),n)._round()),h.x>=i&&f.x>=i||(h.x>=i?h=new r(i,h.y+(f.y-h.y)*((i-h.x)/(f.x-h.x)))._round():f.x>=i&&(f=new r(i,h.y+(f.y-h.y)*((i-h.x)/(f.x-h.x)))._round()),h.y>=o&&f.y>=o||(h.y>=o?h=new r(h.x+(f.x-h.x)*((o-h.y)/(f.y-h.y)),o)._round():f.y>=o&&(f=new r(h.x+(f.x-h.x)*((o-h.y)/(f.y-h.y)),o)._round()),u&&h.equals(u[u.length-1])||(u=[h],a.push(u)),u.push(f)))))}return a}var r=t("point-geometry");e.exports=i},{"point-geometry":148}],59:[function(t,e,n){"use strict";function i(t,e,n,i,r,o){this.anchorPoint=t,this.x1=e,this.y1=n,this.x2=i,this.y2=r,this.maxScale=o,this.placementScale=0,this[0]=this[1]=this[2]=this[3]=0}e.exports=i},{}],60:[function(t,e,n){"use strict";function i(t,e,n,i,a,s,u){var l=n.top*i-a,c=n.bottom*i+a,h=n.left*i-a,f=n.right*i+a;if(this.boxes=[],s){var d=c-l,p=f-h;if(0>=d)return;if(d=Math.max(10*i,d),u){var m=t[e.segment+1].sub(t[e.segment])._unit()._mult(p),v=[e.sub(m),e.add(m)];this._addLineCollisionBoxes(v,e,0,p,d)}else this._addLineCollisionBoxes(t,e,e.segment,p,d)}else this.boxes.push(new r(new o(e.x,e.y),h,l,f,c,1/0))}var r=t("./collision_box"),o=t("point-geometry");e.exports=i,i.prototype._addLineCollisionBoxes=function(t,e,n,i,o){var a=o/2,s=Math.floor(i/a),u=-o/2,l=this.boxes,c=e,h=n+1,f=u;do{if(h--,0>h)return l;f-=t[h].dist(c),c=t[h]}while(f>-i/2);for(var d=t[h].dist(t[h+1]),p=0;s>p;p++){for(var m=-i/2+p*a;m>f+d;){if(f+=d,h++,h+1>=t.length)return l;d=t[h].dist(t[h+1])}var v=m-f,y=t[h],g=t[h+1],_=g.sub(y)._unit()._mult(v)._add(y),x=Math.max(Math.abs(m-u)-a/2,0),b=i/2/x;l.push(new r(_,-o/2,-o/2,o/2,o/2,b))}return l}},{"./collision_box":59,"point-geometry":148}],61:[function(t,e,n){"use strict";function i(t,e){this.tree=r(),this.angle=t;var n=Math.sin(t),i=Math.cos(t);this.rotationMatrix=[i,-n,n,i],this.reverseRotationMatrix=[i,n,-n,i],this.yStretch=1/Math.cos(e/180*Math.PI),this.yStretch=Math.pow(this.yStretch,1.3),this.edges=[new o(new a(0,0),0,-(1/0),0,1/0,1/0),new o(new a(s,0),0,-(1/0),0,1/0,1/0),new o(new a(0,0),-(1/0),0,1/0,0,1/0),new o(new a(0,s),-(1/0),0,1/0,0,1/0)]}var r=t("rbush"),o=t("./collision_box"),a=t("point-geometry"),s=t("../data/bucket").EXTENT;e.exports=i,i.prototype.minScale=.25,i.prototype.maxScale=2,i.prototype.placeCollisionFeature=function(t,e,n){for(var i=this.minScale,r=this.rotationMatrix,s=this.yStretch,u=0;u<t.boxes.length;u++){var l=t.boxes[u];if(!e){var c=l.anchorPoint.matMult(r),h=c.x,f=c.y;l[0]=h+l.x1,l[1]=f+l.y1*s,l[2]=h+l.x2,l[3]=f+l.y2*s;for(var d=this.tree.search(l),p=0;p<d.length;p++){var m=d[p],v=m.anchorPoint.matMult(r);if(i=this.getPlacementScale(i,c,l,v,m),i>=this.maxScale)return i}}if(n)for(var y=this.reverseRotationMatrix,g=new a(l.x1,l.y1).matMult(y),_=new a(l.x2,l.y1).matMult(y),x=new a(l.x1,l.y2).matMult(y),b=new a(l.x2,l.y2).matMult(y),w=new o(l.anchorPoint,Math.min(g.x,_.x,x.x,b.x),Math.min(g.y,_.x,x.x,b.x),Math.max(g.x,_.x,x.x,b.x),Math.max(g.y,_.x,x.x,b.x),l.maxScale),S=0;S<this.edges.length;S++){var M=this.edges[S];if(i=this.getPlacementScale(i,l.anchorPoint,w,M.anchorPoint,M),i>=this.maxScale)return i}}return i},i.prototype.getPlacementScale=function(t,e,n,i,r){var o=(r.x1-n.x2)/(e.x-i.x),a=(r.x2-n.x1)/(e.x-i.x),s=(r.y1-n.y2)*this.yStretch/(e.y-i.y),u=(r.y2-n.y1)*this.yStretch/(e.y-i.y);(isNaN(o)||isNaN(a))&&(o=a=1),(isNaN(s)||isNaN(u))&&(s=u=1);var l=Math.min(Math.max(o,a),Math.max(s,u));return l>r.maxScale&&(l=r.maxScale),l>n.maxScale&&(l=n.maxScale),l>t&&l>=r.placementScale&&(t=l),t},i.prototype.insertCollisionFeature=function(t,e){for(var n=t.boxes,i=0;i<n.length;i++)n[i].placementScale=e;e<this.maxScale&&this.tree.load(n)}},{"../data/bucket":1,"./collision_box":59,"point-geometry":148,rbush:150}],62:[function(t,e,n){"use strict";function i(t,e,n,i,o,a,s,u,l){var c=i?.6*a*s:0,h=Math.max(i?i.right-i.left:0,o?o.right-o.left:0),f=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;e/4>e-h*s&&(e=h*s+e/4);var d=2*a,p=f?e/2*u%e:(h/2+d)*s*u%e;return r(t,p,e,c,n,h*s,f,!1,l)}function r(t,e,n,i,u,l,c,h,f){for(var d=l/2,p=0,m=0;m<t.length-1;m++)p+=t[m].dist(t[m+1]);for(var v=0,y=e-n,g=[],_=0;_<t.length-1;_++){for(var x=t[_],b=t[_+1],w=x.dist(b),S=b.angleTo(x);v+w>y+n;){y+=n;var M=(y-v)/w,E=o(x.x,b.x,M),T=o(x.y,b.y,M);if(E>=0&&f>E&&T>=0&&f>T&&y-d>=0&&p>=y+d){var D=new a(E,T,S,_)._round();i&&!s(t,D,l,i,u)||g.push(D)}}v+=w}return h||g.length||c||(g=r(t,v/2,n,i,u,l,c,!0,f)),g}var o=t("../util/interpolate"),a=t("../symbol/anchor"),s=t("./check_max_angle");e.exports=i},{"../symbol/anchor":56,"../util/interpolate":94,"./check_max_angle":57}],63:[function(t,e,n){"use strict";function i(t,e){this.width=t,this.height=e,this.bin=new r(t,e),this.index={},this.ids={},this.data=new Uint8Array(t*e)}var r=t("shelf-pack");e.exports=i,i.prototype.getGlyphs=function(){var t,e,n,i={};for(var r in this.ids)t=r.split("#"),e=t[0],n=t[1],i[e]||(i[e]=[]),i[e].push(n);return i},i.prototype.getRects=function(){var t,e,n,i={};for(var r in this.ids)t=r.split("#"),e=t[0],n=t[1],i[e]||(i[e]={}),i[e][n]=this.index[r];return i},i.prototype.addGlyph=function(t,e,n,i){if(!n)return null;var r=e+"#"+n.id;if(this.index[r])return this.ids[r].indexOf(t)<0&&this.ids[r].push(t),this.index[r];if(!n.bitmap)return null;var o=n.width+2*i,a=n.height+2*i,s=1,u=o+2*s,l=a+2*s;u+=4-u%4,l+=4-l%4;var c=this.bin.allocate(u,l);if(c.x<0&&(this.resize(),c=this.bin.allocate(u,l)),c.x<0)return console.warn("glyph bitmap overflow"),{glyph:n,rect:null};this.index[r]=c,this.ids[r]=[t];for(var h=this.data,f=n.bitmap,d=0;a>d;d++)for(var p=this.width*(c.y+d+s)+c.x+s,m=o*d,v=0;o>v;v++)h[p+v]=f[m+v];return this.dirty=!0,c},i.prototype.resize=function(){var t=this.width,e=this.height;if(!(t>512||e>512)){this.texture&&(this.gl&&this.gl.deleteTexture(this.texture),this.texture=null),this.width*=2,this.height*=2,this.bin.resize(this.width,this.height);for(var n,i,r=new ArrayBuffer(this.width*this.height),o=0;e>o;o++)n=new Uint8Array(this.data.buffer,e*o,t),i=new Uint8Array(r,e*o*2,t),i.set(n);this.data=new Uint8Array(r)}},i.prototype.bind=function(t){this.gl=t,this.texture?t.bindTexture(t.TEXTURE_2D,this.texture):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,null))},i.prototype.updateTexture=function(t){this.bind(t),this.dirty&&(t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data),this.dirty=!1)}},{"shelf-pack":152}],64:[function(t,e,n){"use strict";function i(t){this.url=t&&a(t),this.atlases={},this.stacks={},this.loading={}}function r(t,e,n){var i=1;this.advance=t.advance,this.left=t.left-n-i,this.top=t.top+n+i,this.rect=e}function o(t,e,n,i){return i=i||"abc",n.replace("{s}",i[t.length%i.length]).replace("{fontstack}",t).replace("{range}",e)}var a=t("../util/mapbox").normalizeGlyphsURL,s=t("../util/ajax").getArrayBuffer,u=t("../util/glyphs"),l=t("../symbol/glyph_atlas"),c=t("pbf");e.exports=i,i.prototype.getSimpleGlyphs=function(t,e,n,i){void 0===this.stacks[t]&&(this.stacks[t]={}),void 0===this.atlases[t]&&(this.atlases[t]=new l(128,128));for(var o,a={},s=this.stacks[t],u=this.atlases[t],c=3,h={},f=0,d=0;d<e.length;d++){var p=e[d];if(o=Math.floor(p/256),s[o]){var m=s[o].glyphs[p],v=u.addGlyph(n,t,m,c);m&&(a[p]=new r(m,v,c))}else void 0===h[o]&&(h[o]=[],f++),h[o].push(p)}f||i(void 0,a,t);var y=function(e,o,s){if(!e)for(var l=this.stacks[t][o]=s.stacks[0],d=0;d<h[o].length;d++){var p=h[o][d],m=l.glyphs[p],v=u.addGlyph(n,t,m,c);m&&(a[p]=new r(m,v,c))}f--,f||i(void 0,a,t)}.bind(this);for(var g in h)this.loadRange(t,g,y)},i.prototype.loadRange=function(t,e,n){if(256*e>65535)return n("glyphs > 65535 not supported");void 0===this.loading[t]&&(this.loading[t]={});var i=this.loading[t];if(i[e])i[e].push(n);else{i[e]=[n];var r=256*e+"-"+(256*e+255),a=o(t,r,this.url);s(a,function(t,n){for(var r=!t&&new u(new c(new Uint8Array(n))),o=0;o<i[e].length;o++)i[e][o](t,e,r);delete i[e]})}},i.prototype.getGlyphAtlas=function(t){return this.atlases[t]}},{"../symbol/glyph_atlas":63,"../util/ajax":86,"../util/glyphs":93,"../util/mapbox":96,pbf:147}],65:[function(t,e,n){"use strict";e.exports=function(t,e,n){function i(i){c.push(t[i]),h.push(n[i]),f.push(e[i]),d++}function r(t,e,n){var i=l[t];return delete l[t],l[e]=i,h[i][0].pop(),h[i][0]=h[i][0].concat(n[0]),i}function o(t,e,n){var i=u[e];return delete u[e],u[t]=i,h[i][0].shift(),h[i][0]=n[0].concat(h[i][0]),i}function a(t,e,n){var i=n?e[0][e[0].length-1]:e[0][0];return t+":"+i.x+":"+i.y}var s,u={},l={},c=[],h=[],f=[],d=0;for(s=0;s<t.length;s++){var p=n[s],m=e[s];if(m){var v=a(m,p),y=a(m,p,!0);if(v in l&&y in u&&l[v]!==u[y]){var g=o(v,y,p),_=r(v,y,h[g]);delete u[v],delete l[y],l[a(m,h[_],!0)]=_,h[g]=null}else v in l?r(v,y,p):y in u?o(v,y,p):(i(s),u[v]=d-1,l[y]=d-1)}else i(s)}return{features:c,textFeatures:f,geometries:h}}},{}],66:[function(t,e,n){"use strict";function i(t,e,n,i,r,o,a,s,u){this.anchorPoint=t,this.tl=e,this.tr=n,this.bl=i,this.br=r,this.tex=o,this.angle=a,this.minScale=s,this.maxScale=u}function r(t,e,n,r,o,a){var l=e.image.rect,c=1,h=e.left-c,f=h+l.w/e.image.pixelRatio,d=e.top-c,p=d+l.h/e.image.pixelRatio,m=new s(h,d),v=new s(f,d),y=new s(f,p),g=new s(h,p),_=o["icon-rotate"]*Math.PI/180;if(a){var x=r[t.segment];if(t.y===x.y&&t.x===x.x&&t.segment+1<r.length){var b=r[t.segment+1];_+=Math.atan2(t.y-b.y,t.x-b.x)+Math.PI}else _+=Math.atan2(t.y-x.y,t.x-x.x)}if(_){var w=Math.sin(_),S=Math.cos(_),M=[S,-w,w,S];m=m.matMult(M),v=v.matMult(M),g=g.matMult(M),y=y.matMult(M)}return[new i(new s(t.x,t.y),m,v,g,y,e.image.rect,0,u,1/0)]}function o(t,e,n,r,o,l){for(var c=o["text-rotate"]*Math.PI/180,h=o["text-keep-upright"],f=e.positionedGlyphs,d=[],p=0;p<f.length;p++){var m=f[p],v=m.glyph,y=v.rect;if(y){var g,_=(m.x+v.advance/2)*n,x=u;l?(g=[],x=a(g,t,_,r,t.segment,!0),h&&(x=Math.min(x,a(g,t,_,r,t.segment,!1)))):g=[{anchorPoint:new s(t.x,t.y),offset:0,angle:0,maxScale:1/0,minScale:u}];for(var b=m.x+v.left,w=m.y-v.top,S=b+y.w,M=w+y.h,E=new s(b,w),T=new s(S,w),D=new s(b,M),I=new s(S,M),z=0;z<g.length;z++){var A=g[z],k=E,L=T,C=D,P=I,F=A.angle+c;if(F){var j=Math.sin(F),O=Math.cos(F),R=[O,-j,j,O];k=k.matMult(R),L=L.matMult(R),C=C.matMult(R),P=P.matMult(R)}var N=Math.max(A.minScale,x),B=(t.angle+c+A.offset+2*Math.PI)%(2*Math.PI);d.push(new i(A.anchorPoint,k,L,C,P,y,B,N,A.maxScale))}}}return d}function a(t,e,n,i,r,o){var a=!o;0>n&&(o=!o),o&&r++;var l=new s(e.x,e.y),c=i[r],h=1/0;n=Math.abs(n);for(var f=u;;){var d=l.dist(c),p=n/d,m=Math.atan2(c.y-l.y,c.x-l.x);if(o||(m+=Math.PI),a&&(m+=Math.PI),t.push({anchorPoint:l,offset:a?Math.PI:0,minScale:p,maxScale:h,angle:(m+2*Math.PI)%(2*Math.PI)}),f>=p)break;for(l=c;l.equals(c);)if(r+=o?1:-1,c=i[r],!c)return p;var v=c.sub(l)._unit();l=l.sub(v._mult(d)),h=p}return f}var s=t("point-geometry");e.exports={getIconQuads:r,getGlyphQuads:o};var u=.5},{"point-geometry":148}],67:[function(t,e,n){"use strict";function i(t,e,n){for(var i=[],o=0,a=t.length;a>o;o++){var s=r(t[o].properties,e["text-field"]);if(s){s=s.toString();var u=e["text-transform"];"uppercase"===u?s=s.toLocaleUpperCase():"lowercase"===u&&(s=s.toLocaleLowerCase());for(var l=0;l<s.length;l++)n[s.charCodeAt(l)]=!0;i[o]=s}else i[o]=null}return i}var r=t("../util/token");e.exports=i},{"../util/token":97}],68:[function(t,e,n){"use strict";function i(t,e,n,i){this.codePoint=t,this.x=e,this.y=n,this.glyph=i}function r(t,e,n,i,r,o){this.positionedGlyphs=t,this.text=e,this.top=n,this.bottom=i,this.left=r,this.right=o}function o(t,e,n,o,s,u,l,c,h){for(var f=[],d=new r(f,t,h[1],h[1],h[0],h[0]),p=-17,m=0,v=p,y=0;y<t.length;y++){var g=t.charCodeAt(y),_=e[g];_&&(f.push(new i(g,m,v,_)),m+=_.advance+c)}return f.length?(a(d,e,o,n,s,u,l,h),d):!1}function a(t,e,n,i,r,o,a,l){var c=null,d=0,p=0,m=0,v=0,y=t.positionedGlyphs;if(i)for(var g=0;g<y.length;g++){var _=y[g];if(_.x-=d,_.y+=n*m,_.x>i&&null!==c){var x=y[c+1].x;v=Math.max(x,v);for(var b=c+1;g>=b;b++)y[b].y+=n,y[b].x-=x;if(a){var w=c;h[y[c].codePoint]&&w--,s(y,e,p,w,a)}p=c+1,c=null,d+=x,m++}f[_.codePoint]&&(c=g)}var S=y[y.length-1],M=S.x+e[S.codePoint].advance;v=Math.max(v,M);var E=(m+1)*n;s(y,e,p,y.length-1,a),u(y,a,r,o,v,n,m,l),t.top+=-o*E,t.bottom=t.top+E,t.left+=-r*v,t.right=t.left+v}function s(t,e,n,i,r){for(var o=e[t[i].codePoint].advance,a=(t[i].x+o)*r,s=n;i>=s;s++)t[s].x-=a}function u(t,e,n,i,r,o,a,s){for(var u=(e-n)*r+s[0],l=(-i*(a+1)+.5)*o+s[1],c=0;c<t.length;c++)t[c].x+=u,t[c].y+=l}function l(t,e){if(!t||!t.rect)return null;var n=e["icon-offset"][0],i=e["icon-offset"][1],r=n-t.width/2,o=r+t.width,a=i-t.height/2,s=a+t.height;return new c(t,a,s,r,o)}function c(t,e,n,i,r){this.image=t,this.top=e,this.bottom=n,this.left=i,this.right=r}e.exports={shapeText:o,shapeIcon:l};var h={32:!0,8203:!0},f={32:!0,38:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0}},{}],69:[function(t,e,n){"use strict";function i(t,e){this.width=t,this.height=e,this.bin=new a(t,e),this.images={},this.data=!1,this.texture=0,this.filter=0,this.pixelRatio=1,this.dirty=!0}function r(t,e,n,i,r,o,a,s,u,l,c){var h,f,d=i*e+n,p=s*o+a;if(c)for(p-=o,f=-1;l>=f;f++,d=((f+l)%l+i)*e+n,p+=o)for(h=-1;u>=h;h++)r[p+h]=t[d+(h+u)%u];else for(f=0;l>f;f++,d+=e,p+=o)for(h=0;u>h;h++)r[p+h]=t[d+h]}function o(t,e,n,i,r){this.rect=t,this.width=e,this.height=n,this.sdf=i,this.pixelRatio=r}var a=t("shelf-pack"),s=t("../util/browser");e.exports=i,i.prototype.allocateImage=function(t,e){t/=this.pixelRatio,e/=this.pixelRatio;var n=2,i=t+n+(4-(t+n)%4),r=e+n+(4-(e+n)%4),o=this.bin.allocate(i,r);return o.x<0?(console.warn("SpriteAtlas out of space."),o):o},i.prototype.getImage=function(t,e){if(this.images[t])return this.images[t];if(!this.sprite)return null;var n=this.sprite.getSpritePosition(t);if(!n.width||!n.height)return null;var i=this.allocateImage(n.width,n.height);if(i.x<0)return i;var r=new o(i,n.width/n.pixelRatio,n.height/n.pixelRatio,n.sdf,n.pixelRatio/this.pixelRatio);return this.images[t]=r,this.copy(i,n,e),r},i.prototype.getPosition=function(t,e){var n=this.getImage(t,e),i=n&&n.rect;if(!i)return null;var r=n.width*n.pixelRatio,o=n.height*n.pixelRatio,a=1;return{size:[n.width,n.height],tl:[(i.x+a)/this.width,(i.y+a)/this.height],br:[(i.x+a+r)/this.width,(i.y+a+o)/this.height]}},i.prototype.allocate=function(){if(!this.data){var t=Math.floor(this.width*this.pixelRatio),e=Math.floor(this.height*this.pixelRatio);this.data=new Uint32Array(t*e);for(var n=0;n<this.data.length;n++)this.data[n]=0}},i.prototype.copy=function(t,e,n){if(this.sprite.img.data){var i=new Uint32Array(this.sprite.img.data.buffer);this.allocate();var o=this.data,a=1;r(i,this.sprite.img.width,e.x,e.y,o,this.width*this.pixelRatio,(t.x+a)*this.pixelRatio,(t.y+a)*this.pixelRatio,e.width,e.height,n),this.dirty=!0}},i.prototype.setSprite=function(t){t&&(this.pixelRatio=s.devicePixelRatio>1?2:1,this.canvas&&(this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio)),this.sprite=t},i.prototype.addIcons=function(t,e){for(var n=0;n<t.length;n++)this.getImage(t[n]);e(null,this.images)},i.prototype.bind=function(t,e){var n=!1;this.texture?t.bindTexture(t.TEXTURE_2D,this.texture):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n=!0);var i=e?t.LINEAR:t.NEAREST;i!==this.filter&&(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i),this.filter=i),this.dirty&&(this.allocate(),n?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width*this.pixelRatio,this.height*this.pixelRatio,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)):t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width*this.pixelRatio,this.height*this.pixelRatio,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)),this.dirty=!1)}},{"../util/browser":87,"shelf-pack":152}],70:[function(t,e,n){"use strict";var i=t("../util/util"),r=t("../util/interpolate"),o=t("../util/browser"),a=t("../geo/lng_lat"),s=t("../geo/lng_lat_bounds"),u=t("point-geometry"),l=e.exports=function(){};i.extend(l.prototype,{getCenter:function(){return this.transform.center},setCenter:function(t,e){return this.jumpTo({center:t},e),this},panBy:function(t,e,n){return this.panTo(this.transform.center,i.extend({offset:u.convert(t).mult(-1)},e),n),this},panTo:function(t,e,n){return this.easeTo(i.extend({center:t},e),n)},getZoom:function(){return this.transform.zoom},setZoom:function(t,e){return this.jumpTo({zoom:t},e),this},zoomTo:function(t,e,n){return this.easeTo(i.extend({zoom:t},e),n)},zoomIn:function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},zoomOut:function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},getBearing:function(){return this.transform.bearing},setBearing:function(t,e){return this.jumpTo({bearing:t},e),this},rotateTo:function(t,e,n){return this.easeTo(i.extend({bearing:t},e),n)},resetNorth:function(t,e){return this.rotateTo(0,i.extend({duration:1e3},t),e),this},snapToNorth:function(t,e){return Math.abs(this.getBearing())<this.options.bearingSnap?this.resetNorth(t,e):this},getPitch:function(){return this.transform.pitch},setPitch:function(t,e){return this.jumpTo({pitch:t},e),this},fitBounds:function(t,e,n){e=i.extend({padding:0,offset:[0,0],maxZoom:1/0},e),t=s.convert(t);var r=u.convert(e.offset),o=this.transform,a=o.project(t.getNorthWest()),l=o.project(t.getSouthEast()),c=l.sub(a),h=(o.width-2*e.padding-2*Math.abs(r.x))/c.x,f=(o.height-2*e.padding-2*Math.abs(r.y))/c.y;return e.center=o.unproject(a.add(l).div(2)),e.zoom=Math.min(o.scaleZoom(o.scale*Math.min(h,f)),e.maxZoom),e.bearing=0,e.linear?this.easeTo(e,n):this.flyTo(e,n)},jumpTo:function(t,e){this.stop();var n=this.transform,i=!1,r=!1,o=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(i=!0,n.zoom=+t.zoom),"center"in t&&(n.center=a.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(r=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(o=!0,n.pitch=+t.pitch),this.fire("movestart",e).fire("move",e),i&&this.fire("zoomstart",e).fire("zoom",e).fire("zoomend",e),r&&this.fire("rotate",e),o&&this.fire("pitch",e),this.fire("moveend",e)},easeTo:function(t,e){this.stop(),t=i.extend({offset:[0,0],duration:500,easing:i.ease},t);var n,o,s=this.transform,l=u.convert(t.offset),c=this.getZoom(),h=this.getBearing(),f=this.getPitch(),d="zoom"in t?+t.zoom:c,p="bearing"in t?this._normalizeBearing(t.bearing,h):h,m="pitch"in t?+t.pitch:f;"center"in t?(n=a.convert(t.center),o=s.centerPoint.add(l)):"around"in t?(n=a.convert(t.around),o=s.locationPoint(n)):(o=s.centerPoint.add(l),n=s.pointLocation(o));var v=s.locationPoint(n);return t.animate===!1&&(t.duration=0),this.zooming=d!==c,this.rotating=h!==p,this.pitching=m!==f,t.noMoveStart||this.fire("movestart",e),this.zooming&&this.fire("zoomstart",e),clearTimeout(this._onEaseEnd),this._ease(function(t){this.zooming&&(s.zoom=r(c,d,t)),this.rotating&&(s.bearing=r(h,p,t)),this.pitching&&(s.pitch=r(f,m,t)),s.setLocationAtPoint(n,v.add(o.sub(v)._mult(t))),this.fire("move",e),this.zooming&&this.fire("zoom",e),this.rotating&&this.fire("rotate",e),this.pitching&&this.fire("pitch",e)},function(){t.delayEndEvents?this._onEaseEnd=setTimeout(this._easeToEnd.bind(this,e),t.delayEndEvents):this._easeToEnd(e)}.bind(this),t),this},_easeToEnd:function(t){this.zooming&&this.fire("zoomend",t),this.fire("moveend",t),this.zooming=!1,this.rotating=!1,this.pitching=!1},flyTo:function(t,e){function n(t){var e=(E*E-M*M+(t?-1:1)*z*z*T*T)/(2*(t?E:M)*z*T);return Math.log(Math.sqrt(e*e+1)-e)}function o(t){return(Math.exp(t)-Math.exp(-t))/2}function s(t){return(Math.exp(t)+Math.exp(-t))/2}function l(t){return o(t)/s(t)}this.stop(),t=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},t);var c=this.transform,h=u.convert(t.offset),f=this.getZoom(),d=this.getBearing(),p=this.getPitch(),m="center"in t?a.convert(t.center):this.getCenter(),v="zoom"in t?+t.zoom:f,y="bearing"in t?this._normalizeBearing(t.bearing,d):d,g="pitch"in t?+t.pitch:p;Math.abs(c.center.lng)+Math.abs(m.lng)>180&&(c.center.lng>0&&m.lng<0?m.lng+=360:c.center.lng<0&&m.lng>0&&(m.lng-=360));var _=c.zoomScale(v-f),x=c.point,b="center"in t?c.project(m).sub(h.div(_)):x,w=c.worldSize,S=t.curve,M=Math.max(c.width,c.height),E=M/_,T=b.sub(x).mag();if("minZoom"in t){var D=i.clamp(Math.min(t.minZoom,f,v),c.minZoom,c.maxZoom),I=M/c.zoomScale(D-f);S=Math.sqrt(I/T*2)}var z=S*S,A=n(0),k=function(t){return s(A)/s(A+S*t)},L=function(t){return M*((s(A)*l(A+S*t)-o(A))/z)/T},C=(n(1)-A)/S;if(Math.abs(T)<1e-6){if(Math.abs(M-E)<1e-6)return this.easeTo(t);var P=M>E?-1:1;C=Math.abs(Math.log(E/M))/S,L=function(){return 0},k=function(t){return Math.exp(P*S*t)}}if("duration"in t)t.duration=+t.duration;else{var F="screenSpeed"in t?+t.screenSpeed/S:+t.speed;t.duration=1e3*C/F}return this.zooming=!0,d!==y&&(this.rotating=!0),p!==g&&(this.pitching=!0),this.fire("movestart",e),this.fire("zoomstart",e),this._ease(function(t){var n=t*C,i=L(n);c.zoom=f+c.scaleZoom(1/k(n)),c.center=c.unproject(x.add(b.sub(x).mult(i)),w),this.rotating&&(c.bearing=r(d,y,t)),this.pitching&&(c.pitch=r(p,g,t)),this.fire("move",e),this.fire("zoom",e),this.rotating&&this.fire("rotate",e),this.pitching&&this.fire("pitch",e)},function(){this.fire("zoomend",e),this.fire("moveend",e),this.zooming=!1,this.rotating=!1,this.pitching=!1},t),this},isEasing:function(){return!!this._abortFn},stop:function(){return this._abortFn&&(this._abortFn(),this._finishEase()),this},_ease:function(t,e,n){this._finishFn=e,this._abortFn=o.timed(function(e){t.call(this,n.easing(e)),1===e&&this._finishEase()},n.animate===!1?0:n.duration,this)},_finishEase:function(){delete this._abortFn;var t=this._finishFn;delete this._finishFn,t.call(this)},_normalizeBearing:function(t,e){t=i.wrap(t,-180,180);var n=Math.abs(t-e);return Math.abs(t-360-e)<n&&(t-=360),Math.abs(t+360-e)<n&&(t+=360),t},_updateEasing:function(t,e,n){var r;if(this.ease){var o=this.ease,a=(Date.now()-o.start)/o.duration,s=o.easing(a+.01)-o.easing(a),u=.27/Math.sqrt(s*s+1e-4)*.01,l=Math.sqrt(.0729-u*u);r=i.bezier(u,l,.25,1)}else r=n?i.bezier.apply(i,n):i.ease;return this.ease={start:(new Date).getTime(),to:Math.pow(2,e),duration:t,easing:r},r}})},{"../geo/lng_lat":10,"../geo/lng_lat_bounds":11,"../util/browser":87,"../util/interpolate":94,"../util/util":98,"point-geometry":148}],71:[function(t,e,n){"use strict";function i(t){a.setOptions(this,t)}var r=t("./control"),o=t("../../util/dom"),a=t("../../util/util");e.exports=i,i.prototype=a.inherit(r,{options:{position:"bottom-right"},onAdd:function(t){var e="mapboxgl-ctrl-attrib",n=this._container=o.create("div",e,t.getContainer());return this._update(),t.on("source.load",this._update.bind(this)),t.on("source.change",this._update.bind(this)),t.on("source.remove",this._update.bind(this)),t.on("moveend",this._updateEditLink.bind(this)),n},_update:function(){var t=[];if(this._map.style)for(var e in this._map.style.sources){var n=this._map.style.sources[e];n.attribution&&t.indexOf(n.attribution)<0&&t.push(n.attribution)}this._container.innerHTML=t.join(" | "),this._editLink=this._container.getElementsByClassName("mapbox-improve-map")[0],this._updateEditLink()},_updateEditLink:function(){if(this._editLink){var t=this._map.getCenter();this._editLink.href="https://www.mapbox.com/map-feedback/#/"+t.lng+"/"+t.lat+"/"+Math.round(this._map.getZoom()+1)}}})},{"../../util/dom":90,"../../util/util":98,"./control":72}],72:[function(t,e,n){"use strict";function i(){}e.exports=i,i.prototype={addTo:function(t){this._map=t;var e=this._container=this.onAdd(t);if(this.options&&this.options.position){var n=this.options.position,i=t._controlCorners[n];e.className+=" mapboxgl-ctrl",
-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e)}return this},remove:function(){return this._container.parentNode.removeChild(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this}}},{}],73:[function(t,e,n){"use strict";function i(t){s.setOptions(this,t)}function r(t){return new MouseEvent(t.type,{button:2,buttons:2,bubbles:!0,cancelable:!0,detail:t.detail,view:t.view,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,movementX:t.movementX,movementY:t.movementY,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,altKey:t.altKey,metaKey:t.metaKey})}var o=t("./control"),a=t("../../util/dom"),s=t("../../util/util");e.exports=i,i.prototype=s.inherit(o,{options:{position:"top-right"},onAdd:function(t){var e="mapboxgl-ctrl",n=this._container=a.create("div",e+"-group",t.getContainer());return this._container.addEventListener("contextmenu",this._onContextMenu.bind(this)),this._zoomInButton=this._createButton(e+"-icon "+e+"-zoom-in",t.zoomIn.bind(t)),this._zoomOutButton=this._createButton(e+"-icon "+e+"-zoom-out",t.zoomOut.bind(t)),this._compass=this._createButton(e+"-icon "+e+"-compass",t.resetNorth.bind(t)),this._compassArrow=a.create("div","arrow",this._compass),this._compass.addEventListener("mousedown",this._onCompassDown.bind(this)),this._onCompassMove=this._onCompassMove.bind(this),this._onCompassUp=this._onCompassUp.bind(this),t.on("rotate",this._rotateCompassArrow.bind(this)),this._rotateCompassArrow(),this._el=t.getCanvasContainer(),n},_onContextMenu:function(t){t.preventDefault()},_onCompassDown:function(t){0===t.button&&(a.disableDrag(),document.addEventListener("mousemove",this._onCompassMove),document.addEventListener("mouseup",this._onCompassUp),this._el.dispatchEvent(r(t)),t.stopPropagation())},_onCompassMove:function(t){0===t.button&&(this._el.dispatchEvent(r(t)),t.stopPropagation())},_onCompassUp:function(t){0===t.button&&(document.removeEventListener("mousemove",this._onCompassMove),document.removeEventListener("mouseup",this._onCompassUp),a.enableDrag(),this._el.dispatchEvent(r(t)),t.stopPropagation())},_createButton:function(t,e){var n=a.create("button",t,this._container);return n.addEventListener("click",function(){e()}),n},_rotateCompassArrow:function(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t}})},{"../../util/dom":90,"../../util/util":98,"./control":72}],74:[function(t,e,n){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),a.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../geo/lng_lat_bounds"),a=t("../../util/util");e.exports=i,i.prototype={_enabled:!1,_active:!1,isEnabled:function(){return this._enabled},isActive:function(){return this._active},enable:function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onMouseDown,!1),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onMouseDown),this._enabled=!1)},_onMouseDown:function(t){t.shiftKey&&0===t.button&&(document.addEventListener("mousemove",this._onMouseMove,!1),document.addEventListener("keydown",this._onKeyDown,!1),document.addEventListener("mouseup",this._onMouseUp,!1),r.disableDrag(),this._startPos=r.mousePos(this._el,t),this._active=!0)},_onMouseMove:function(t){var e=this._startPos,n=r.mousePos(this._el,t);this._box||(this._box=r.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var i=Math.min(e.x,n.x),o=Math.max(e.x,n.x),a=Math.min(e.y,n.y),s=Math.max(e.y,n.y);r.setTransform(this._box,"translate("+i+"px,"+a+"px)"),this._box.style.width=o-i+"px",this._box.style.height=s-a+"px"},_onMouseUp:function(t){if(0===t.button){var e=this._startPos,n=r.mousePos(this._el,t),i=new o(this._map.unproject(e),this._map.unproject(n));this._finish(),e.x===n.x&&e.y===n.y?this._fireEvent("boxzoomcancel",t):this._map.fitBounds(i,{linear:!0}).fire("boxzoomend",{originalEvent:t,boxZoomBounds:i})}},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},_finish:function(){this._active=!1,document.removeEventListener("mousemove",this._onMouseMove,!1),document.removeEventListener("keydown",this._onKeyDown,!1),document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.parentNode.removeChild(this._box),this._box=null),r.enableDrag()},_fireEvent:function(t,e){return this._map.fire(t,{originalEvent:e})}}},{"../../geo/lng_lat_bounds":11,"../../util/dom":90,"../../util/util":98}],75:[function(t,e,n){"use strict";function i(t){this._map=t,this._onDblClick=this._onDblClick.bind(this)}e.exports=i,i.prototype={_enabled:!1,isEnabled:function(){return this._enabled},enable:function(){this.isEnabled()||(this._map.on("dblclick",this._onDblClick),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._map.off("dblclick",this._onDblClick),this._enabled=!1)},_onDblClick:function(t){this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat})}}},{}],76:[function(t,e,n){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),o.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../util/util");e.exports=i;var a=.3,s=o.bezier(0,0,a,1),u=1400,l=2500;i.prototype={_enabled:!1,_active:!1,isEnabled:function(){return this._enabled},isActive:function(){return this._active},enable:function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onDown),this._el.addEventListener("touchstart",this._onDown),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown),this._enabled=!1)},_onDown:function(t){this._ignoreEvent(t)||this.isActive()||(t.touches?(document.addEventListener("touchmove",this._onMove),document.addEventListener("touchend",this._onTouchEnd)):(document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onMouseUp)),this._active=!1,this._startPos=this._pos=r.mousePos(this._el,t),this._inertia=[[Date.now(),this._pos]])},_onMove:function(t){if(!this._ignoreEvent(t)){this.isActive()||(this._active=!0,this._fireEvent("dragstart",t),this._fireEvent("movestart",t));var e=r.mousePos(this._el,t),n=this._map;n.stop(),this._drainInertiaBuffer(),this._inertia.push([Date.now(),e]),n.transform.setLocationAtPoint(n.transform.pointLocation(this._pos),e),this._fireEvent("drag",t),this._fireEvent("move",t),this._pos=e,t.preventDefault()}},_onUp:function(t){if(this.isActive()){this._active=!1,this._fireEvent("dragend",t),this._drainInertiaBuffer();var e=function(){this._fireEvent("moveend",t)}.bind(this),n=this._inertia;if(n.length<2)return void e();var i=n[n.length-1],r=n[0],o=i[1].sub(r[1]),c=(i[0]-r[0])/1e3;if(0===c||i[1].equals(r[1]))return void e();var h=o.mult(a/c),f=h.mag();f>u&&(f=u,h._unit()._mult(f));var d=f/(l*a),p=h.mult(-d/2);this._map.panBy(p,{duration:1e3*d,easing:s,noMoveStart:!0},{originalEvent:t})}},_onMouseUp:function(t){this._ignoreEvent(t)||(this._onUp(t),document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onMouseUp))},_onTouchEnd:function(t){this._ignoreEvent(t)||(this._onUp(t),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd))},_fireEvent:function(t,e){return this._map.fire(t,{originalEvent:e})},_ignoreEvent:function(t){var e=this._map;if(e.boxZoom&&e.boxZoom.isActive())return!0;if(e.dragRotate&&e.dragRotate.isActive())return!0;if(t.touches)return t.touches.length>1;if(t.ctrlKey)return!0;var n=1,i=0;return"mousemove"===t.type?t.buttons&0===n:t.button!==i},_drainInertiaBuffer:function(){for(var t=this._inertia,e=Date.now(),n=160;t.length>0&&e-t[0][0]>n;)t.shift()}}},{"../../util/dom":90,"../../util/util":98}],77:[function(t,e,n){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),a.bindHandlers(this)}var r=t("../../util/dom"),o=t("point-geometry"),a=t("../../util/util");e.exports=i;var s=.25,u=a.bezier(0,0,s,1),l=180,c=720;i.prototype={_enabled:!1,_active:!1,isEnabled:function(){return this._enabled},isActive:function(){return this._active},enable:function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onDown),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onDown),this._enabled=!1)},_onDown:function(t){if(!this._ignoreEvent(t)&&!this.isActive()){document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onUp),this._active=!1,this._inertia=[[Date.now(),this._map.getBearing()]],this._startPos=this._pos=r.mousePos(this._el,t),this._center=this._map.transform.centerPoint;var e=this._startPos.sub(this._center),n=e.mag();200>n&&(this._center=this._startPos.add(new o(-200,0)._rotate(e.angle()))),t.preventDefault()}},_onMove:function(t){if(!this._ignoreEvent(t)){this.isActive()||(this._active=!0,this._fireEvent("rotatestart",t),this._fireEvent("movestart",t));var e=this._map;e.stop();var n=this._pos,i=r.mousePos(this._el,t),o=this._center,a=n.sub(o).angleWith(i.sub(o))/Math.PI*180,s=e.getBearing()-a,u=this._inertia,l=u[u.length-1];this._drainInertiaBuffer(),u.push([Date.now(),e._normalizeBearing(s,l[1])]),e.transform.bearing=s,this._fireEvent("rotate",t),this._fireEvent("move",t),this._pos=i}},_onUp:function(t){if(!this._ignoreEvent(t)&&(document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onUp),this.isActive())){this._active=!1,this._fireEvent("rotateend",t),this._drainInertiaBuffer();var e=this._map,n=e.getBearing(),i=this._inertia,r=function(){Math.abs(n)<e.options.bearingSnap?e.resetNorth({noMoveStart:!0},{originalEvent:t}):this._fireEvent("moveend",t)}.bind(this);if(i.length<2)return void r();var o=i[0],a=i[i.length-1],h=i[i.length-2],f=e._normalizeBearing(n,h[1]),d=a[1]-o[1],p=0>d?-1:1,m=(a[0]-o[0])/1e3;if(0===d||0===m)return void r();var v=Math.abs(d*(s/m));v>l&&(v=l);var y=v/(c*s),g=p*v*(y/2);f+=g,Math.abs(e._normalizeBearing(f,0))<e.options.bearingSnap&&(f=e._normalizeBearing(0,f)),e.rotateTo(f,{duration:1e3*y,easing:u,noMoveStart:!0},{originalEvent:t})}},_fireEvent:function(t,e){return this._map.fire(t,{originalEvent:e})},_ignoreEvent:function(t){var e=this._map;if(e.boxZoom&&e.boxZoom.isActive())return!0;if(e.dragPan&&e.dragPan.isActive())return!0;if(t.touches)return t.touches.length>1;var n=t.ctrlKey?1:2,i=t.ctrlKey?0:2;return"mousemove"===t.type?t.buttons&0===n:t.button!==i},_drainInertiaBuffer:function(){for(var t=this._inertia,e=Date.now(),n=160;t.length>0&&e-t[0][0]>n;)t.shift()}}},{"../../util/dom":90,"../../util/util":98,"point-geometry":148}],78:[function(t,e,n){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),this._onKeyDown=this._onKeyDown.bind(this)}e.exports=i;var r=80,o=2,a=5;i.prototype={_enabled:!1,isEnabled:function(){return this._enabled},enable:function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=this._map,n={originalEvent:t};switch(t.keyCode){case 61:case 107:case 171:case 187:e.zoomTo(Math.round(e.getZoom())+(t.shiftKey?2:1),n);break;case 189:case 109:case 173:e.zoomTo(Math.round(e.getZoom())-(t.shiftKey?2:1),n);break;case 37:t.shiftKey?e.easeTo({bearing:e.getBearing()-o},n):e.panBy([-r,0],n);break;case 39:t.shiftKey?e.easeTo({bearing:e.getBearing()+o},n):e.panBy([r,0],n);break;case 38:t.shiftKey?e.easeTo({pitch:e.getPitch()+a},n):e.panBy([0,-r],n);break;case 40:t.shiftKey?e.easeTo({pitch:Math.max(e.getPitch()-a,0)},n):e.panBy([0,r],n)}}}}},{}],79:[function(t,e,n){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),a.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../util/browser"),a=t("../../util/util");e.exports=i;var s="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",u=-1!==s.indexOf("firefox"),l=-1!==s.indexOf("safari")&&-1===s.indexOf("chrom");i.prototype={_enabled:!1,isEnabled:function(){return this._enabled},enable:function(){this.isEnabled()||(this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",this._onWheel,!1),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel),this._enabled=!1)},_onWheel:function(t){var e;"wheel"===t.type?(e=t.deltaY,u&&t.deltaMode===window.WheelEvent.DOM_DELTA_PIXEL&&(e/=o.devicePixelRatio),t.deltaMode===window.WheelEvent.DOM_DELTA_LINE&&(e*=40)):"mousewheel"===t.type&&(e=-t.wheelDeltaY,l&&(e/=3));var n=o.now(),i=n-(this._time||0);this._pos=r.mousePos(this._el,t),this._time=n,0!==e&&e%4.000244140625===0?(this._type="wheel",e=Math.floor(e/4)):0!==e&&Math.abs(e)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40)):this._type||(this._type=Math.abs(i*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&this._zoom(-e,t),t.preventDefault()},_onTimeout:function(){this._type="wheel",this._zoom(-this._lastValue)},_zoom:function(t,e){if(0!==t){var n=this._map,i=2/(1+Math.exp(-Math.abs(t/100)));0>t&&0!==i&&(i=1/i);var r=n.ease?n.ease.to:n.transform.scale,o=n.transform.scaleZoom(r*i);n.zoomTo(o,{duration:0,around:n.unproject(this._pos),delayEndEvents:200},{originalEvent:e})}}}},{"../../util/browser":87,"../../util/dom":90,"../../util/util":98}],80:[function(t,e,n){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),o.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../util/util");e.exports=i;var a=.15,s=o.bezier(0,0,a,1),u=12,l=2.5,c=.15,h=4;i.prototype={_enabled:!1,isEnabled:function(){return this._enabled},enable:function(){this.isEnabled()||(this._el.addEventListener("touchstart",this._onStart,!1),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("touchstart",this._onStart),this._enabled=!1)},disableRotation:function(){this._rotationDisabled=!0},enableRotation:function(){this._rotationDisabled=!1},_onStart:function(t){if(2===t.touches.length){var e=r.mousePos(this._el,t.touches[0]),n=r.mousePos(this._el,t.touches[1]);this._startVec=e.sub(n),this._startScale=this._map.transform.scale,this._startBearing=this._map.transform.bearing,this._gestureIntent=void 0,this._inertia=[],document.addEventListener("touchmove",this._onMove,!1),document.addEventListener("touchend",this._onEnd,!1)}},_onMove:function(t){if(2===t.touches.length){var e=r.mousePos(this._el,t.touches[0]),n=r.mousePos(this._el,t.touches[1]),i=e.add(n).div(2),o=e.sub(n),a=o.mag()/this._startVec.mag(),s=this._rotationDisabled?0:180*o.angleWith(this._startVec)/Math.PI,u=this._map;if(this._gestureIntent){var l={duration:0,around:u.unproject(i)};"rotate"===this._gestureIntent&&(l.bearing=this._startBearing+s),"zoom"!==this._gestureIntent&&"rotate"!==this._gestureIntent||(l.zoom=u.transform.scaleZoom(this._startScale*a)),u.stop(),this._drainInertiaBuffer(),this._inertia.push([Date.now(),a,i]),u.easeTo(l,{originalEvent:t})}else{var f=Math.abs(1-a)>c,d=Math.abs(s)>h;d?this._gestureIntent="rotate":f&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._startVec=o,this._startScale=u.transform.scale,this._startBearing=u.transform.bearing)}t.preventDefault()}},_onEnd:function(t){document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onEnd),this._drainInertiaBuffer();var e=this._inertia,n=this._map;if(e.length<2)return void n.snapToNorth({},{originalEvent:t});var i=e[e.length-1],r=e[0],o=n.transform.scaleZoom(this._startScale*i[1]),c=n.transform.scaleZoom(this._startScale*r[1]),h=o-c,f=(i[0]-r[0])/1e3,d=i[2];if(0===f||o===c)return void n.snapToNorth({},{originalEvent:t});var p=h*a/f;Math.abs(p)>l&&(p=p>0?l:-l);var m=1e3*Math.abs(p/(u*a)),v=o+p*m/2e3;0>v&&(v=0),n.easeTo({zoom:v,duration:m,easing:s,around:n.unproject(d)},{originalEvent:t})},_drainInertiaBuffer:function(){for(var t=this._inertia,e=Date.now(),n=160;t.length>2&&e-t[0][0]>n;)t.shift()}}},{"../../util/dom":90,"../../util/util":98}],81:[function(t,e,n){"use strict";function i(){r.bindAll(["_onHashChange","_updateHash"],this)}e.exports=i;var r=t("../util/util");i.prototype={addTo:function(t){return this._map=t,window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},remove:function(){return window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),delete this._map,this},_onHashChange:function(){var t=location.hash.replace("#","").split("/");return t.length>=3?(this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:+(t[3]||0)}),!0):!1},_updateHash:function(){var t=this._map.getCenter(),e=this._map.getZoom(),n=this._map.getBearing(),i=Math.max(0,Math.ceil(Math.log(e)/Math.LN2)),r="#"+Math.round(100*e)/100+"/"+t.lat.toFixed(i)+"/"+t.lng.toFixed(i)+(n?"/"+Math.round(10*n)/10:"");window.history.replaceState("","",r)}}},{"../util/util":98}],82:[function(t,e,n){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer();for(var e in r)t[e]=new r[e](t);a.bindHandlers(this)}var r={scrollZoom:t("./handler/scroll_zoom"),boxZoom:t("./handler/box_zoom"),dragRotate:t("./handler/drag_rotate"),dragPan:t("./handler/drag_pan"),keyboard:t("./handler/keyboard"),doubleClickZoom:t("./handler/dblclick_zoom"),touchZoomRotate:t("./handler/touch_zoom_rotate")},o=t("../util/dom"),a=t("../util/util"),s=t("point-geometry");e.exports=i,i.prototype={enable:function(){var t=this._map.options,e=this._el;for(var n in r)t[n]&&this._map[n].enable();e.addEventListener("mousedown",this._onMouseDown,!1),e.addEventListener("mouseup",this._onMouseUp,!1),e.addEventListener("mousemove",this._onMouseMove,!1),e.addEventListener("touchstart",this._onTouchStart,!1),e.addEventListener("touchend",this._onTouchEnd,!1),e.addEventListener("touchmove",this._onTouchMove,!1),e.addEventListener("touchcancel",this._onTouchCancel,!1),e.addEventListener("click",this._onClick,!1),e.addEventListener("dblclick",this._onDblClick,!1),e.addEventListener("contextmenu",this._onContextMenu,!1)},disable:function(){var t=this._map.options,e=this._el;for(var n in r)t[n]&&this._map[n].disable();e.removeEventListener("mousedown",this._onMouseDown),e.removeEventListener("mouseup",this._onMouseUp),e.removeEventListener("mousemove",this._onMouseMove),e.removeEventListener("touchstart",this._onTouchStart),e.removeEventListener("touchend",this._onTouchEnd),e.removeEventListener("touchmove",this._onTouchMove),e.removeEventListener("touchcancel",this._onTouchCancel),e.removeEventListener("click",this._onClick),e.removeEventListener("dblclick",this._onDblClick),e.removeEventListener("contextmenu",this._onContextMenu)},_onMouseDown:function(t){this._map.stop(),this._startPos=o.mousePos(this._el,t),this._fireMouseEvent("mousedown",t)},_onMouseUp:function(t){var e=this._map,n=e.dragRotate&&e.dragRotate.isActive();this._contextMenuEvent&&!n&&this._fireMouseEvent("contextmenu",this._contextMenuEvent),this._contextMenuEvent=null,this._fireMouseEvent("mouseup",t)},_onMouseMove:function(t){var e=this._map,n=this._el;if(!(e.dragPan&&e.dragPan.isActive()||e.dragRotate&&e.dragRotate.isActive())){for(var i=t.toElement||t.target;i&&i!==n;)i=i.parentNode;i===n&&this._fireMouseEvent("mousemove",t)}},_onTouchStart:function(t){this._map.stop(),this._fireTouchEvent("touchstart",t),!t.touches||t.touches.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._fireMouseEvent("dblclick",t)):this._tapped=setTimeout(this._onTouchTimeout,300))},_onTouchMove:function(t){this._fireTouchEvent("touchmove",t)},_onTouchEnd:function(t){this._fireTouchEvent("touchend",t)},_onTouchCancel:function(t){this._fireTouchEvent("touchcancel",t)},_onTouchTimeout:function(){this._tapped=null},_onClick:function(t){var e=o.mousePos(this._el,t);e.equals(this._startPos)&&this._fireMouseEvent("click",t)},_onDblClick:function(t){this._fireMouseEvent("dblclick",t),t.preventDefault()},_onContextMenu:function(t){this._contextMenuEvent=t,t.preventDefault()},_fireMouseEvent:function(t,e){var n=o.mousePos(this._el,e);return this._map.fire(t,{lngLat:this._map.unproject(n),point:n,originalEvent:e})},_fireTouchEvent:function(t,e){var n=o.touchPos(this._el,e),i=n.reduce(function(t,e,n,i){return t.add(e.div(i.length))},new s(0,0));return this._map.fire(t,{lngLat:this._map.unproject(i),point:i,lngLats:n.map(function(t){return this._map.unproject(t)},this),points:n,originalEvent:e})}}},{"../util/dom":90,"../util/util":98,"./handler/box_zoom":74,"./handler/dblclick_zoom":75,"./handler/drag_pan":76,"./handler/drag_rotate":77,"./handler/keyboard":78,"./handler/scroll_zoom":79,"./handler/touch_zoom_rotate":80,"point-geometry":148}],83:[function(t,e,n){"use strict";function i(t){t.parentNode&&t.parentNode.removeChild(t)}var r=t("../util/canvas"),o=t("../util/util"),a=t("../util/browser"),s=t("../util/evented"),u=t("../util/dom"),l=t("../style/style"),c=t("../style/animation_loop"),h=t("../render/painter"),f=t("../geo/transform"),d=t("./hash"),p=t("./interaction"),m=t("./camera"),v=t("../geo/lng_lat"),y=t("../geo/lng_lat_bounds"),g=t("point-geometry"),_=t("./control/attribution"),x=0,b=20,w=e.exports=function(t){t=this.options=o.inherit(this.options,t),this.animationLoop=new c,this.transform=new f(t.minZoom,t.maxZoom),t.maxBounds&&this.setMaxBounds(t.maxBounds),o.bindAll(["_forwardStyleEvent","_forwardSourceEvent","_forwardLayerEvent","_forwardTileEvent","_onStyleLoad","_onStyleChange","_onSourceAdd","_onSourceRemove","_onSourceUpdate","_onWindowResize","onError","_update","_render"],this),this._setupContainer(),this._setupPainter(),this.on("move",this._update.bind(this,!1)),this.on("zoom",this._update.bind(this,!0)),this.on("moveend",function(){this.animationLoop.set(300),this._rerender()}.bind(this)),"undefined"!=typeof window&&window.addEventListener("resize",this._onWindowResize,!1),this.interaction=new p(this),t.interactive&&this.interaction.enable(),this._hash=t.hash&&(new d).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo(t),this.sources={},this.stacks={},this._classes={},this.resize(),t.classes&&this.setClasses(t.classes),t.style&&this.setStyle(t.style),t.attributionControl&&this.addControl(new _(t.attributionControl)),this.on("style.error",this.onError),this.on("source.error",this.onError),this.on("tile.error",this.onError),this.on("layer.error",this.onError)};o.extend(w.prototype,s),o.extend(w.prototype,m.prototype),o.extend(w.prototype,{options:{center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:x,maxZoom:b,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1},addControl:function(t){return t.addTo(this),this},addClass:function(t,e){this._classes[t]||(this._classes[t]=!0,this.style&&this.style._cascade(this._classes,e))},removeClass:function(t,e){this._classes[t]&&(delete this._classes[t],this.style&&this.style._cascade(this._classes,e))},setClasses:function(t,e){this._classes={};for(var n=0;n<t.length;n++)this._classes[t[n]]=!0;this.style&&this.style._cascade(this._classes,e)},hasClass:function(t){return!!this._classes[t]},getClasses:function(){return Object.keys(this._classes)},resize:function(){var t=0,e=0;return this._container&&(t=this._container.offsetWidth||400,e=this._container.offsetHeight||300),this._canvas.resize(t,e),this.transform.resize(t,e),this.painter.resize(t,e),this.fire("movestart").fire("move").fire("resize").fire("moveend")},getBounds:function(){var t=new y(this.transform.pointLocation(new g(0,0)),this.transform.pointLocation(this.transform.size));return(this.transform.angle||this.transform.pitch)&&(t.extend(this.transform.pointLocation(new g(this.transform.size.x,0))),t.extend(this.transform.pointLocation(new g(0,this.transform.size.y)))),t},setMaxBounds:function(t){if(t){var e=y.convert(t);this.transform.lngRange=[e.getWest(),e.getEast()],this.transform.latRange=[e.getSouth(),e.getNorth()],this.transform._constrain(),this._update()}else null!==t&&void 0!==t||(this.transform.lngRange=[],this.transform.latRange=[],this._update());return this},setMinZoom:function(t){if(t=null===t||void 0===t?x:t,t>=x&&t<=this.options.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between "+x+" and the current maxZoom, inclusive")},setMaxZoom:function(t){if(t=null===t||void 0===t?b:t,t>=this.options.minZoom&&b>=t)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be between the current minZoom and "+b+", inclusive")},project:function(t){return this.transform.locationPoint(v.convert(t))},unproject:function(t){return this.transform.pointLocation(g.convert(t))},featuresAt:function(t,e,n){var i=this.unproject(t).wrap(),r=this.transform.locationCoordinate(i);return this.style.featuresAt(r,e,n),this},featuresIn:function(t,e,n){return"undefined"==typeof n&&(n=e,e=t,t=[g.convert([0,0]),g.convert([this.transform.width,this.transform.height])]),t=t.map(g.convert.bind(g)),t=[new g(Math.min(t[0].x,t[1].x),Math.min(t[0].y,t[1].y)),new g(Math.max(t[0].x,t[1].x),Math.max(t[0].y,t[1].y))].map(this.transform.pointCoordinate.bind(this.transform)),this.style.featuresIn(t,e,n),this},batch:function(t){this.style.batch(t),this.style._cascade(this._classes),this._update(!0)},setStyle:function(t){return this.style&&(this.style.off("load",this._onStyleLoad).off("error",this._forwardStyleEvent).off("change",this._onStyleChange).off("source.add",this._onSourceAdd).off("source.remove",this._onSourceRemove).off("source.load",this._onSourceUpdate).off("source.error",this._forwardSourceEvent).off("source.change",this._onSourceUpdate).off("layer.add",this._forwardLayerEvent).off("layer.remove",this._forwardLayerEvent).off("layer.error",this._forwardLayerEvent).off("tile.add",this._forwardTileEvent).off("tile.remove",this._forwardTileEvent).off("tile.load",this._update).off("tile.error",this._forwardTileEvent).off("tile.stats",this._forwardTileEvent)._remove(),this.off("rotate",this.style._redoPlacement),this.off("pitch",this.style._redoPlacement)),t?(t instanceof l?this.style=t:this.style=new l(t,this.animationLoop),this.style.on("load",this._onStyleLoad).on("error",this._forwardStyleEvent).on("change",this._onStyleChange).on("source.add",this._onSourceAdd).on("source.remove",this._onSourceRemove).on("source.load",this._onSourceUpdate).on("source.error",this._forwardSourceEvent).on("source.change",this._onSourceUpdate).on("layer.add",this._forwardLayerEvent).on("layer.remove",this._forwardLayerEvent).on("layer.error",this._forwardLayerEvent).on("tile.add",this._forwardTileEvent).on("tile.remove",this._forwardTileEvent).on("tile.load",this._update).on("tile.error",this._forwardTileEvent).on("tile.stats",this._forwardTileEvent),this.on("rotate",this.style._redoPlacement),this.on("pitch",this.style._redoPlacement),this):(this.style=null,this)},getStyle:function(){return this.style.serialize()},addSource:function(t,e){return this.style.addSource(t,e),this},removeSource:function(t){return this.style.removeSource(t),this},getSource:function(t){return this.style.getSource(t)},addLayer:function(t,e){return this.style.addLayer(t,e),this.style._cascade(this._classes),this},removeLayer:function(t){return this.style.removeLayer(t),this.style._cascade(this._classes),this},getLayer:function(t){return this.style.getLayer(t)},setFilter:function(t,e){return this.style.setFilter(t,e),this},setLayerZoomRange:function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this},getFilter:function(t){return this.style.getFilter(t)},setPaintProperty:function(t,e,n,i){return this.batch(function(r){r.setPaintProperty(t,e,n,i)}),this},getPaintProperty:function(t,e,n){return this.style.getPaintProperty(t,e,n)},setLayoutProperty:function(t,e,n){return this.batch(function(i){i.setLayoutProperty(t,e,n)}),this},getLayoutProperty:function(t,e){return this.style.getLayoutProperty(t,e)},getContainer:function(){return this._container},getCanvasContainer:function(){return this._canvasContainer},getCanvas:function(){return this._canvas.getElement()},_setupContainer:function(){var t=this.options.container,e=this._container="string"==typeof t?document.getElementById(t):t;e.classList.add("mapboxgl-map");var n=this._canvasContainer=u.create("div","mapboxgl-canvas-container",e);this.options.interactive&&n.classList.add("mapboxgl-interactive"),this._canvas=new r(this,n);var i=this._controlContainer=u.create("div","mapboxgl-control-container",e),o=this._controlCorners={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){o[t]=u.create("div","mapboxgl-ctrl-"+t,i)})},_setupPainter:function(){var t=this._canvas.getWebGLContext({failIfMajorPerformanceCaveat:this.options.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.options.preserveDrawingBuffer});return t?void(this.painter=new h(t,this.transform)):void console.error("Failed to initialize WebGL")},_contextLost:function(t){t.preventDefault(),this._frameId&&a.cancelFrame(this._frameId),this.fire("webglcontextlost",{originalEvent:t})},_contextRestored:function(t){this._setupPainter(),this.resize(),this._update(),this.fire("webglcontextrestored",{originalEvent:t})},loaded:function(){return this._styleDirty||this._sourcesDirty?!1:!(!this.style||!this.style.loaded())},_update:function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this._rerender(),this):this},_render:function(){return this.style&&this._styleDirty&&(this._styleDirty=!1,this.style._recalculate(this.transform.zoom)),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.painter.render(this.style,{debug:this.tileDebug,vertices:this.vertices,rotating:this.rotating,zooming:this.zooming}),this.fire("render"),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load")),this._frameId=null,this.animationLoop.stopped()||(this._styleDirty=!0),(this._sourcesDirty||this._repaint||!this.animationLoop.stopped())&&this._rerender(),this},remove:function(){this._hash&&this._hash.remove(),a.cancelFrame(this._frameId),this.setStyle(null),"undefined"!=typeof window&&window.removeEventListener("resize",this._onWindowResize,!1),i(this._canvasContainer),i(this._controlContainer),this._container.classList.remove("mapboxgl-map")},onError:function(t){console.error(t.error)},_rerender:function(){this.style&&!this._frameId&&(this._frameId=a.frame(this._render))},_forwardStyleEvent:function(t){this.fire("style."+t.type,o.extend({style:t.target},t))},_forwardSourceEvent:function(t){this.fire(t.type,o.extend({style:t.target},t))},_forwardLayerEvent:function(t){this.fire(t.type,o.extend({style:t.target},t))},_forwardTileEvent:function(t){this.fire(t.type,o.extend({style:t.target},t))},_onStyleLoad:function(t){this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this.style._cascade(this._classes,{transition:!1}),this._forwardStyleEvent(t)},_onStyleChange:function(t){this._update(!0),this._forwardStyleEvent(t)},_onSourceAdd:function(t){var e=t.source;e.onAdd&&e.onAdd(this),this._forwardSourceEvent(t)},_onSourceRemove:function(t){var e=t.source;e.onRemove&&e.onRemove(this),this._forwardSourceEvent(t)},_onSourceUpdate:function(t){this._update(),this._forwardSourceEvent(t)},_onWindowResize:function(){this.stop().resize()._update()}}),o.extendAll(w.prototype,{_tileDebug:!1,get tileDebug(){return this._tileDebug},set tileDebug(t){this._tileDebug!==t&&(this._tileDebug=t,this._update());
},_collisionDebug:!1,get collisionDebug(){return this._collisionDebug},set collisionDebug(t){this._collisionDebug!==t&&(this._collisionDebug=t,this.style._redoPlacement())},_repaint:!1,get repaint(){return this._repaint},set repaint(t){this._repaint=t,this._update()},_vertices:!1,get vertices(){return this._vertices},set vertices(t){this._vertices=t,this._update()}})},{"../geo/lng_lat":10,"../geo/lng_lat_bounds":11,"../geo/transform":12,"../render/painter":26,"../style/animation_loop":40,"../style/style":43,"../util/browser":87,"../util/canvas":88,"../util/dom":90,"../util/evented":92,"../util/util":98,"./camera":70,"./control/attribution":71,"./hash":81,"./interaction":82,"point-geometry":148}],84:[function(t,e,n){"use strict";function i(t){r.setOptions(this,t),r.bindAll(["_update","_onClickClose"],this)}e.exports=i;var r=t("../util/util"),o=t("../util/evented"),a=t("../util/dom"),s=t("../geo/lng_lat");i.prototype=r.inherit(o,{options:{closeButton:!0,closeOnClick:!0},addTo:function(t){return this._map=t,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this},remove:function(){return this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content),this._container&&(this._container.parentNode.removeChild(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this},getLngLat:function(){return this._lngLat},setLngLat:function(t){return this._lngLat=s.convert(t),this._update(),this},setText:function(t){return this._createContent(),this._content.appendChild(document.createTextNode(t)),this._update(),this},setHTML:function(t){this._createContent();var e,n=document.createElement("body");for(n.innerHTML=t;e=n.firstChild,e;)this._content.appendChild(e);return this._update(),this},_createContent:function(){this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content),this._content=a.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=a.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},_update:function(){if(this._map&&this._lngLat&&this._content){this._container||(this._container=a.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=a.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content));var t=this._map.project(this._lngLat).round(),e=this.options.anchor;if(!e){var n=this._container.offsetWidth,i=this._container.offsetHeight;e=t.y<i?["top"]:t.y>this._map.transform.height-i?["bottom"]:[],t.x<n/2?e.push("left"):t.x>this._map.transform.width-n/2&&e.push("right"),e=0===e.length?"bottom":e.join("-")}var r={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},o=this._container.classList;for(var s in r)o.remove("mapboxgl-popup-anchor-"+s);o.add("mapboxgl-popup-anchor-"+e),a.setTransform(this._container,r[e]+" translate("+t.x+"px,"+t.y+"px)")}},_onClickClose:function(){this.remove()}})},{"../geo/lng_lat":10,"../util/dom":90,"../util/evented":92,"../util/util":98}],85:[function(t,e,n){"use strict";function i(t,e){this.target=t,this.parent=e,this.callbacks={},this.callbackID=0,this.receive=this.receive.bind(this),this.target.addEventListener("message",this.receive,!1)}e.exports=i,i.prototype.receive=function(t){var e,n=t.data;if("<response>"===n.type)e=this.callbacks[n.id],delete this.callbacks[n.id],e(n.error||null,n.data);else if("undefined"!=typeof n.id){var i=n.id;this.parent[n.type](n.data,function(t,e,n){this.postMessage({type:"<response>",id:String(i),error:t?String(t):null,data:e},n)}.bind(this))}else this.parent[n.type](n.data)},i.prototype.send=function(t,e,n,i){var r=null;n&&(this.callbacks[r=this.callbackID++]=n),this.postMessage({type:t,id:String(r),data:e},i)},i.prototype.postMessage=function(t,e){this.target.postMessage(t,e)}},{}],86:[function(t,e,n){"use strict";function i(t){var e=document.createElement("a");return e.href=t,e.protocol===document.location.protocol&&e.host===document.location.host}n.getJSON=function(t,e){var n=new XMLHttpRequest;return n.open("GET",t,!0),n.setRequestHeader("Accept","application/json"),n.onerror=function(t){e(t)},n.onload=function(){if(n.status>=200&&n.status<300&&n.response){var t;try{t=JSON.parse(n.response)}catch(i){return e(i)}e(null,t)}else e(new Error(n.statusText))},n.send(),n},n.getArrayBuffer=function(t,e){var n=new XMLHttpRequest;return n.open("GET",t,!0),n.responseType="arraybuffer",n.onerror=function(t){e(t)},n.onload=function(){n.status>=200&&n.status<300&&n.response?e(null,n.response):e(new Error(n.statusText))},n.send(),n},n.getImage=function(t,e){return n.getArrayBuffer(t,function(t,n){if(t)return e(t);var i=new Image;i.onload=function(){e(null,i),(window.URL||window.webkitURL).revokeObjectURL(i.src)};var r=new Blob([new Uint8Array(n)],{type:"image/png"});return i.src=(window.URL||window.webkitURL).createObjectURL(r),i.getData=function(){var t=document.createElement("canvas"),e=t.getContext("2d");return t.width=i.width,t.height=i.height,e.drawImage(i,0,0),e.getImageData(0,0,i.width,i.height).data},i})},n.getVideo=function(t,e){var n=document.createElement("video");n.onloadstart=function(){e(null,n)};for(var r=0;r<t.length;r++){var o=document.createElement("source");i(t[r])||(n.crossOrigin="Anonymous"),o.src=t[r],n.appendChild(o)}return n.getData=function(){return n},n}},{}],87:[function(t,e,n){"use strict";var i=t("./canvas");e.exports.now=function(){return window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date)}();var r=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;n.frame=function(t){return r(t)};var o=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;n.cancelFrame=function(t){o(t)},n.timed=function(t,i,r){function o(u){a||(u=e.exports.now(),u>=s+i?t.call(r,1):(t.call(r,(u-s)/i),n.frame(o)))}if(!i)return t.call(r,1),null;var a=!1,s=e.exports.now();return n.frame(o),function(){a=!0}},n.supportsWebGL={},n.supported=function(t){for(var e=([function(){return"undefined"!=typeof window},function(){return"undefined"!=typeof document},function(){return!!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)},function(){return!(!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions))},function(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON},function(){var e=t&&t.failIfMajorPerformanceCaveat||!1,r="fimpc_"+String(e);if(void 0===n.supportsWebGL[r]){var o=new i;n.supportsWebGL[r]=o.supportsWebGLContext(e)}return n.supportsWebGL[r]},function(){return"Worker"in window}]),r=0;r<e.length;r++)if(!e[r]())return!1;return!0},n.hardwareConcurrency=navigator.hardwareConcurrency||8,Object.defineProperty(n,"devicePixelRatio",{get:function(){return window.devicePixelRatio}}),n.supportsWebp=!1;var a=document.createElement("img");a.onload=function(){n.supportsWebp=!0},a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="},{"./canvas":88}],88:[function(t,e,n){"use strict";function i(t,e){this.canvas=document.createElement("canvas"),t&&e&&(this.canvas.style.position="absolute",this.canvas.classList.add("mapboxgl-canvas"),this.canvas.addEventListener("webglcontextlost",t._contextLost.bind(t),!1),this.canvas.addEventListener("webglcontextrestored",t._contextRestored.bind(t),!1),this.canvas.setAttribute("tabindex",0),e.appendChild(this.canvas))}var r=t("../util");e.exports=i,i.prototype.resize=function(t,e){var n=window.devicePixelRatio||1;this.canvas.width=n*t,this.canvas.height=n*e,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"};var o={antialias:!1,alpha:!0,stencil:!0,depth:!0};i.prototype.getWebGLContext=function(t){return t=r.extend({},t,o),this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t)},i.prototype.supportsWebGLContext=function(t){var e=r.extend({failIfMajorPerformanceCaveat:t},o);return"probablySupportsContext"in this.canvas?this.canvas.probablySupportsContext("webgl",e)||this.canvas.probablySupportsContext("experimental-webgl",e):"supportsContext"in this.canvas?this.canvas.supportsContext("webgl",e)||this.canvas.supportsContext("experimental-webgl",e):!!window.WebGLRenderingContext&&!!this.getWebGLContext(t)},i.prototype.getElement=function(){return this.canvas}},{"../util":98}],89:[function(t,e,n){"use strict";function i(e,n){this.actors=[],this.currentActor=0;for(var i=0;e>i;i++){var a=new o(t("../../source/worker")),s=new r(a,n);s.name="Worker "+i,this.actors.push(s)}}var r=t("../actor"),o=t("webworkify");e.exports=i,i.prototype={broadcast:function(t,e){for(var n=0;n<this.actors.length;n++)this.actors[n].send(t,e)},send:function(t,e,n,i,r){return("number"!=typeof i||isNaN(i))&&(i=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[i].send(t,e,n,r),i},remove:function(){for(var t=0;t<this.actors.length;t++)this.actors[t].target.terminate();this.actors=[]}}},{"../../source/worker":38,"../actor":85,webworkify:161}],90:[function(t,e,n){"use strict";function i(t){for(var e=0;e<t.length;e++)if(t[e]in s)return t[e]}function r(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",r,!0)}var o=t("point-geometry");n.create=function(t,e,n){var i=document.createElement(t);return e&&(i.className=e),n&&n.appendChild(i),i};var a,s=document.documentElement.style,u=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){u&&(a=s[u],s[u]="none")},n.enableDrag=function(){u&&(s[u]=a)};var l=i(["transform","WebkitTransform"]);n.setTransform=function(t,e){t.style[l]=e},n.suppressClick=function(){window.addEventListener("click",r,!0),window.setTimeout(function(){window.removeEventListener("click",r,!0)},0)},n.mousePos=function(t,e){var n=t.getBoundingClientRect();return e=e.touches?e.touches[0]:e,new o(e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop)},n.touchPos=function(t,e){for(var n=t.getBoundingClientRect(),i=[],r=0;r<e.touches.length;r++)i.push(new o(e.touches[r].clientX-n.left-t.clientLeft,e.touches[r].clientY-n.top-t.clientTop));return i}},{"point-geometry":148}],91:[function(t,e,n){"use strict";e.exports={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0}},{}],92:[function(t,e,n){"use strict";var i=t("./util"),r={on:function(t,e){return this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e),this},off:function(t,e){if(!t)return delete this._events,this;if(!this.listens(t))return this;if(e){var n=this._events[t].indexOf(e);n>=0&&this._events[t].splice(n,1),this._events[t].length||delete this._events[t]}else delete this._events[t];return this},once:function(t,e){var n=function(i){this.off(t,n),e.call(this,i)}.bind(this);return this.on(t,n),this},fire:function(t,e){if(!this.listens(t))return this;e=i.extend({},e),i.extend(e,{type:t,target:this});for(var n=this._events[t].slice(),r=0;r<n.length;r++)n[r].call(this,e);return this},listens:function(t){return!(!this._events||!this._events[t])}};e.exports=r},{"./util":98}],93:[function(t,e,n){"use strict";function i(t,e){this.stacks=t.readFields(r,[],e)}function r(t,e,n){if(1===t){var i=n.readMessage(o,{glyphs:{}});e.push(i)}}function o(t,e,n){if(1===t)e.name=n.readString();else if(2===t)e.range=n.readString();else if(3===t){var i=n.readMessage(a,{});e.glyphs[i.id]=i}}function a(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}e.exports=i},{}],94:[function(t,e,n){"use strict";function i(t,e,n){return t*(1-n)+e*n}e.exports=i,i.number=i,i.vec2=function(t,e,n){return[i(t[0],e[0],n),i(t[1],e[1],n)]},i.color=function(t,e,n){return[i(t[0],e[0],n),i(t[1],e[1],n),i(t[2],e[2],n),i(t[3],e[3],n)]},i.array=function(t,e,n){return t.map(function(t,r){return i(t,e[r],n)})}},{}],95:[function(t,e,n){"use strict";function i(t,e){this.max=t,this.onRemove=e,this.reset()}e.exports=i,i.prototype.reset=function(){for(var t in this.data)this.onRemove(this.data[t]);return this.data={},this.order=[],this},i.prototype.add=function(t,e){if(this.has(t))this.order.splice(this.order.indexOf(t),1),this.data[t]=e,this.order.push(t);else if(this.data[t]=e,this.order.push(t),this.order.length>this.max){var n=this.get(this.order[0]);n&&this.onRemove(n)}return this},i.prototype.has=function(t){return t in this.data},i.prototype.keys=function(){return this.order},i.prototype.get=function(t){if(!this.has(t))return null;var e=this.data[t];return delete this.data[t],this.order.splice(this.order.indexOf(t),1),e},i.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this.get(this.order[0]);e&&this.onRemove(e)}return this}},{}],96:[function(t,e,n){"use strict";function i(t,e,n){if(n=n||r.ACCESS_TOKEN,!n&&r.REQUIRE_ACCESS_TOKEN)throw new Error("An API access token is required to use Mapbox GL. See https://www.mapbox.com/developers/api/#access-tokens");if(t=t.replace(/^mapbox:\/\//,r.API_URL+e),t+=-1!==t.indexOf("?")?"&access_token=":"?access_token=",r.REQUIRE_ACCESS_TOKEN){if("s"===n[0])throw new Error("Use a public access token (pk.*) with Mapbox GL JS, not a secret access token (sk.*). See https://www.mapbox.com/developers/api/#access-tokens");t+=n}return t}var r=t("./config"),o=t("./browser");e.exports.normalizeStyleURL=function(t,e){if(!t.match(/^mapbox:\/\/styles\//))return t;var n=t.split("/"),r=n[3],o=n[4],a=n[5]?"/draft":"";return i("mapbox://"+r+"/"+o+a,"/styles/v1/",e)},e.exports.normalizeSourceURL=function(t,e){return t.match(/^mapbox:\/\//)?i(t+".json","/v4/",e)+"&secure":t},e.exports.normalizeGlyphsURL=function(t,e){if(!t.match(/^mapbox:\/\//))return t;var n=t.split("/")[3];return i("mapbox://"+n+"/{fontstack}/{range}.pbf","/fonts/v1/",e)},e.exports.normalizeSpriteURL=function(t,e,n,r){if(!t.match(/^mapbox:\/\/sprites\//))return t+e+n;var o=t.split("/"),a=o[3],s=o[4],u=o[5]?"/draft":"";return i("mapbox://"+a+"/"+s+u+"/sprite"+e+n,"/styles/v1/",r)},e.exports.normalizeTileURL=function(t,e,n){if(!e||!e.match(/^mapbox:\/\//))return t;t=t.replace(/([?&]access_token=)tk\.[^&]+/,"$1"+r.ACCESS_TOKEN);var i=o.supportsWebp?"webp":"$1";return t.replace(/\.((?:png|jpg)\d*)(?=$|\?)/,o.devicePixelRatio>=2||512===n?"@2x."+i:"."+i)}},{"./browser":87,"./config":91}],97:[function(t,e,n){"use strict";function i(t,e){return e.replace(/{([^{}()\[\]<>$=:;.,^]+)}/g,function(e,n){return n in t?t[n]:""})}e.exports=i},{}],98:[function(t,e,n){"use strict";var i=t("unitbezier"),r=t("../geo/coordinate");n.easeCubicInOut=function(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)},n.bezier=function(t,e,n,r){var o=new i(t,e,n,r);return function(t){return o.solve(t)}},n.ease=n.bezier(.25,.1,.25,1),n.premultiply=function(t,e){if(!t)return null;var n=t[3]*e;return[t[0]*n,t[1]*n,t[2]*n,n]},n.clamp=function(t,e,n){return Math.min(n,Math.max(e,t))},n.wrap=function(t,e,n){var i=n-e,r=((t-e)%i+i)%i+e;return r===e?n:r},n.coalesce=function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];if(null!==e&&void 0!==e)return e}},n.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var i=t.length,r=new Array(t.length),o=null;t.forEach(function(t,a){e(t,function(t,e){t&&(o=t),r[a]=e,0===--i&&n(o,r)})})},n.keysDifference=function(t,e){var n=[];for(var i in t)i in e||n.push(i);return n},n.extend=function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t},n.extendAll=function(t,e){for(var n in e)Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n));return t},n.inherit=function(t,e){var i="function"==typeof t?t.prototype:t,r=Object.create(i);return n.extendAll(r,e),r},n.pick=function(t,e){for(var n={},i=0;i<e.length;i++){var r=e[i];r in t&&(n[r]=t[r])}return n};var o=1;n.uniqueId=function(){return o++},n.throttle=function(t,e,n){var i,r,o,a;return a=function(){i=!1,r&&(o.apply(n,r),r=!1)},o=function(){i?r=arguments:(t.apply(n,arguments),setTimeout(a,e),i=!0)}},n.debounce=function(t,e){var n,i;return function(){i=arguments,clearTimeout(n),n=setTimeout(function(){t.apply(null,i)},e)}},n.bindAll=function(t,e){t.forEach(function(t){e[t]=e[t].bind(e)})},n.bindHandlers=function(t){for(var e in t)"function"==typeof t[e]&&0===e.indexOf("_on")&&(t[e]=t[e].bind(t))},n.setOptions=function(t,e){t.hasOwnProperty("options")||(t.options=t.options?Object.create(t.options):{});for(var n in e)t.options[n]=e[n];return t.options},n.getCoordinatesCenter=function(t){for(var e=1/0,n=1/0,i=-(1/0),o=-(1/0),a=0;a<t.length;a++)e=Math.min(e,t[a].column),n=Math.min(n,t[a].row),i=Math.max(i,t[a].column),o=Math.max(o,t[a].row);var s=i-e,u=o-n,l=Math.max(s,u);return new r((e+i)/2,(n+o)/2,0).zoomTo(Math.floor(-Math.log(l)/Math.LN2))},n.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},n.startsWith=function(t,e){return 0===t.indexOf(e)},n.mapObject=function(t,e,n){var i={};for(var r in t)i[r]=e.call(n||this,t[r],r,t);return i},n.filterObject=function(t,e,n){var i={};for(var r in t)e.call(n||this,t[r],r,t)&&(i[r]=t[r]);return i},n.deepEqual=function a(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!a(t[n],e[n]))return!1;return!0}if("object"==typeof t){if("object"!=typeof e)return!1;var i=Object.keys(t);if(i.length!==Object.keys(e).length)return!1;for(var r in t)if(!a(t[r],e[r]))return!1;return!0}return t===e}},{"../geo/coordinate":9,unitbezier:154}],99:[function(t,e,n){function i(t){return t=Math.round(t),0>t?0:t>255?255:t}function r(t){return 0>t?0:t>1?1:t}function o(t){return i("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function a(t){return r("%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))}function s(t,e,n){return 0>n?n+=1:n>1&&(n-=1),1>6*n?t+(e-t)*n*6:1>2*n?e:2>3*n?t+(e-t)*(2/3-n)*6:t}function u(t){var e=t.replace(/ /g,"").toLowerCase();if(e in l)return l[e].slice();if("#"===e[0]){if(4===e.length){var n=parseInt(e.substr(1),16);return n>=0&&4095>=n?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null}if(7===e.length){var n=parseInt(e.substr(1),16);return n>=0&&16777215>=n?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null}return null}var r=e.indexOf("("),u=e.indexOf(")");if(-1!==r&&u+1===e.length){var c=e.substr(0,r),h=e.substr(r+1,u-(r+1)).split(","),f=1;switch(c){case"rgba":if(4!==h.length)return null;f=a(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),f];case"hsla":if(4!==h.length)return null;f=a(h.pop());case"hsl":if(3!==h.length)return null;var d=(parseFloat(h[0])%360+360)%360/360,p=a(h[1]),m=a(h[2]),v=.5>=m?m*(p+1):m+p-m*p,y=2*m-v;return[i(255*s(y,v,d+1/3)),i(255*s(y,v,d)),i(255*s(y,v,d-1/3)),f];default:return null}}return null}var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{n.parseCSSColor=u}catch(c){}},{}],100:[function(t,e,n){"use strict";function i(t){return new Function("f","return "+r(t))}function r(t){if(!t)return"true";var e=t[0];if(t.length<=1)return"any"===e?"false":"true";var n="=="===e?a(t[1],t[2],"===",!1):"!="===e?a(t[1],t[2],"!==",!1):"<"===e||">"===e||"<="===e||">="===e?a(t[1],t[2],e,!0):"any"===e?t.slice(1).map(r).join("||"):"all"===e?t.slice(1).map(r).join("&&"):"none"===e?"!("+t.slice(1).map(r).join("||")+")":"in"===e?s(t[1],t.slice(2)):"!in"===e?"!("+s(t[1],t.slice(2))+")":"true";return"("+n+")"}function o(t){return"$type"===t?"f.type":"(f.properties || {})["+JSON.stringify(t)+"]"}function a(t,e,n,i){var r=o(t),a="$type"===t?l.indexOf(e):JSON.stringify(e);return(i?"typeof "+r+"=== typeof "+a+"&&":"")+r+n+a}function s(t,e){"$type"===t&&(e=e.map(function(t){return l.indexOf(t)}));var n=JSON.stringify(e.sort(u)),i=o(t);return e.length<=200?n+".indexOf("+i+") !== -1":"function(v, a, i, j) {while (i <= j) { var m = (i + j) >> 1;    if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;}return false; }("+i+", "+n+",0,"+(e.length-1)+")"}function u(t,e){return e>t?-1:t>e?1:0}e.exports=i;var l=["Unknown","Point","LineString","Polygon"]},{}],101:[function(t,e,n){"use strict";function i(t,e,n,i,a,s,u,l){if(n/=e,i/=e,u>=n&&i>=l)return t;if(u>i||n>l)return null;for(var c=[],h=0;h<t.length;h++){var f,d,p=t[h],m=p.geometry,v=p.type;if(f=p.min[a],d=p.max[a],f>=n&&i>=d)c.push(p);else if(!(f>i||n>d)){var y=1===v?r(m,n,i,a):o(m,n,i,a,s,3===v);y.length&&c.push({geometry:y,type:v,tags:t[h].tags||null,min:p.min,max:p.max})}}return c.length?c:null}function r(t,e,n,i){for(var r=[],o=0;o<t.length;o++){var a=t[o],s=a[i];s>=e&&n>=s&&r.push(a)}return r}function o(t,e,n,i,r,o){for(var s=[],u=0;u<t.length;u++){var l,c,h,f=0,d=0,p=null,m=t[u],v=m.area,y=m.dist,g=m.length,_=[];for(c=0;g-1>c;c++)l=p||m[c],p=m[c+1],f=d||l[i],d=p[i],e>f?d>n?(_.push(r(l,p,e),r(l,p,n)),o||(_=a(s,_,v,y))):d>=e&&_.push(r(l,p,e)):f>n?e>d?(_.push(r(l,p,n),r(l,p,e)),o||(_=a(s,_,v,y))):n>=d&&_.push(r(l,p,n)):(_.push(l),e>d?(_.push(r(l,p,e)),o||(_=a(s,_,v,y))):d>n&&(_.push(r(l,p,n)),o||(_=a(s,_,v,y))));l=m[g-1],f=l[i],f>=e&&n>=f&&_.push(l),h=_[_.length-1],o&&h&&(_[0][0]!==h[0]||_[0][1]!==h[1])&&_.push(_[0]),a(s,_,v,y)}return s}function a(t,e,n,i){return e.length&&(e.area=n,e.dist=i,t.push(e)),[]}e.exports=i},{}],102:[function(t,e,n){"use strict";function i(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)r(n,t.features[i],e);else"Feature"===t.type?r(n,t,e):r(n,{geometry:t},e);return n}function r(t,e,n){var i,u,l,c=e.geometry,h=c.type,f=c.coordinates,d=e.properties;if("Point"===h)t.push(o(d,1,[s(f)]));else if("MultiPoint"===h)t.push(o(d,1,a(f)));else if("LineString"===h)t.push(o(d,2,[a(f,n)]));else if("MultiLineString"===h||"Polygon"===h){for(l=[],i=0;i<f.length;i++)l.push(a(f[i],n));t.push(o(d,"Polygon"===h?3:2,l))}else if("MultiPolygon"===h){for(l=[],i=0;i<f.length;i++)for(u=0;u<f[i].length;u++)l.push(a(f[i][u],n));t.push(o(d,3,l))}else{if("GeometryCollection"!==h)throw new Error("Input data is not a valid GeoJSON object.");for(i=0;i<c.geometries.length;i++)r(t,{geometry:c.geometries[i],properties:d},n)}}function o(t,e,n){var i={geometry:n,type:e,tags:t||null,min:[2,1],max:[-1,0]};return l(i),i}function a(t,e){for(var n=[],i=0;i<t.length;i++)n.push(s(t[i]));return e&&(h(n,e),u(n)),n}function s(t){var e=Math.sin(t[1]*Math.PI/180),n=t[0]/360+.5,i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i=-1>i?-1:i>1?1:i,[n,i,0]}function u(t){for(var e,n,i=0,r=0,o=0;o<t.length-1;o++)e=n||t[o],n=t[o+1],i+=e[0]*n[1]-n[0]*e[1],r+=Math.abs(n[0]-e[0])+Math.abs(n[1]-e[1]);t.area=Math.abs(i/2),t.dist=r}function l(t){var e=t.geometry,n=t.min,i=t.max;if(1===t.type)c(n,i,e);else for(var r=0;r<e.length;r++)c(n,i,e[r]);return t}function c(t,e,n){for(var i,r=0;r<n.length;r++)i=n[r],t[0]=Math.min(i[0],t[0]),e[0]=Math.max(i[0],e[0]),t[1]=Math.min(i[1],t[1]),e[1]=Math.max(i[1],e[1])}e.exports=i;var h=t("./simplify")},{"./simplify":104}],103:[function(t,e,n){"use strict";function i(t,e){return new r(t,e)}function r(t,e){e=this.options=u(Object.create(this.options),e);var n=e.debug;n&&console.time("preprocess data");var i=1<<e.maxZoom,r=c(t,e.tolerance/(i*e.extent));this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=d(r,e.buffer/e.extent,a),r.length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function o(t,e,n){return 32*((1<<t)*n+e)+t}function a(t,e,n){return[n,(n-t[0])*(e[1]-t[1])/(e[0]-t[0])+t[1],1]}function s(t,e,n){return[(n-t[1])*(e[0]-t[0])/(e[1]-t[1])+t[0],n,1]}function u(t,e){for(var n in e)t[n]=e[n];return t}function l(t,e,n){var i=t.source;if(1!==i.length)return!1;var r=i[0];if(3!==r.type||r.geometry.length>1)return!1;var o=r.geometry[0].length;if(5!==o)return!1;for(var a=0;o>a;a++){var s=h.point(r.geometry[0][a],e,t.z2,t.x,t.y);if(s[0]!==-n&&s[0]!==e+n||s[1]!==-n&&s[1]!==e+n)return!1}return!0}e.exports=i;var c=t("./convert"),h=t("./transform"),f=t("./clip"),d=t("./wrap"),p=t("./tile");r.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,solidChildren:!1,tolerance:3,extent:4096,buffer:64,debug:0},r.prototype.splitTile=function(t,e,n,i,r,u,c){for(var h=[t,e,n,i],d=this.options,m=d.debug,v=null;h.length;){i=h.pop(),n=h.pop(),e=h.pop(),t=h.pop();var y=1<<e,g=o(e,n,i),_=this.tiles[g],x=e===d.maxZoom?0:d.tolerance/(y*d.extent);if(!_&&(m>1&&console.time("creation"),_=this.tiles[g]=p(t,y,n,i,x,e===d.maxZoom),this.tileCoords.push({z:e,x:n,y:i}),m)){m>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,_.numFeatures,_.numPoints,_.numSimplified),console.timeEnd("creation"));var b="z"+e;this.stats[b]=(this.stats[b]||0)+1,this.total++}if(_.source=t,r){if(e===d.maxZoom||e===r)continue;var w=1<<r-e;if(n!==Math.floor(u/w)||i!==Math.floor(c/w))continue}else if(e===d.indexMaxZoom||_.numPoints<=d.indexMaxPoints)continue;if(d.solidChildren||!l(_,d.extent,d.buffer)){_.source=null,m>1&&console.time("clipping");var S,M,E,T,D,I,z=.5*d.buffer/d.extent,A=.5-z,k=.5+z,L=1+z;S=M=E=T=null,D=f(t,y,n-z,n+k,0,a,_.min[0],_.max[0]),I=f(t,y,n+A,n+L,0,a,_.min[0],_.max[0]),D&&(S=f(D,y,i-z,i+k,1,s,_.min[1],_.max[1]),M=f(D,y,i+A,i+L,1,s,_.min[1],_.max[1])),I&&(E=f(I,y,i-z,i+k,1,s,_.min[1],_.max[1]),T=f(I,y,i+A,i+L,1,s,_.min[1],_.max[1])),m>1&&console.timeEnd("clipping"),S&&h.push(S,e+1,2*n,2*i),M&&h.push(M,e+1,2*n,2*i+1),E&&h.push(E,e+1,2*n+1,2*i),T&&h.push(T,e+1,2*n+1,2*i+1)}else r&&(v=e)}return v},r.prototype.getTile=function(t,e,n){var i=this.options,r=i.extent,a=i.debug,s=1<<t;e=(e%s+s)%s;var u=o(t,e,n);if(this.tiles[u])return h.tile(this.tiles[u],r);a>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var c,f=t,d=e,p=n;!c&&f>0;)f--,d=Math.floor(d/2),p=Math.floor(p/2),c=this.tiles[o(f,d,p)];if(!c||!c.source)return null;if(a>1&&console.log("found parent tile z%d-%d-%d",f,d,p),l(c,r,i.buffer))return h.tile(c,r);a>1&&console.time("drilling down");var m=this.splitTile(c.source,f,d,p,t,e,n);if(a>1&&console.timeEnd("drilling down"),null!==m){var v=1<<t-m;u=o(m,Math.floor(e/v),Math.floor(n/v))}return this.tiles[u]?h.tile(this.tiles[u],r):null}},{"./clip":101,"./convert":102,"./tile":105,"./transform":106,"./wrap":107}],104:[function(t,e,n){"use strict";function i(t,e){var n,i,o,a,s=e*e,u=t.length,l=0,c=u-1,h=[];for(t[l][2]=1,t[c][2]=1;c;){for(i=0,n=l+1;c>n;n++)o=r(t[n],t[l],t[c]),o>i&&(a=n,i=o);i>s?(t[a][2]=i,h.push(l),h.push(a),l=a):(c=h.pop(),l=h.pop())}}function r(t,e,n){var i=e[0],r=e[1],o=n[0],a=n[1],s=t[0],u=t[1],l=o-i,c=a-r;if(0!==l||0!==c){var h=((s-i)*l+(u-r)*c)/(l*l+c*c);h>1?(i=o,r=a):h>0&&(i+=l*h,r+=c*h)}return l=s-i,c=u-r,l*l+c*c}e.exports=i},{}],105:[function(t,e,n){"use strict";function i(t,e,n,i,o,a){for(var s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z2:e,transformed:!1,min:[2,1],max:[-1,0]},u=0;u<t.length;u++){s.numFeatures++,r(s,t[u],o,a);var l=t[u].min,c=t[u].max;l[0]<s.min[0]&&(s.min[0]=l[0]),l[1]<s.min[1]&&(s.min[1]=l[1]),c[0]>s.max[0]&&(s.max[0]=c[0]),c[1]>s.max[1]&&(s.max[1]=c[1])}return s}function r(t,e,n,i){var r,o,a,s,u=e.geometry,l=e.type,c=[],h=n*n;if(1===l)for(r=0;r<u.length;r++)c.push(u[r]),t.numPoints++,t.numSimplified++;else for(r=0;r<u.length;r++)if(a=u[r],i||!(2===l&&a.dist<n||3===l&&a.area<h)){var f=[];for(o=0;o<a.length;o++)s=a[o],(i||s[2]>h)&&(f.push(s),t.numSimplified++),
t.numPoints++;c.push(f)}else t.numPoints+=a.length;c.length&&t.features.push({geometry:c,type:l,tags:e.tags||null})}e.exports=i},{}],106:[function(t,e,n){"use strict";function i(t,e){if(t.transformed)return t;var n,i,o,a=t.z2,s=t.x,u=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],c=l.geometry,h=l.type;if(1===h)for(i=0;i<c.length;i++)c[i]=r(c[i],e,a,s,u);else for(i=0;i<c.length;i++){var f=c[i];for(o=0;o<f.length;o++)f[o]=r(f[o],e,a,s,u)}}return t.transformed=!0,t}function r(t,e,n,i,r){var o=Math.round(e*(t[0]*n-i)),a=Math.round(e*(t[1]*n-r));return[o,a]}n.tile=i,n.point=r},{}],107:[function(t,e,n){"use strict";function i(t,e,n){var i=t,o=a(t,1,-1-e,e,0,n,-1,2),s=a(t,1,1-e,2+e,0,n,-1,2);return(o||s)&&(i=a(t,1,-e,1+e,0,n,-1,2),o&&(i=r(o,1).concat(i)),s&&(i=i.concat(r(s,-1)))),i}function r(t,e){for(var n=[],i=0;i<t.length;i++){var r,a=t[i],s=a.type;if(1===s)r=o(a.geometry,e);else{r=[];for(var u=0;u<a.geometry.length;u++)r.push(o(a.geometry[u],e))}n.push({geometry:r,type:s,tags:a.tags,min:[a.min[0]+e,a.min[1]],max:[a.max[0]+e,a.max[1]]})}return n}function o(t,e){var n=[];n.area=t.area,n.dist=t.dist;for(var i=0;i<t.length;i++)n.push([t[i][0]+e,t[i][1],t[i][2]]);return n}var a=t("./clip");e.exports=i},{"./clip":101}],108:[function(t,e,n){n.glMatrix=t("./gl-matrix/common.js"),n.mat2=t("./gl-matrix/mat2.js"),n.mat2d=t("./gl-matrix/mat2d.js"),n.mat3=t("./gl-matrix/mat3.js"),n.mat4=t("./gl-matrix/mat4.js"),n.quat=t("./gl-matrix/quat.js"),n.vec2=t("./gl-matrix/vec2.js"),n.vec3=t("./gl-matrix/vec3.js"),n.vec4=t("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":109,"./gl-matrix/mat2.js":110,"./gl-matrix/mat2d.js":111,"./gl-matrix/mat3.js":112,"./gl-matrix/mat4.js":113,"./gl-matrix/quat.js":114,"./gl-matrix/vec2.js":115,"./gl-matrix/vec3.js":116,"./gl-matrix/vec4.js":117}],109:[function(t,e,n){var i={};i.EPSILON=1e-6,i.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,i.RANDOM=Math.random,i.ENABLE_SIMD=!1,i.SIMD_AVAILABLE=i.ARRAY_TYPE===Float32Array&&"SIMD"in this,i.USE_SIMD=i.ENABLE_SIMD&&i.SIMD_AVAILABLE,i.setMatrixArrayType=function(t){i.ARRAY_TYPE=t};var r=Math.PI/180;i.toRadian=function(t){return t*r},i.equals=function(t,e){return Math.abs(t-e)<=i.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.exports=i},{}],110:[function(t,e,n){var i=t("./common.js"),r={};r.create=function(){var t=new i.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.clone=function(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.fromValues=function(t,e,n,r){var o=new i.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},r.set=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},r.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},r.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n*o-r*i;return a?(a=1/a,t[0]=o*a,t[1]=-i*a,t[2]=-r*a,t[3]=n*a,t):null},r.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=i*s+o*u,t[1]=r*s+a*u,t[2]=i*l+o*c,t[3]=r*l+a*c,t},r.mul=r.multiply,r.rotate=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=i*u+o*s,t[1]=r*u+a*s,t[2]=i*-s+o*u,t[3]=r*-s+a*u,t},r.scale=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=n[0],u=n[1];return t[0]=i*s,t[1]=r*s,t[2]=o*u,t[3]=a*u,t},r.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},r.LDU=function(t,e,n,i){return t[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-t[2]*n[1],[t,e,n]},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},r.sub=r.subtract,r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],a=t[3],s=e[0],u=e[1],l=e[2],c=e[3];return Math.abs(n-s)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-u)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-l)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(a-c)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))},r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},r.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},e.exports=r},{"./common.js":109}],111:[function(t,e,n){var i=t("./common.js"),r={};r.create=function(){var t=new i.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.clone=function(t){var e=new i.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.fromValues=function(t,e,n,r,o,a){var s=new i.ARRAY_TYPE(6);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s[4]=o,s[5]=a,s},r.set=function(t,e,n,i,r,o,a){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=a,t},r.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=n*o-i*r;return u?(u=1/u,t[0]=o*u,t[1]=-i*u,t[2]=-r*u,t[3]=n*u,t[4]=(r*s-o*a)*u,t[5]=(i*a-n*s)*u,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],c=n[1],h=n[2],f=n[3],d=n[4],p=n[5];return t[0]=i*l+o*c,t[1]=r*l+a*c,t[2]=i*h+o*f,t[3]=r*h+a*f,t[4]=i*d+o*p+s,t[5]=r*d+a*p+u,t},r.mul=r.multiply,r.rotate=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=Math.sin(n),c=Math.cos(n);return t[0]=i*c+o*l,t[1]=r*c+a*l,t[2]=i*-l+o*c,t[3]=r*-l+a*c,t[4]=s,t[5]=u,t},r.scale=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],c=n[1];return t[0]=i*l,t[1]=r*l,t[2]=o*c,t[3]=a*c,t[4]=s,t[5]=u,t},r.translate=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],c=n[1];return t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=i*l+o*c+s,t[5]=r*l+a*c+u,t},r.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t[4]=0,t[5]=0,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},r.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=e[0],c=e[1],h=e[2],f=e[3],d=e[4],p=e[5];return Math.abs(n-l)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-c)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-h)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(a-f)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-d)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(u-p)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))},e.exports=r},{"./common.js":109}],112:[function(t,e,n){var i=t("./common.js"),r={};r.create=function(){var t=new i.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.clone=function(t){var e=new i.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromValues=function(t,e,n,r,o,a,s,u,l){var c=new i.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=o,c[5]=a,c[6]=s,c[7]=u,c[8]=l,c},r.set=function(t,e,n,i,r,o,a,s,u,l){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=l,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},r.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=c*a-s*l,f=-c*o+s*u,d=l*o-a*u,p=n*h+i*f+r*d;return p?(p=1/p,t[0]=h*p,t[1]=(-c*i+r*l)*p,t[2]=(s*i-r*a)*p,t[3]=f*p,t[4]=(c*n-r*u)*p,t[5]=(-s*n+r*o)*p,t[6]=d*p,t[7]=(-l*n+i*u)*p,t[8]=(a*n-i*o)*p,t):null},r.adjoint=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8];return t[0]=a*c-s*l,t[1]=r*l-i*c,t[2]=i*s-r*a,t[3]=s*u-o*c,t[4]=n*c-r*u,t[5]=r*o-n*s,t[6]=o*l-a*u,t[7]=i*u-n*l,t[8]=n*a-i*o,t},r.determinant=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8];return e*(l*o-a*u)+n*(-l*r+a*s)+i*(u*r-o*s)},r.multiply=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=n[0],d=n[1],p=n[2],m=n[3],v=n[4],y=n[5],g=n[6],_=n[7],x=n[8];return t[0]=f*i+d*a+p*l,t[1]=f*r+d*s+p*c,t[2]=f*o+d*u+p*h,t[3]=m*i+v*a+y*l,t[4]=m*r+v*s+y*c,t[5]=m*o+v*u+y*h,t[6]=g*i+_*a+x*l,t[7]=g*r+_*s+x*c,t[8]=g*o+_*u+x*h,t},r.mul=r.multiply,r.translate=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=n[0],d=n[1];return t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=f*i+d*a+l,t[7]=f*r+d*s+c,t[8]=f*o+d*u+h,t},r.rotate=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=Math.sin(n),d=Math.cos(n);return t[0]=d*i+f*a,t[1]=d*r+f*s,t[2]=d*o+f*u,t[3]=d*a-f*i,t[4]=d*s-f*r,t[5]=d*u-f*o,t[6]=l,t[7]=c,t[8]=h,t},r.scale=function(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},r.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},r.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n+n,s=i+i,u=r+r,l=n*a,c=i*a,h=i*s,f=r*a,d=r*s,p=r*u,m=o*a,v=o*s,y=o*u;return t[0]=1-h-p,t[3]=c-y,t[6]=f+v,t[1]=c+y,t[4]=1-l-p,t[7]=d-m,t[2]=f-v,t[5]=d+m,t[8]=1-l-h,t},r.normalFromMat4=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],y=e[15],g=n*s-i*a,_=n*u-r*a,x=n*l-o*a,b=i*u-r*s,w=i*l-o*s,S=r*l-o*u,M=c*m-h*p,E=c*v-f*p,T=c*y-d*p,D=h*v-f*m,I=h*y-d*m,z=f*y-d*v,A=g*z-_*I+x*D+b*T-w*E+S*M;return A?(A=1/A,t[0]=(s*z-u*I+l*D)*A,t[1]=(u*T-a*z-l*E)*A,t[2]=(a*I-s*T+l*M)*A,t[3]=(r*I-i*z-o*D)*A,t[4]=(n*z-r*T+o*E)*A,t[5]=(i*T-n*I-o*M)*A,t[6]=(m*S-v*w+y*b)*A,t[7]=(v*x-p*S-y*_)*A,t[8]=(p*w-m*x+y*g)*A,t):null},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},r.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=e[0],d=e[1],p=e[2],m=e[3],v=e[4],y=e[5],g=t[6],_=e[7],x=e[8];return Math.abs(n-f)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-d)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(o-p)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-m)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-v)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-y)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(l-g)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(c-_)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(h-x)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))},e.exports=r},{"./common.js":109}],113:[function(t,e,n){var i=t("./common.js"),r={scalar:{},SIMD:{}};r.create=function(){var t=new i.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.clone=function(t){var e=new i.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.fromValues=function(t,e,n,r,o,a,s,u,l,c,h,f,d,p,m,v){var y=new i.ARRAY_TYPE(16);return y[0]=t,y[1]=e,y[2]=n,y[3]=r,y[4]=o,y[5]=a,y[6]=s,y[7]=u,y[8]=l,y[9]=c,y[10]=h,y[11]=f,y[12]=d,y[13]=p,y[14]=m,y[15]=v,y},r.set=function(t,e,n,i,r,o,a,s,u,l,c,h,f,d,p,m,v){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=l,t[9]=c,t[10]=h,t[11]=f,t[12]=d,t[13]=p,t[14]=m,t[15]=v,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.scalar.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},r.SIMD.transpose=function(t,e){var n,i,r,o,a,s,u,l,c,h;return n=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),a=SIMD.Float32x4.shuffle(n,i,0,1,4,5),s=SIMD.Float32x4.shuffle(r,o,0,1,4,5),u=SIMD.Float32x4.shuffle(a,s,0,2,4,6),l=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(t,0,u),SIMD.Float32x4.store(t,4,l),a=SIMD.Float32x4.shuffle(n,i,2,3,6,7),s=SIMD.Float32x4.shuffle(r,o,2,3,6,7),c=SIMD.Float32x4.shuffle(a,s,0,2,4,6),h=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,h),t},r.transpose=i.USE_SIMD?r.SIMD.transpose:r.scalar.transpose,r.scalar.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],y=e[15],g=n*s-i*a,_=n*u-r*a,x=n*l-o*a,b=i*u-r*s,w=i*l-o*s,S=r*l-o*u,M=c*m-h*p,E=c*v-f*p,T=c*y-d*p,D=h*v-f*m,I=h*y-d*m,z=f*y-d*v,A=g*z-_*I+x*D+b*T-w*E+S*M;return A?(A=1/A,t[0]=(s*z-u*I+l*D)*A,t[1]=(r*I-i*z-o*D)*A,t[2]=(m*S-v*w+y*b)*A,t[3]=(f*w-h*S-d*b)*A,t[4]=(u*T-a*z-l*E)*A,t[5]=(n*z-r*T+o*E)*A,t[6]=(v*x-p*S-y*_)*A,t[7]=(c*S-f*x+d*_)*A,t[8]=(a*I-s*T+l*M)*A,t[9]=(i*T-n*I-o*M)*A,t[10]=(p*w-m*x+y*g)*A,t[11]=(h*x-c*w-d*g)*A,t[12]=(s*E-a*D-u*M)*A,t[13]=(n*D-i*E+r*M)*A,t[14]=(m*_-p*b-v*g)*A,t[15]=(c*b-h*_+f*g)*A,t):null},r.SIMD.invert=function(t,e){var n,i,r,o,a,s,u,l,c,h,f=SIMD.Float32x4.load(e,0),d=SIMD.Float32x4.load(e,4),p=SIMD.Float32x4.load(e,8),m=SIMD.Float32x4.load(e,12);return a=SIMD.Float32x4.shuffle(f,d,0,1,4,5),i=SIMD.Float32x4.shuffle(p,m,0,1,4,5),n=SIMD.Float32x4.shuffle(a,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,a,1,3,5,7),a=SIMD.Float32x4.shuffle(f,d,2,3,6,7),o=SIMD.Float32x4.shuffle(p,m,2,3,6,7),r=SIMD.Float32x4.shuffle(a,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,a,1,3,5,7),a=SIMD.Float32x4.mul(r,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.mul(i,a),u=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),s),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),a=SIMD.Float32x4.mul(i,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),s),c=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,a)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(i,2,3,0,1),o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),r=SIMD.Float32x4.swizzle(r,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),s),l=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(r,a)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),a=SIMD.Float32x4.mul(n,i),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),l),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,a),c),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.mul(n,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(r,a)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),l),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),u),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(i,a)),a=SIMD.Float32x4.mul(n,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(i,a)),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,a)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),c),h=SIMD.Float32x4.mul(n,s),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,2,3,0,1),h),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,1,0,3,2),h),a=SIMD.Float32x4.reciprocalApproximation(h),h=SIMD.Float32x4.sub(SIMD.Float32x4.add(a,a),SIMD.Float32x4.mul(h,SIMD.Float32x4.mul(a,a))),(h=SIMD.Float32x4.swizzle(h,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(h,s)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(h,u)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(h,l)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(h,c)),t):null},r.invert=i.USE_SIMD?r.SIMD.invert:r.scalar.invert,r.scalar.adjoint=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],y=e[15];return t[0]=s*(f*y-d*v)-h*(u*y-l*v)+m*(u*d-l*f),t[1]=-(i*(f*y-d*v)-h*(r*y-o*v)+m*(r*d-o*f)),t[2]=i*(u*y-l*v)-s*(r*y-o*v)+m*(r*l-o*u),t[3]=-(i*(u*d-l*f)-s*(r*d-o*f)+h*(r*l-o*u)),t[4]=-(a*(f*y-d*v)-c*(u*y-l*v)+p*(u*d-l*f)),t[5]=n*(f*y-d*v)-c*(r*y-o*v)+p*(r*d-o*f),t[6]=-(n*(u*y-l*v)-a*(r*y-o*v)+p*(r*l-o*u)),t[7]=n*(u*d-l*f)-a*(r*d-o*f)+c*(r*l-o*u),t[8]=a*(h*y-d*m)-c*(s*y-l*m)+p*(s*d-l*h),t[9]=-(n*(h*y-d*m)-c*(i*y-o*m)+p*(i*d-o*h)),t[10]=n*(s*y-l*m)-a*(i*y-o*m)+p*(i*l-o*s),t[11]=-(n*(s*d-l*h)-a*(i*d-o*h)+c*(i*l-o*s)),t[12]=-(a*(h*v-f*m)-c*(s*v-u*m)+p*(s*f-u*h)),t[13]=n*(h*v-f*m)-c*(i*v-r*m)+p*(i*f-r*h),t[14]=-(n*(s*v-u*m)-a*(i*v-r*m)+p*(i*u-r*s)),t[15]=n*(s*f-u*h)-a*(i*f-r*h)+c*(i*u-r*s),t},r.SIMD.adjoint=function(t,e){var n,i,r,o,a,s,u,l,c,h,f,d,p,n=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12);return c=SIMD.Float32x4.shuffle(n,i,0,1,4,5),s=SIMD.Float32x4.shuffle(r,o,0,1,4,5),a=SIMD.Float32x4.shuffle(c,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,c,1,3,5,7),c=SIMD.Float32x4.shuffle(n,i,2,3,6,7),l=SIMD.Float32x4.shuffle(r,o,2,3,6,7),u=SIMD.Float32x4.shuffle(c,l,0,2,4,6),l=SIMD.Float32x4.shuffle(l,c,1,3,5,7),c=SIMD.Float32x4.mul(u,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.mul(s,c),f=SIMD.Float32x4.mul(a,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),h),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,c),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.mul(s,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),p=SIMD.Float32x4.mul(a,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c)),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,c),p),p=SIMD.Float32x4.swizzle(p,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),h),d=SIMD.Float32x4.mul(a,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(a,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),d),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),p),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),d),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(a,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),f),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.mul(a,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),f),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c)),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),p),SIMD.Float32x4.store(t,0,h),SIMD.Float32x4.store(t,4,f),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,p),t},r.adjoint=i.USE_SIMD?r.SIMD.adjoint:r.scalar.adjoint,r.determinant=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],f=t[11],d=t[12],p=t[13],m=t[14],v=t[15],y=e*a-n*o,g=e*s-i*o,_=e*u-r*o,x=n*s-i*a,b=n*u-r*a,w=i*u-r*s,S=l*p-c*d,M=l*m-h*d,E=l*v-f*d,T=c*m-h*p,D=c*v-f*p,I=h*v-f*m;return y*I-g*D+_*T+x*E-b*M+w*S},r.SIMD.multiply=function(t,e,n){var i=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4.load(n,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),a))));SIMD.Float32x4.store(t,0,u);var l=SIMD.Float32x4.load(n,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),a))));SIMD.Float32x4.store(t,4,c);var h=SIMD.Float32x4.load(n,8),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),a))));SIMD.Float32x4.store(t,8,f);var d=SIMD.Float32x4.load(n,12),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),a))));return SIMD.Float32x4.store(t,12,p),t},r.scalar.multiply=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],m=e[12],v=e[13],y=e[14],g=e[15],_=n[0],x=n[1],b=n[2],w=n[3];return t[0]=_*i+x*s+b*h+w*m,t[1]=_*r+x*u+b*f+w*v,t[2]=_*o+x*l+b*d+w*y,t[3]=_*a+x*c+b*p+w*g,_=n[4],x=n[5],b=n[6],w=n[7],t[4]=_*i+x*s+b*h+w*m,t[5]=_*r+x*u+b*f+w*v,t[6]=_*o+x*l+b*d+w*y,t[7]=_*a+x*c+b*p+w*g,_=n[8],x=n[9],b=n[10],w=n[11],t[8]=_*i+x*s+b*h+w*m,t[9]=_*r+x*u+b*f+w*v,t[10]=_*o+x*l+b*d+w*y,t[11]=_*a+x*c+b*p+w*g,_=n[12],x=n[13],b=n[14],w=n[15],t[12]=_*i+x*s+b*h+w*m,t[13]=_*r+x*u+b*f+w*v,t[14]=_*o+x*l+b*d+w*y,t[15]=_*a+x*c+b*p+w*g,t},r.multiply=i.USE_SIMD?r.SIMD.multiply:r.scalar.multiply,r.mul=r.multiply,r.scalar.translate=function(t,e,n){var i,r,o,a,s,u,l,c,h,f,d,p,m=n[0],v=n[1],y=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*y+e[12],t[13]=e[1]*m+e[5]*v+e[9]*y+e[13],t[14]=e[2]*m+e[6]*v+e[10]*y+e[14],t[15]=e[3]*m+e[7]*v+e[11]*y+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l,t[7]=c,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=i*m+s*v+h*y+e[12],t[13]=r*m+u*v+f*y+e[13],t[14]=o*m+l*v+d*y+e[14],t[15]=a*m+c*v+p*y+e[15]),t},r.SIMD.translate=function(t,e,n){var i=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(n[0],n[1],n[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,0,0,0,0)),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(i,SIMD.Float32x4.add(r,SIMD.Float32x4.add(o,a)));return SIMD.Float32x4.store(t,12,u),t},r.translate=i.USE_SIMD?r.SIMD.translate:r.scalar.translate,r.scalar.scale=function(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.SIMD.scale=function(t,e,n){var i,r,o,a=SIMD.Float32x4(n[0],n[1],n[2],0);return i=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(a,0,0,0,0))),r=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(a,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(a,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.scale=i.USE_SIMD?r.SIMD.scale:r.scalar.scale,r.rotate=function(t,e,n,r){var o,a,s,u,l,c,h,f,d,p,m,v,y,g,_,x,b,w,S,M,E,T,D,I,z=r[0],A=r[1],k=r[2],L=Math.sqrt(z*z+A*A+k*k);return Math.abs(L)<i.EPSILON?null:(L=1/L,z*=L,A*=L,k*=L,o=Math.sin(n),a=Math.cos(n),s=1-a,u=e[0],l=e[1],c=e[2],h=e[3],f=e[4],d=e[5],p=e[6],m=e[7],v=e[8],y=e[9],g=e[10],_=e[11],x=z*z*s+a,b=A*z*s+k*o,w=k*z*s-A*o,S=z*A*s-k*o,M=A*A*s+a,E=k*A*s+z*o,T=z*k*s+A*o,D=A*k*s-z*o,I=k*k*s+a,t[0]=u*x+f*b+v*w,t[1]=l*x+d*b+y*w,t[2]=c*x+p*b+g*w,t[3]=h*x+m*b+_*w,t[4]=u*S+f*M+v*E,t[5]=l*S+d*M+y*E,t[6]=c*S+p*M+g*E,t[7]=h*S+m*M+_*E,t[8]=u*T+f*D+v*I,t[9]=l*T+d*D+y*I,t[10]=c*T+p*D+g*I,t[11]=h*T+m*D+_*I,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},r.scalar.rotateX=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+l*i,t[5]=a*r+c*i,t[6]=s*r+h*i,t[7]=u*r+f*i,t[8]=l*r-o*i,t[9]=c*r-a*i,t[10]=h*r-s*i,t[11]=f*r-u*i,t},r.SIMD.rotateX=function(t,e,n){var i=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,i))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,r),SIMD.Float32x4.mul(o,i))),t},r.rotateX=i.USE_SIMD?r.SIMD.rotateX:r.scalar.rotateX,r.scalar.rotateY=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],l=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-l*i,t[1]=a*r-c*i,t[2]=s*r-h*i,t[3]=u*r-f*i,t[8]=o*i+l*r,t[9]=a*i+c*r,t[10]=s*i+h*r,t[11]=u*i+f*r,t},r.SIMD.rotateY=function(t,e,n){var i=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,i))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(a,r))),t},r.rotateY=i.USE_SIMD?r.SIMD.rotateY:r.scalar.rotateY,r.scalar.rotateZ=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],l=e[4],c=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+l*i,t[1]=a*r+c*i,t[2]=s*r+h*i,t[3]=u*r+f*i,t[4]=l*r-o*i,t[5]=c*r-a*i,t[6]=h*r-s*i,t[7]=f*r-u*i,t},r.SIMD.rotateZ=function(t,e,n){var i=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,i))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,r),SIMD.Float32x4.mul(o,i))),t},r.rotateZ=i.USE_SIMD?r.SIMD.rotateZ:r.scalar.rotateZ,r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,e,n){var r,o,a,s=n[0],u=n[1],l=n[2],c=Math.sqrt(s*s+u*u+l*l);return Math.abs(c)<i.EPSILON?null:(c=1/c,s*=c,u*=c,l*=c,r=Math.sin(e),o=Math.cos(e),a=1-o,t[0]=s*s*a+o,t[1]=u*s*a+l*r,t[2]=l*s*a-u*r,t[3]=0,t[4]=s*u*a-l*r,t[5]=u*u*a+o,t[6]=l*u*a+s*r,t[7]=0,t[8]=s*l*a+u*r,t[9]=u*l*a-s*r,t[10]=l*l*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},r.fromXRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,
t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=i+i,u=r+r,l=o+o,c=i*s,h=i*u,f=i*l,d=r*u,p=r*l,m=o*l,v=a*s,y=a*u,g=a*l;return t[0]=1-(d+m),t[1]=h+g,t[2]=f-y,t[3]=0,t[4]=h-g,t[5]=1-(c+m),t[6]=p+v,t[7]=0,t[8]=f+y,t[9]=p-v,t[10]=1-(c+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},r.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},r.getRotation=function(t,e){var n=e[0]+e[5]+e[10],i=0;return n>0?(i=2*Math.sqrt(n+1),t[3]=.25*i,t[0]=(e[6]-e[9])/i,t[1]=(e[8]-e[2])/i,t[2]=(e[1]-e[4])/i):e[0]>e[5]&e[0]>e[10]?(i=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/i,t[0]=.25*i,t[1]=(e[1]+e[4])/i,t[2]=(e[8]+e[2])/i):e[5]>e[10]?(i=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/i,t[0]=(e[1]+e[4])/i,t[1]=.25*i,t[2]=(e[6]+e[9])/i):(i=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/i,t[0]=(e[8]+e[2])/i,t[1]=(e[6]+e[9])/i,t[2]=.25*i),t},r.fromRotationTranslationScale=function(t,e,n,i){var r=e[0],o=e[1],a=e[2],s=e[3],u=r+r,l=o+o,c=a+a,h=r*u,f=r*l,d=r*c,p=o*l,m=o*c,v=a*c,y=s*u,g=s*l,_=s*c,x=i[0],b=i[1],w=i[2];return t[0]=(1-(p+v))*x,t[1]=(f+_)*x,t[2]=(d-g)*x,t[3]=0,t[4]=(f-_)*b,t[5]=(1-(h+v))*b,t[6]=(m+y)*b,t[7]=0,t[8]=(d+g)*w,t[9]=(m-y)*w,t[10]=(1-(h+p))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,e,n,i,r){var o=e[0],a=e[1],s=e[2],u=e[3],l=o+o,c=a+a,h=s+s,f=o*l,d=o*c,p=o*h,m=a*c,v=a*h,y=s*h,g=u*l,_=u*c,x=u*h,b=i[0],w=i[1],S=i[2],M=r[0],E=r[1],T=r[2];return t[0]=(1-(m+y))*b,t[1]=(d+x)*b,t[2]=(p-_)*b,t[3]=0,t[4]=(d-x)*w,t[5]=(1-(f+y))*w,t[6]=(v+g)*w,t[7]=0,t[8]=(p+_)*S,t[9]=(v-g)*S,t[10]=(1-(f+m))*S,t[11]=0,t[12]=n[0]+M-(t[0]*M+t[4]*E+t[8]*T),t[13]=n[1]+E-(t[1]*M+t[5]*E+t[9]*T),t[14]=n[2]+T-(t[2]*M+t[6]*E+t[10]*T),t[15]=1,t},r.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n+n,s=i+i,u=r+r,l=n*a,c=i*a,h=i*s,f=r*a,d=r*s,p=r*u,m=o*a,v=o*s,y=o*u;return t[0]=1-h-p,t[1]=c+y,t[2]=f-v,t[3]=0,t[4]=c-y,t[5]=1-l-p,t[6]=d+m,t[7]=0,t[8]=f+v,t[9]=d-m,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,e,n,i,r,o,a){var s=1/(n-e),u=1/(r-i),l=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(r+i)*u,t[10]=(a+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*l,t[15]=0,t},r.perspective=function(t,e,n,i,r){var o=1/Math.tan(e/2),a=1/(i-r);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*a,t[15]=0,t},r.perspectiveFromFieldOfView=function(t,e,n,i){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(r+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-((a-s)*u*.5),t[9]=(r-o)*l*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t},r.ortho=function(t,e,n,i,r,o,a){var s=1/(e-n),u=1/(i-r),l=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*u,t[14]=(a+o)*l,t[15]=1,t},r.lookAt=function(t,e,n,o){var a,s,u,l,c,h,f,d,p,m,v=e[0],y=e[1],g=e[2],_=o[0],x=o[1],b=o[2],w=n[0],S=n[1],M=n[2];return Math.abs(v-w)<i.EPSILON&&Math.abs(y-S)<i.EPSILON&&Math.abs(g-M)<i.EPSILON?r.identity(t):(f=v-w,d=y-S,p=g-M,m=1/Math.sqrt(f*f+d*d+p*p),f*=m,d*=m,p*=m,a=x*p-b*d,s=b*f-_*p,u=_*d-x*f,m=Math.sqrt(a*a+s*s+u*u),m?(m=1/m,a*=m,s*=m,u*=m):(a=0,s=0,u=0),l=d*u-p*s,c=p*a-f*u,h=f*s-d*a,m=Math.sqrt(l*l+c*c+h*h),m?(m=1/m,l*=m,c*=m,h*=m):(l=0,c=0,h=0),t[0]=a,t[1]=l,t[2]=f,t[3]=0,t[4]=s,t[5]=c,t[6]=d,t[7]=0,t[8]=u,t[9]=h,t[10]=p,t[11]=0,t[12]=-(a*v+s*y+u*g),t[13]=-(l*v+c*y+h*g),t[14]=-(f*v+d*y+p*g),t[15]=1,t)},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},r.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=t[9],d=t[10],p=t[11],m=t[12],v=t[13],y=t[14],g=t[15],_=e[0],x=e[1],b=e[2],w=e[3],S=e[4],M=e[5],E=e[6],T=e[7],D=e[8],I=e[9],z=e[10],A=e[11],k=e[12],L=e[13],C=e[14],P=e[15];return Math.abs(n-_)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(r-x)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(o-b)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-w)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-S)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-M)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(l-E)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(c-T)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(h-D)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(f-I)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(d-z)<=i.EPSILON*Math.max(1,Math.abs(d),Math.abs(z))&&Math.abs(p-A)<=i.EPSILON*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(m-k)<=i.EPSILON*Math.max(1,Math.abs(m),Math.abs(k))&&Math.abs(v-L)<=i.EPSILON*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(y-C)<=i.EPSILON*Math.max(1,Math.abs(y),Math.abs(C))&&Math.abs(g-P)<=i.EPSILON*Math.max(1,Math.abs(g),Math.abs(P))},e.exports=r},{"./common.js":109}],114:[function(t,e,n){var i=t("./common.js"),r=t("./mat3.js"),o=t("./vec3.js"),a=t("./vec4.js"),s={};s.create=function(){var t=new i.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(i,r,a){var u=o.dot(r,a);return-.999999>u?(o.cross(t,e,r),o.length(t)<1e-6&&o.cross(t,n,r),o.normalize(t,t),s.setAxisAngle(i,t,Math.PI),i):u>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(o.cross(t,r,a),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+u,s.normalize(i,i))}}(),s.setAxes=function(){var t=r.create();return function(e,n,i,r){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=a.clone,s.fromValues=a.fromValues,s.copy=a.copy,s.set=a.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,n){n=.5*n;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t},s.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return 0!=i?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n},s.add=a.add,s.multiply=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=i*c+a*s+r*l-o*u,t[1]=r*c+a*u+o*s-i*l,t[2]=o*c+a*l+i*u-r*s,t[3]=a*c-i*s-r*u-o*l,t},s.mul=s.multiply,s.scale=a.scale,s.rotateX=function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=i*u+a*s,t[1]=r*u+o*s,t[2]=o*u-r*s,t[3]=a*u-i*s,t},s.rotateY=function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=i*u-o*s,t[1]=r*u+a*s,t[2]=o*u+i*s,t[3]=a*u-r*s,t},s.rotateZ=function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=i*u+r*s,t[1]=r*u-i*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t},s.calculateW=function(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t},s.dot=a.dot,s.lerp=a.lerp,s.slerp=function(t,e,n,i){var r,o,a,s,u,l=e[0],c=e[1],h=e[2],f=e[3],d=n[0],p=n[1],m=n[2],v=n[3];return o=l*d+c*p+h*m+f*v,0>o&&(o=-o,d=-d,p=-p,m=-m,v=-v),1-o>1e-6?(r=Math.acos(o),a=Math.sin(r),s=Math.sin((1-i)*r)/a,u=Math.sin(i*r)/a):(s=1-i,u=i),t[0]=s*l+u*d,t[1]=s*c+u*p,t[2]=s*h+u*m,t[3]=s*f+u*v,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(n,i,r,o,a,u){return s.slerp(t,i,a,u),s.slerp(e,r,o,u),s.slerp(n,t,e,2*u*(1-u)),n}}(),s.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n*n+i*i+r*r+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-i*s,t[2]=-r*s,t[3]=o*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=a.length,s.len=s.length,s.squaredLength=a.squaredLength,s.sqrLen=s.squaredLength,s.normalize=a.normalize,s.fromMat3=function(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,a=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*a+a]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+r]+e[3*r+o])*n,t[a]=(e[3*a+r]+e[3*r+a])*n}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},s.exactEquals=a.exactEquals,s.equals=a.equals,e.exports=s},{"./common.js":109,"./mat3.js":112,"./vec3.js":116,"./vec4.js":117}],115:[function(t,e,n){var i=t("./common.js"),r={};r.create=function(){var t=new i.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},r.clone=function(t){var e=new i.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},r.fromValues=function(t,e){var n=new i.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},r.set=function(t,e,n){return t[0]=e,t[1]=n,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},r.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t},r.distance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(n*n+i*i)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},r.normalize=function(t,e){var n=e[0],i=e[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},r.cross=function(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t},r.lerp=function(t,e,n,i){var r=e[0],o=e[1];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t},r.random=function(t,e){e=e||1;var n=2*i.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},r.transformMat2=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t},r.transformMat2d=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t},r.transformMat3=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t},r.transformMat4=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t},r.forEach=function(){var t=r.create();return function(e,n,i,r,o,a){var s,u;for(n||(n=2),i||(i=0),u=r?Math.min(r*n+i,e.length):e.length,s=i;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}(),r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},r.equals=function(t,e){var n=t[0],r=t[1],o=e[0],a=e[1];return Math.abs(n-o)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))},e.exports=r},{"./common.js":109}],116:[function(t,e,n){var i=t("./common.js"),r={};r.create=function(){var t=new i.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},r.clone=function(t){var e=new i.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.fromValues=function(t,e,n){var r=new i.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.set=function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},r.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t},r.distance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+i*i+r*r)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},r.normalize=function(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},r.cross=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=r*u-o*s,t[1]=o*a-i*u,t[2]=i*s-r*a,t},r.lerp=function(t,e,n,i){var r=e[0],o=e[1],a=e[2];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=a+i*(n[2]-a),t},r.hermite=function(t,e,n,i,r,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,l=a*(o-1),c=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+i[0]*l+r[0]*c,t[1]=e[1]*s+n[1]*u+i[1]*l+r[1]*c,t[2]=e[2]*s+n[2]*u+i[2]*l+r[2]*c,t},r.bezier=function(t,e,n,i,r,o){var a=1-o,s=a*a,u=o*o,l=s*a,c=3*o*s,h=3*u*a,f=u*o;return t[0]=e[0]*l+n[0]*c+i[0]*h+r[0]*f,t[1]=e[1]*l+n[1]*c+i[1]*h+r[1]*f,t[2]=e[2]*l+n[2]*c+i[2]*h+r[2]*f,t},r.random=function(t,e){e=e||1;var n=2*i.RANDOM()*Math.PI,r=2*i.RANDOM()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=r*e,t},r.transformMat4=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[3]*i+n[7]*r+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/a,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/a,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/a,t},r.transformMat3=function(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t},r.transformQuat=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*i+s*o-u*r,h=l*r+u*i-a*o,f=l*o+a*r-s*i,d=-a*i-s*r-u*o;return t[0]=c*l+d*-a+h*-u-f*-s,t[1]=h*l+d*-s+f*-a-c*-u,t[2]=f*l+d*-u+c*-s-h*-a,t},r.rotateX=function(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.rotateY=function(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.rotateZ=function(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.forEach=function(){var t=r.create();return function(e,n,i,r,o,a){var s,u;for(n||(n=3),i||(i=0),u=r?Math.min(r*n+i,e.length):e.length,s=i;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),r.angle=function(t,e){var n=r.fromValues(t[0],t[1],t[2]),i=r.fromValues(e[0],e[1],e[2]);r.normalize(n,n),r.normalize(i,i);var o=r.dot(n,i);return o>1?0:Math.acos(o)},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],a=e[0],s=e[1],u=e[2];return Math.abs(n-a)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(o-u)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},e.exports=r},{"./common.js":109}],117:[function(t,e,n){var i=t("./common.js"),r={};r.create=function(){var t=new i.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.clone=function(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,n,r){var o=new i.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.set=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},r.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},r.distance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+i*i+r*r+o*o)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return n*n+i*i+r*r+o*o},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.sqrt(e*e+n*n+i*i+r*r)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},r.normalize=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n*n+i*i+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=i*a,t[2]=r*a,t[3]=o*a),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},r.lerp=function(t,e,n,i){var r=e[0],o=e[1],a=e[2],s=e[3];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=a+i*(n[2]-a),t[3]=s+i*(n[3]-s),t},r.random=function(t,e){return e=e||1,t[0]=i.RANDOM(),t[1]=i.RANDOM(),t[2]=i.RANDOM(),t[3]=i.RANDOM(),r.normalize(t,t),r.scale(t,t,e),t},r.transformMat4=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,t},r.transformQuat=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*i+s*o-u*r,h=l*r+u*i-a*o,f=l*o+a*r-s*i,d=-a*i-s*r-u*o;return t[0]=c*l+d*-a+h*-u-f*-s,t[1]=h*l+d*-s+f*-a-c*-u,t[2]=f*l+d*-u+c*-s-h*-a,t[3]=e[3],t},r.forEach=function(){var t=r.create();return function(e,n,i,r,o,a){var s,u;for(n||(n=4),i||(i=0),u=r?Math.min(r*n+i,e.length):e.length,s=i;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],a=t[3],s=e[0],u=e[1],l=e[2],c=e[3];return Math.abs(n-s)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-u)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-l)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(a-c)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))},e.exports=r},{"./common.js":109}],118:[function(t,e,n){n.read=function(t,e,n,i,r){var o,a,s=8*r-i-1,u=(1<<s)-1,l=u>>1,c=-7,h=n?r-1:0,f=n?-1:1,d=t[e+h];for(h+=f,o=d&(1<<-c)-1,d>>=-c,c+=s;c>0;o=256*o+t[e+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=i;c>0;a=256*a+t[e+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:(d?-1:1)*(1/0);a+=Math.pow(2,i),o-=l}return(d?-1:1)*a*Math.pow(2,o-i)},n.write=function(t,e,n,i,r,o){var a,s,u,l=8*o-r-1,c=(1<<l)-1,h=c>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:o-1,p=i?1:-1,m=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),e+=a+h>=1?f/u:f*Math.pow(2,1-h),e*u>=2&&(a++,u/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*u-1)*Math.pow(2,r),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;t[n+d]=255&s,d+=p,s/=256,r-=8);for(a=a<<r|s,l+=r;l>0;t[n+d]=255&a,d+=p,a/=256,l-=8);t[n+d-p]|=128*m}},{}],119:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],120:[function(t,e,n){"use strict";function i(t){return function(){return t}}function r(t,e,n){return t*(1-n)+e*n}function o(t,e,n){for(var i=[],o=0;o<t.length;o++)i[o]=r(t[o],e[o],n);return i}n.interpolated=function(t){if(!t.stops)return i(t);var e=t.stops,n=t.base||1,a=Array.isArray(e[0][1])?o:r;return function(t){for(var i,r,o=0;o<e.length;o++){var s=e[o];if(s[0]<=t&&(i=s),s[0]>t){r=s;break}}if(i&&r){var u=r[0]-i[0],l=t-i[0],c=1===n?l/u:(Math.pow(n,l)-1)/(Math.pow(n,u)-1);return a(i[1],r[1],c)}return i?i[1]:r?r[1]:void 0}},n["piecewise-constant"]=function(t){if(!t.stops)return i(t);var e=t.stops;return function(t){for(var n=0;n<e.length;n++)if(e[n][0]>t)return e[0===n?0:n-1][1];return e[e.length-1][1]}}},{}],121:[function(t,e,n){"use strict";function i(t,e){this.message=(t?t+": ":"")+r.apply(r,Array.prototype.slice.call(arguments,2)),null!==e&&void 0!==e&&e.__line__&&(this.line=e.__line__)}var r=t("util").format;e.exports=i},{util:156}],122:[function(t,e,n){"use strict";e.exports=function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}},{}],123:[function(t,e,n){"use strict";e.exports=function(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}},{}],124:[function(t,e,n){"use strict";e.exports=function(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}},{}],125:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/get_type"),o=t("../util/extend");e.exports=function(e){var n=t("./validate_function"),a=t("./validate_object"),s={"*":function(){return[]},array:t("./validate_array"),"boolean":t("./validate_boolean"),number:t("./validate_number"),color:t("./validate_color"),constants:t("./validate_constants"),"enum":t("./validate_enum"),filter:t("./validate_filter"),"function":t("./validate_function"),layer:t("./validate_layer"),object:t("./validate_object"),source:t("./validate_source"),string:t("./validate_string")},u=e.value,l=e.valueSpec,c=e.key,h=e.styleSpec,f=e.style;if("string"===r(u)&&"@"===u[0]){if(h.$version>7)return[new i(c,u,"constants have been deprecated as of v8")];if(!(u in f.constants))return[new i(c,u,'constant "%s" not found',u)];e=o({},e,{value:f.constants[u]})}return l["function"]&&"object"===r(u)?n(e):l.type&&s[l.type]?s[l.type](e):a(o({},e,{valueSpec:l.type?h[l.type]:l}))}},{"../error/validation_error":121,"../util/extend":122,"../util/get_type":123,"./validate_array":126,"./validate_boolean":127,"./validate_color":128,"./validate_constants":129,"./validate_enum":130,"./validate_filter":131,"./validate_function":132,"./validate_layer":133,"./validate_number":135,"./validate_object":136,"./validate_source":138,"./validate_string":139}],126:[function(t,e,n){"use strict";var i=t("../util/get_type"),r=t("./validate"),o=t("../error/validation_error");e.exports=function(t){var e=t.value,n=t.valueSpec,a=t.style,s=t.styleSpec,u=t.key,l=t.arrayElementValidator||r;if("array"!==i(e))return[new o(u,e,"array expected, %s found",i(e))];if(n.length&&e.length!==n.length)return[new o(u,e,"array length %d expected, length %d found",n.length,e.length)];if(n["min-length"]&&e.length<n["min-length"])return[new o(u,e,"array length at least %d expected, length %d found",n["min-length"],e.length)];var c={type:n.value};s.$version<7&&(c["function"]=n["function"]),"object"===i(n.value)&&(c=n.value);for(var h=[],f=0;f<e.length;f++)h=h.concat(l({array:e,arrayIndex:f,value:e[f],valueSpec:c,style:a,styleSpec:s,key:u+"["+f+"]"}));return h}},{"../error/validation_error":121,"../util/get_type":123,"./validate":125}],127:[function(t,e,n){"use strict";var i=t("../util/get_type"),r=t("../error/validation_error");e.exports=function(t){var e=t.value,n=t.key,o=i(e);return"boolean"!==o?[new r(n,e,"boolean expected, %s found",o)]:[]}},{"../error/validation_error":121,"../util/get_type":123}],128:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/get_type"),o=t("csscolorparser").parseCSSColor;e.exports=function(t){var e=t.key,n=t.value,a=r(n);return"string"!==a?[new i(e,n,"color expected, %s found",a)]:null===o(n)?[new i(e,n,'color expected, "%s" found',n)]:[]}},{"../error/validation_error":121,"../util/get_type":123,csscolorparser:99}],129:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/get_type");e.exports=function(t){var e=t.key,n=t.value,o=t.styleSpec;if(o.$version>7)return n?[new i(e,n,"constants have been deprecated as of v8")]:[];var a=r(n);if("object"!==a)return[new i(e,n,"object expected, %s found",a)];var s=[];for(var u in n)"@"!==u[0]&&s.push(new i(e+"."+u,n[u],'constants must start with "@"'));return s}},{"../error/validation_error":121,"../util/get_type":123}],130:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/unbundle_jsonlint");e.exports=function(t){var e=t.key,n=t.value,o=t.valueSpec,a=[];return-1===o.values.indexOf(r(n))&&a.push(new i(e,n,"expected one of [%s], %s found",o.values.join(", "),n)),a}},{"../error/validation_error":121,"../util/unbundle_jsonlint":124}],131:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("./validate_enum"),o=t("../util/get_type"),a=t("../util/unbundle_jsonlint");e.exports=function s(t){var e,n=t.value,u=t.key,l=t.styleSpec,c=[];if("array"!==o(n))return[new i(u,n,"array expected, %s found",o(n))];if(n.length<1)return[new i(u,n,"filter array must have at least 1 element")];switch(c=c.concat(r({key:u+"[0]",value:n[0],valueSpec:l.filter_operator,style:t.style,styleSpec:t.styleSpec})),a(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"==n[1]&&c.push(new i(u,n,'"$type" cannot be use with operator "%s"',n[0]));case"==":case"!=":3!=n.length&&c.push(new i(u,n,'filter array for operator "%s" must have 3 elements',n[0]));case"in":case"!in":n.length>=2&&(e=o(n[1]),"string"!==e?c.push(new i(u+"[1]",n[1],"string expected, %s found",e)):"@"===n[1][0]&&c.push(new i(u+"[1]",n[1],"filter key cannot be a constant")));for(var h=2;h<n.length;h++)e=o(n[h]),"$type"==n[1]?c=c.concat(r({key:u+"["+h+"]",value:n[h],valueSpec:l.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"===e&&"@"===n[h][0]?c.push(new i(u+"["+h+"]",n[h],"filter value cannot be a constant")):"string"!==e&&"number"!==e&&"boolean"!==e&&c.push(new i(u+"["+h+"]",n[h],"string, number, or boolean expected, %s found",e));break;case"any":case"all":case"none":for(h=1;h<n.length;h++)c=c.concat(s({key:u+"["+h+"]",value:n[h],style:t.style,styleSpec:t.styleSpec}))}return c}},{"../error/validation_error":121,"../util/get_type":123,"../util/unbundle_jsonlint":124,"./validate_enum":130}],132:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/get_type"),o=t("./validate"),a=t("./validate_object"),s=t("./validate_array");e.exports=function(t){function e(t){var e=[],o=t.value;return e=e.concat(s({key:t.key,value:o,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:n})),"array"===r(o)&&0===o.length&&e.push(new i(t.key,o,"array must have at least one stop")),e}function n(t){var e=[],n=t.value,a=t.key;return"array"!==r(n)?[new i(a,n,"array expected, %s found",r(n))]:2!==n.length?[new i(a,n,"array length %d expected, length %d found",2,n.length)]:(e=e.concat(o({key:a+"[0]",value:n[0],valueSpec:{type:"number"},style:t.style,styleSpec:t.styleSpec})),e=e.concat(o({key:a+"[1]",value:n[1],valueSpec:u,style:t.style,styleSpec:t.styleSpec})),"number"===r(n[0])&&("piecewise-constant"===u["function"]&&n[0]%1!==0&&e.push(new i(a+"[0]",n[0],"zoom level for piecewise-constant functions must be an integer")),0!==t.arrayIndex&&n[0]<t.array[t.arrayIndex-1][0]&&e.push(new i(a+"[0]",n[0],"array stops must appear in ascending order"))),e)}var u=t.valueSpec;return a({key:t.key,value:t.value,valueSpec:t.styleSpec["function"],style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:e}})}},{"../error/validation_error":121,"../util/get_type":123,"./validate":125,"./validate_array":126,"./validate_object":136}],133:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/unbundle_jsonlint"),o=t("./validate_object"),a=t("./validate_filter"),s=t("./validate_paint_property"),u=t("./validate_layout_property"),l=t("../util/extend");
e.exports=function(t){var e=[],n=t.value,c=t.key,h=t.style,f=t.styleSpec;n.type||n.ref||e.push(new i(c,n,'either "type" or "ref" is required'));var d=r(n.type),p=r(n.ref);if(n.id)for(var m=0;m<t.arrayIndex;m++){var v=h.layers[m];r(v.id)===r(n.id)&&e.push(new i(c,n.id,'duplicate layer id "%s", previously used at line %d',n.id,v.id.__line__))}if("ref"in n){["type","source","source-layer","filter","layout"].forEach(function(t){t in n&&e.push(new i(c,n[t],'"%s" is prohibited for ref layers',t))});var y;h.layers.forEach(function(t){t.id==p&&(y=t)}),y?y.ref?e.push(new i(c,n.ref,"ref cannot reference another ref layer")):d=r(y.type):e.push(new i(c,n.ref,'ref layer "%s" not found',p))}else if("background"!==d)if(n.source){var g=h.sources[n.source];g?"vector"==g.type&&"raster"==d?e.push(new i(c,n.source,'layer "%s" requires a raster source',n.id)):"raster"==g.type&&"raster"!=d?e.push(new i(c,n.source,'layer "%s" requires a vector source',n.id)):"vector"!=g.type||n["source-layer"]||e.push(new i(c,n,'layer "%s" must specify a "source-layer"',n.id)):e.push(new i(c,n.source,'source "%s" not found',n.source))}else e.push(new i(c,n,'missing required property "source"'));return e=e.concat(o({key:c,value:n,valueSpec:f.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{filter:a,layout:function(t){return o({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return u(l({layerType:d},t))}}})},paint:function(t){return o({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return s(l({layerType:d},t))}}})}}}))}},{"../error/validation_error":121,"../util/extend":122,"../util/unbundle_jsonlint":124,"./validate_filter":131,"./validate_layout_property":134,"./validate_object":136,"./validate_paint_property":137}],134:[function(t,e,n){"use strict";var i=t("./validate"),r=t("../error/validation_error");e.exports=function(t){var e=t.key,n=t.style,o=t.styleSpec,a=t.value,s=t.objectKey,u=o["layout_"+t.layerType];return t.valueSpec||u[s]?i({key:t.key,value:a,valueSpec:t.valueSpec||u[s],style:n,styleSpec:o}):[new r(e,a,'unknown property "%s"',s)]}},{"../error/validation_error":121,"./validate":125}],135:[function(t,e,n){"use strict";var i=t("../util/get_type"),r=t("../error/validation_error");e.exports=function(t){var e=t.key,n=t.value,o=t.valueSpec,a=i(n);return"number"!==a?[new r(e,n,"number expected, %s found",a)]:"minimum"in o&&n<o.minimum?[new r(e,n,"%s is less than the minimum value %s",n,o.minimum)]:"maximum"in o&&n>o.maximum?[new r(e,n,"%s is greater than the maximum value %s",n,o.maximum)]:[]}},{"../error/validation_error":121,"../util/get_type":123}],136:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/get_type"),o=t("./validate");e.exports=function(t){var e=t.key,n=t.value,a=t.valueSpec,s=t.objectElementValidators||{},u=t.style,l=t.styleSpec,c=[],h=r(n);if("object"!==h)return[new i(e,n,"object expected, %s found",h)];for(var f in n){var d=f.split(".")[0],p=a&&(a[d]||a["*"]),m=s[d]||s["*"];p||m?c=c.concat((m||o)({key:(e?e+".":e)+f,value:n[f],valueSpec:p,style:u,styleSpec:l,object:n,objectKey:f})):""!==e&&1!==e.split(".").length&&c.push(new i(e,n[f],'unknown property "%s"',f))}for(d in a)a[d].required&&void 0===a[d]["default"]&&void 0===n[d]&&c.push(new i(e,n,'missing required property "%s"',d));return c}},{"../error/validation_error":121,"../util/get_type":123,"./validate":125}],137:[function(t,e,n){"use strict";var i=t("./validate"),r=t("../error/validation_error");e.exports=function(t){var e=t.key,n=t.style,o=t.styleSpec,a=t.value,s=t.objectKey,u=o["paint_"+t.layerType],l=s.match(/^(.*)-transition$/);return l&&u[l[1]]&&u[l[1]].transition?i({key:e,value:a,valueSpec:o.transition,style:n,styleSpec:o}):t.valueSpec||u[s]?i({key:t.key,value:a,valueSpec:t.valueSpec||u[s],style:n,styleSpec:o}):[new r(e,a,'unknown property "%s"',s)]}},{"../error/validation_error":121,"./validate":125}],138:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/unbundle_jsonlint"),o=t("./validate_object"),a=t("./validate_enum");e.exports=function(t){var e=t.value,n=t.key,s=t.styleSpec,u=t.style;if(!e.type)return[new i(n,e,'"type" is required')];var l=r(e.type);switch(l){case"vector":case"raster":var c=[];if(c=c.concat(o({key:n,value:e,valueSpec:s.source_tile,style:t.style,styleSpec:s})),"url"in e)for(var h in e)["type","url","tileSize"].indexOf(h)<0&&c.push(new i(n+"."+h,e[h],'a source with a "url" property may not include a "%s" property',h));return c;case"geojson":return o({key:n,value:e,valueSpec:s.source_geojson,style:u,styleSpec:s});case"video":return o({key:n,value:e,valueSpec:s.source_video,style:u,styleSpec:s});case"image":return o({key:n,value:e,valueSpec:s.source_image,style:u,styleSpec:s});default:return a({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","geojson","video","image"]},style:u,styleSpec:s})}}},{"../error/validation_error":121,"../util/unbundle_jsonlint":124,"./validate_enum":130,"./validate_object":136}],139:[function(t,e,n){"use strict";var i=t("../util/get_type"),r=t("../error/validation_error");e.exports=function(t){var e=t.value,n=t.key,o=i(e);return"string"!==o?[new r(n,e,"string expected, %s found",o)]:[]}},{"../error/validation_error":121,"../util/get_type":123}],140:[function(t,e,n){"use strict";function i(t,e){e=e||u;var n=[];return n=n.concat(s({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t})),e.$version>7&&t.constants&&(n=n.concat(a({key:"constants",value:t.constants,style:t,styleSpec:e}))),r(n)}function r(t){return[].concat(t).sort(function(t,e){return t.line-e.line})}function o(t){return function(){return r(t.apply(this,arguments))}}var a=t("./validate/validate_constants"),s=t("./validate/validate"),u=t("../reference/latest.min");i.source=o(t("./validate/validate_source")),i.layer=o(t("./validate/validate_layer")),i.filter=o(t("./validate/validate_filter")),i.paintProperty=o(t("./validate/validate_paint_property")),i.layoutProperty=o(t("./validate/validate_layout_property")),e.exports=i},{"../reference/latest.min":142,"./validate/validate":125,"./validate/validate_constants":129,"./validate/validate_filter":131,"./validate/validate_layer":133,"./validate/validate_layout_property":134,"./validate/validate_paint_property":137,"./validate/validate_source":138}],141:[function(t,e,n){e.exports=t("./v8.json")},{"./v8.json":143}],142:[function(t,e,n){e.exports=t("./v8.min.json")},{"./v8.min.json":144}],143:[function(t,e,n){e.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8],doc:"Stylesheet version number. Must be 8.",example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:"Arbitrary properties useful to track with the stylesheet, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number","default":0,period:360,units:"degrees",doc:"Default bearing, in degrees.  The style bearing will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:29},pitch:{type:"number","default":0,units:"degrees",doc:"Default pitch, in degrees. Zero is perpendicular to the surface.  The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},sources:{required:!0,type:"sources",doc:"Data source specifications.",example:{"mapbox-streets":{type:"vector",url:"mapbox://mapbox.mapbox-streets-v6"}}},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended.",example:"mapbox://sprites/mapbox/bright-v8"},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. Valid tokens are {fontstack} and {range}.",example:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},transition:{type:"transition",doc:"A global transition definition to use as a default across properties.",example:{duration:300,delay:0}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array.",example:[{id:"water",source:"mapbox-streets","source-layer":"water",type:"fill",paint:{"fill-color":"#00ffff"}}]}},sources:{"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For GeoJSON and video sources, a URL must be provided."}},source:["source_tile","source_geojson","source_video","source_image"],source_tile:{type:{required:!0,type:"enum",values:["vector","raster"],doc:"The data type of the tile source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<mapid>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},minzoom:{type:"number","default":0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number","default":22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number","default":512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},"*":{type:"*",doc:"Other keys to configure the data source."}},source_geojson:{type:{required:!0,type:"enum",values:["geojson"],doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number","default":14,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},buffer:{type:"number","default":64,doc:"Tile buffer size on each side (higher means fewer rendering artifacts near tile edges but slower performance)."},tolerance:{type:"number","default":3,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean","default":!1,doc:"If the data is a collection of point features, setting this to true clusters the points by radius into groups."},clusterRadius:{type:"number","default":400,doc:"Radius of each cluster when clustering points, relative to 4096 tile."},clusterMaxZoom:{type:"number",doc:"Max zoom to cluster points on. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered)."}},source_video:{type:{required:!0,type:"enum",values:["video"],doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},source_image:{type:{required:!0,type:"enum",values:["image"],doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image"},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},layer:{id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:["fill","line","symbol","circle","raster","background"],doc:"Rendering type of this layer."},metadata:{type:"*",doc:"Arbitrary properties useful to track with the layer, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},ref:{type:"string",doc:"References another layer to copy `type`, `source`, `source-layer`, `minzoom`, `maxzoom`, `filter`, and `layout` properties from. This allows the layers to share processing and be more efficient."},source:{type:"string",doc:"Name of a source description to be used for this layer."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required if the source supports multiple layers."},minzoom:{type:"number",minimum:0,maximum:22,doc:"The minimum zoom level on which the layer gets parsed and appears on."},maxzoom:{type:"number",minimum:0,maximum:22,doc:"The maximum zoom level on which the layer gets parsed and appears on."},interactive:{type:"boolean",doc:"Enable querying of feature data from this layer for interactivity.","default":!1},filter:{type:"filter",doc:"A expression specifying conditions on source features. Only features that match the filter are displayed."},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."},"paint.*":{type:"paint",doc:"Class-specific paint properties for this layer. The class name is the part after the first dot."}},layout:["layout_fill","layout_line","layout_circle","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer."}},layout_fill:{visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer."}},layout_circle:{visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer."}},layout_line:{"line-cap":{type:"enum","function":"piecewise-constant",values:["butt","round","square"],"default":"butt",doc:"The display of line endings."},"line-join":{type:"enum","function":"piecewise-constant",values:["bevel","round","miter"],"default":"miter",doc:"The display of lines when joining."},"line-miter-limit":{type:"number","default":2,"function":"interpolated",doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number","default":1.05,"function":"interpolated",doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}]},visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer."}},layout_symbol:{"symbol-placement":{type:"enum","function":"piecewise-constant",values:["point","line"],"default":"point",doc:"Label placement relative to its geometry. `line` can only be used on LineStrings and Polygons."},"symbol-spacing":{type:"number","default":250,minimum:1,"function":"interpolated",units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer."},"icon-allow-overlap":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"]},"icon-ignore-placement":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"]},"icon-optional":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum","function":"piecewise-constant",values:["map","viewport"],"default":"viewport",doc:"Orientation of icon when map is rotated.",requires:["icon-image"]},"icon-size":{type:"number","default":1,minimum:0,"function":"interpolated",doc:"Scale factor for icon. 1 is original size, 3 triples the size.",requires:["icon-image"]},"icon-image":{type:"string","function":"piecewise-constant",doc:"A string with {tokens} replaced, referencing the data property to pull from.",tokens:!0},"icon-rotate":{type:"number","default":0,period:360,"function":"interpolated",units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"]},"icon-padding":{type:"number","default":2,minimum:0,"function":"interpolated",units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"]},"icon-keep-upright":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"]},"text-rotation-alignment":{type:"enum","function":"piecewise-constant",values:["map","viewport"],"default":"viewport",doc:"Orientation of text when map is rotated.",requires:["text-field"]},"text-field":{type:"string","function":"piecewise-constant","default":"",tokens:!0,doc:"Value to use for a text label. Feature properties are specified using tokens like {field_name}."},"text-font":{type:"array",value:"string","function":"piecewise-constant","default":["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"]},"text-size":{type:"number","default":16,minimum:0,units:"pixels","function":"interpolated",doc:"Font size.",requires:["text-field"]},"text-max-width":{type:"number","default":10,minimum:0,units:"em","function":"interpolated",doc:"The maximum line width for text wrapping.",requires:["text-field"]},"text-line-height":{type:"number","default":1.2,units:"em","function":"interpolated",doc:"Text leading value for multi-line text.",requires:["text-field"]},"text-letter-spacing":{type:"number","default":0,units:"em","function":"interpolated",doc:"Text tracking amount.",requires:["text-field"]},"text-justify":{type:"enum","function":"piecewise-constant",values:["left","center","right"],"default":"center",doc:"Text justification options.",requires:["text-field"]},"text-anchor":{type:"enum","function":"piecewise-constant",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],"default":"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field"]},"text-max-angle":{type:"number","default":45,units:"degrees","function":"interpolated",doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number","default":0,period:360,units:"degrees","function":"interpolated",doc:"Rotates the text clockwise.",requires:["text-field"]},"text-padding":{type:"number","default":2,minimum:0,units:"pixels","function":"interpolated",doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"]},"text-keep-upright":{type:"boolean","function":"piecewise-constant","default":!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum","function":"piecewise-constant",values:["none","uppercase","lowercase"],"default":"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"]},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up.",value:"number",units:"ems","function":"interpolated",length:2,"default":[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"]},"text-ignore-placement":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"]},"text-optional":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",requires:["text-field","icon-image"]},visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer."}},layout_raster:{visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer."}},filter:{type:"array",value:"*",doc:"A filter selects specific features from a layer."},filter_operator:{type:"enum",values:["==","!=",">",">=","<","<=","in","!in","all","any","none"],doc:"The filter operator."},geometry_type:{type:"enum",values:["Point","LineString","Polygon"],doc:"The geometry type for the filter to select."},color_operation:{type:"enum",values:["lighten","saturate","spin","fade","mix"],doc:"A color operation to apply."},"function":{stops:{type:"array",required:!0,doc:"An array of stops.",value:"function_stop"},base:{type:"number","default":1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2,doc:"Zoom level and value pair."},paint:["paint_fill","paint_line","paint_circle","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean","function":"piecewise-constant","default":!0,doc:"Whether or not the fill should be antialiased."},"fill-opacity":{type:"number","function":"interpolated","default":1,minimum:0,maximum:1,doc:"The opacity given to the fill color.",transition:!0},"fill-color":{type:"color","default":"#000000",doc:"The color of the fill.","function":"interpolated",transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.","function":"interpolated",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"fill-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)","default":"map",requires:["fill-translate"]},"fill-pattern":{type:"string","function":"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512)."}},paint_line:{"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.","function":"interpolated","default":1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",doc:"The color with which the line will be drawn.","default":"#000000","function":"interpolated",transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"line-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)","default":"map",requires:["line-translate"]},"line-width":{type:"number","default":1,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Stroke thickness."},"line-gap-width":{type:"number","default":0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.","function":"interpolated",transition:!0,units:"pixels"},"line-offset":{type:"number","default":0,doc:'The line\'s offset perpendicular to its direction. Values may be positive or negative, where positive indicates "rightwards" (if you were moving in the direction of the line) and negative indicates "leftwards."',"function":"interpolated",transition:!0,units:"pixels"},"line-blur":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels."},"line-dasharray":{type:"array",value:"number","function":"piecewise-constant",doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string","function":"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512)."}},paint_circle:{"circle-radius":{type:"number","default":5,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Circle radius."},"circle-color":{type:"color","default":"#000000",doc:"The color of the circle.","function":"interpolated",transition:!0},"circle-blur":{type:"number","default":0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.","function":"interpolated",transition:!0},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"circle-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)","default":"map",requires:["circle-translate"]}},paint_symbol:{"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0,requires:["icon-image"]},"icon-color":{type:"color","default":"#000000","function":"interpolated",transition:!0,doc:"The color of the icon. This can only be used with sdf icons.",requires:["icon-image"]},"icon-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated",transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with sdf icons.",requires:["icon-image"]},"icon-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"]},"icon-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"]},"icon-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen).","default":"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0,requires:["text-field"]},"text-color":{type:"color",doc:"The color with which the text will be drawn.","default":"#000000","function":"interpolated",transition:!0,requires:["text-field"]},"text-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated",transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"]},"text-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"]},"text-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels",doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"]},"text-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen).","default":"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0},"raster-hue-rotate":{type:"number","default":0,period:360,"function":"interpolated",transition:!0,units:"degrees",doc:"Rotates hues around the color wheel."},"raster-brightness-min":{type:"number","function":"interpolated",doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.","default":0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number","function":"interpolated",doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.","default":1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.","default":0,minimum:-1,maximum:1,"function":"interpolated",transition:!0},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.","default":0,minimum:-1,maximum:1,"function":"interpolated",transition:!0},"raster-fade-duration":{type:"number","default":300,minimum:0,"function":"interpolated",transition:!0,units:"milliseconds",doc:"Fade duration when a new tile is added."}},paint_background:{"background-color":{type:"color","default":"#000000",doc:"The color with which the background will be drawn.","function":"interpolated",transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string","function":"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512)."},"background-opacity":{type:"number","default":1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.","function":"interpolated",transition:!0}},transition:{duration:{type:"number","default":300,minimum:0,units:"milliseconds",
doc:"Time allotted for transitions to complete."},delay:{type:"number","default":0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}}}},{}],144:[function(t,e,n){e.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number","default":0,period:360,units:"degrees"},pitch:{type:"number","default":0,units:"degrees"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_tile","source_geojson","source_video","source_image"],source_tile:{type:{required:!0,type:"enum",values:["vector","raster"]},url:{type:"string"},tiles:{type:"array",value:"string"},minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},tileSize:{type:"number","default":512,units:"pixels"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:["geojson"]},data:{type:"*"},maxzoom:{type:"number","default":14},buffer:{type:"number","default":64},tolerance:{type:"number","default":3},cluster:{type:"boolean","default":!1},clusterRadius:{type:"number","default":400},clusterMaxZoom:{type:"number"}},source_video:{type:{required:!0,type:"enum",values:["video"]},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:["image"]},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:["fill","line","symbol","circle","raster","background"]},metadata:{type:"*"},ref:{type:"string"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:22},maxzoom:{type:"number",minimum:0,maximum:22},interactive:{type:"boolean","default":!1},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"},"paint.*":{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible"}},layout_fill:{visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible"}},layout_circle:{visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible"}},layout_line:{"line-cap":{type:"enum","function":"piecewise-constant",values:["butt","round","square"],"default":"butt"},"line-join":{type:"enum","function":"piecewise-constant",values:["bevel","round","miter"],"default":"miter"},"line-miter-limit":{type:"number","default":2,"function":"interpolated",requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number","default":1.05,"function":"interpolated",requires:[{"line-join":"round"}]},visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible"}},layout_symbol:{"symbol-placement":{type:"enum","function":"piecewise-constant",values:["point","line"],"default":"point"},"symbol-spacing":{type:"number","default":250,minimum:1,"function":"interpolated",units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean","function":"piecewise-constant","default":!1},"icon-allow-overlap":{type:"boolean","function":"piecewise-constant","default":!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean","function":"piecewise-constant","default":!1,requires:["icon-image"]},"icon-optional":{type:"boolean","function":"piecewise-constant","default":!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum","function":"piecewise-constant",values:["map","viewport"],"default":"viewport",requires:["icon-image"]},"icon-size":{type:"number","default":1,minimum:0,"function":"interpolated",requires:["icon-image"]},"icon-image":{type:"string","function":"piecewise-constant",tokens:!0},"icon-rotate":{type:"number","default":0,period:360,"function":"interpolated",units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number","default":2,minimum:0,"function":"interpolated",units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean","function":"piecewise-constant","default":!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",requires:["icon-image"]},"text-rotation-alignment":{type:"enum","function":"piecewise-constant",values:["map","viewport"],"default":"viewport",requires:["text-field"]},"text-field":{type:"string","function":"piecewise-constant","default":"",tokens:!0},"text-font":{type:"array",value:"string","function":"piecewise-constant","default":["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number","default":16,minimum:0,units:"pixels","function":"interpolated",requires:["text-field"]},"text-max-width":{type:"number","default":10,minimum:0,units:"em","function":"interpolated",requires:["text-field"]},"text-line-height":{type:"number","default":1.2,units:"em","function":"interpolated",requires:["text-field"]},"text-letter-spacing":{type:"number","default":0,units:"em","function":"interpolated",requires:["text-field"]},"text-justify":{type:"enum","function":"piecewise-constant",values:["left","center","right"],"default":"center",requires:["text-field"]},"text-anchor":{type:"enum","function":"piecewise-constant",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],"default":"center",requires:["text-field"]},"text-max-angle":{type:"number","default":45,units:"degrees","function":"interpolated",requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number","default":0,period:360,units:"degrees","function":"interpolated",requires:["text-field"]},"text-padding":{type:"number","default":2,minimum:0,units:"pixels","function":"interpolated",requires:["text-field"]},"text-keep-upright":{type:"boolean","function":"piecewise-constant","default":!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum","function":"piecewise-constant",values:["none","uppercase","lowercase"],"default":"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems","function":"interpolated",length:2,"default":[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean","function":"piecewise-constant","default":!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean","function":"piecewise-constant","default":!1,requires:["text-field"]},"text-optional":{type:"boolean","function":"piecewise-constant","default":!1,requires:["text-field","icon-image"]},visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible"}},layout_raster:{visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:["==","!=",">",">=","<","<=","in","!in","all","any","none"]},geometry_type:{type:"enum",values:["Point","LineString","Polygon"]},color_operation:{type:"enum",values:["lighten","saturate","spin","fade","mix"]},"function":{stops:{type:"array",required:!0,value:"function_stop"},base:{type:"number","default":1,minimum:0}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},paint:["paint_fill","paint_line","paint_circle","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean","function":"piecewise-constant","default":!0},"fill-opacity":{type:"number","function":"interpolated","default":1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color","default":"#000000","function":"interpolated",transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color","function":"interpolated",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],"default":"map",requires:["fill-translate"]},"fill-pattern":{type:"string","function":"piecewise-constant",transition:!0}},paint_line:{"line-opacity":{type:"number","function":"interpolated","default":1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color","default":"#000000","function":"interpolated",transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],"default":"map",requires:["line-translate"]},"line-width":{type:"number","default":1,minimum:0,"function":"interpolated",transition:!0,units:"pixels"},"line-gap-width":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels"},"line-offset":{type:"number","default":0,"function":"interpolated",transition:!0,units:"pixels"},"line-blur":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number","function":"piecewise-constant",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string","function":"piecewise-constant",transition:!0}},paint_circle:{"circle-radius":{type:"number","default":5,minimum:0,"function":"interpolated",transition:!0,units:"pixels"},"circle-color":{type:"color","default":"#000000","function":"interpolated",transition:!0},"circle-blur":{type:"number","default":0,"function":"interpolated",transition:!0},"circle-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],"default":"map",requires:["circle-translate"]}},paint_symbol:{"icon-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0,requires:["icon-image"]},"icon-color":{type:"color","default":"#000000","function":"interpolated",transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated",transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],"default":"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0,requires:["text-field"]},"text-color":{type:"color","default":"#000000","function":"interpolated",transition:!0,requires:["text-field"]},"text-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated",transition:!0,requires:["text-field"]},"text-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],"default":"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0},"raster-hue-rotate":{type:"number","default":0,period:360,"function":"interpolated",transition:!0,units:"degrees"},"raster-brightness-min":{type:"number","function":"interpolated","default":0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number","function":"interpolated","default":1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number","default":0,minimum:-1,maximum:1,"function":"interpolated",transition:!0},"raster-contrast":{type:"number","default":0,minimum:-1,maximum:1,"function":"interpolated",transition:!0},"raster-fade-duration":{type:"number","default":300,minimum:0,"function":"interpolated",transition:!0,units:"milliseconds"}},paint_background:{"background-color":{type:"color","default":"#000000","function":"interpolated",transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string","function":"piecewise-constant",transition:!0},"background-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0}},transition:{duration:{type:"number","default":300,minimum:0,units:"milliseconds"},delay:{type:"number","default":0,minimum:0,units:"milliseconds"}}}},{}],145:[function(t,e,n){(function(t){function e(t,e){for(var n=0,i=t.length-1;i>=0;i--){var r=t[i];"."===r?t.splice(i,1):".."===r?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function i(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return r.exec(t).slice(1)};n.resolve=function(){for(var n="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var a=o>=0?arguments[o]:t.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(n=a+"/"+n,r="/"===a.charAt(0))}return n=e(i(n.split("/"),function(t){return!!t}),!r).join("/"),(r?"/":"")+n||"."},n.normalize=function(t){var r=n.isAbsolute(t),o="/"===a(t,-1);return t=e(i(t.split("/"),function(t){return!!t}),!r).join("/"),t||r||(t="."),t&&o&&(t+="/"),(r?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(i(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},n.relative=function(t,e){function i(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var r=i(t.split("/")),o=i(e.split("/")),a=Math.min(r.length,o.length),s=a,u=0;a>u;u++)if(r[u]!==o[u]){s=u;break}for(var l=[],u=s;u<r.length;u++)l.push("..");return l=l.concat(o.slice(s)),l.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){var e=o(t),n=e[0],i=e[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},n.basename=function(t,e){var n=o(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return o(t)[3]};var a="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return 0>e&&(e=t.length+e),t.substr(e,n)}}).call(this,t("_process"))},{_process:149}],146:[function(t,e,n){"use strict";function i(t){var e;t&&t.length&&(e=t,t=e.length);var n=new Uint8Array(t||0);return e&&n.set(e),n.readUInt32LE=o.readUInt32LE,n.writeUInt32LE=o.writeUInt32LE,n.readInt32LE=o.readInt32LE,n.writeInt32LE=o.writeInt32LE,n.readFloatLE=o.readFloatLE,n.writeFloatLE=o.writeFloatLE,n.readDoubleLE=o.readDoubleLE,n.writeDoubleLE=o.writeDoubleLE,n.toString=o.toString,n.write=o.write,n.slice=o.slice,n.copy=o.copy,n._isBuffer=!0,n}function r(t){for(var e,n,i=t.length,r=[],o=0;i>o;o++){if(e=t.charCodeAt(o),e>55295&&57344>e){if(!n){e>56319||o+1===i?r.push(239,191,189):n=e;continue}if(56320>e){r.push(239,191,189),n=e;continue}e=n-55296<<10|e-56320|65536,n=null}else n&&(r.push(239,191,189),n=null);128>e?r.push(e):2048>e?r.push(e>>6|192,63&e|128):65536>e?r.push(e>>12|224,e>>6&63|128,63&e|128):r.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}return r}e.exports=i;var o,a,s,u=t("ieee754");o={readUInt32LE:function(t){return(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},writeUInt32LE:function(t,e){this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24},readInt32LE:function(t){return(this[t]|this[t+1]<<8|this[t+2]<<16)+(this[t+3]<<24)},readFloatLE:function(t){return u.read(this,t,!0,23,4)},readDoubleLE:function(t){return u.read(this,t,!0,52,8)},writeFloatLE:function(t,e){return u.write(this,t,e,!0,23,4)},writeDoubleLE:function(t,e){return u.write(this,t,e,!0,52,8)},toString:function(t,e,n){var i="",r="";e=e||0,n=Math.min(this.length,n||this.length);for(var o=e;n>o;o++){var a=this[o];127>=a?(i+=decodeURIComponent(r)+String.fromCharCode(a),r=""):r+="%"+a.toString(16)}return i+=decodeURIComponent(r)},write:function(t,e){for(var n=t===a?s:r(t),i=0;i<n.length;i++)this[e+i]=n[i]},slice:function(t,e){return this.subarray(t,e)},copy:function(t,e){e=e||0;for(var n=0;n<this.length;n++)t[e+n]=this[n]}},o.writeInt32LE=o.writeUInt32LE,i.byteLength=function(t){return a=t,s=r(t),s.length},i.isBuffer=function(t){return!(!t||!t._isBuffer)}},{ieee754:118}],147:[function(t,e,n){(function(n){"use strict";function i(t){this.buf=d.isBuffer(t)?t:new d(t||0),this.pos=0,this.length=this.buf.length}function r(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function o(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function a(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function s(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function u(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function l(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function c(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function h(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}e.exports=i;var d=n.Buffer||t("./buffer");i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var p=4294967296,m=1/p,v=Math.pow(2,63);i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,o=this.pos;t(r,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=this.buf.readUInt32LE(this.pos);return this.pos+=4,t},readSFixed32:function(){var t=this.buf.readInt32LE(this.pos);return this.pos+=4,t},readFixed64:function(){var t=this.buf.readUInt32LE(this.pos)+this.buf.readUInt32LE(this.pos+4)*p;return this.pos+=8,t},readSFixed64:function(){var t=this.buf.readUInt32LE(this.pos)+this.buf.readInt32LE(this.pos+4)*p;return this.pos+=8,t},readFloat:function(){var t=this.buf.readFloatLE(this.pos);return this.pos+=4,t},readDouble:function(){var t=this.buf.readDoubleLE(this.pos);return this.pos+=8,t},readVarint:function(){var t,e,n,i,r,o,a=this.buf;if(n=a[this.pos++],128>n)return n;if(n=127&n,i=a[this.pos++],128>i)return n|i<<7;if(i=(127&i)<<7,r=a[this.pos++],128>r)return n|i|r<<14;if(r=(127&r)<<14,o=a[this.pos++],128>o)return n|i|r|o<<21;if(t=n|i|r|(127&o)<<21,e=a[this.pos++],t+=268435456*(127&e),128>e)return t;if(e=a[this.pos++],t+=34359738368*(127&e),128>e)return t;if(e=a[this.pos++],t+=4398046511104*(127&e),128>e)return t;if(e=a[this.pos++],t+=562949953421312*(127&e),128>e)return t;if(e=a[this.pos++],t+=72057594037927940*(127&e),128>e)return t;if(e=a[this.pos++],t+=0x8000000000000000*(127&e),128>e)return t;throw new Error("Expected varint not more than 10 bytes")},readVarint64:function(){var t=this.pos,e=this.readVarint();if(v>e)return e;for(var n=this.pos-2;255===this.buf[n];)n--;t>n&&(n=t),e=0;for(var i=0;n-t+1>i;i++){var r=127&~this.buf[t+i];e+=4>i?r<<7*i:r*Math.pow(2,7*i)}return-e-1},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.buf.toString("utf8",this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.slice(this.pos,t);return this.pos=t,e},readPackedVarint:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readVarint());return e},readPackedSVarint:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new d(e);this.buf.copy(n),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.slice(0,this.length)},writeFixed32:function(t){this.realloc(4),this.buf.writeUInt32LE(t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),this.buf.writeInt32LE(t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),this.buf.writeInt32LE(-1&t,this.pos),this.buf.writeUInt32LE(Math.floor(t*m),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),this.buf.writeInt32LE(-1&t,this.pos),this.buf.writeInt32LE(Math.floor(t*m),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t,127>=t)this.realloc(1),this.buf[this.pos++]=t;else if(16383>=t)this.realloc(2),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127;else if(2097151>=t)this.realloc(3),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127|128,this.buf[this.pos++]=t>>>14&127;else if(268435455>=t)this.realloc(4),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127|128,this.buf[this.pos++]=t>>>14&127|128,this.buf[this.pos++]=t>>>21&127;else{for(var e=this.pos;t>=128;)this.realloc(1),this.buf[this.pos++]=255&t|128,t/=128;if(this.realloc(1),this.buf[this.pos++]=0|t,this.pos-e>10)throw new Error("Given varint doesn't fit into 10 bytes")}},writeSVarint:function(t){this.writeVarint(0>t?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t);var e=d.byteLength(t);this.writeVarint(e),this.realloc(e),this.buf.write(t,this.pos),this.pos+=e},writeFloat:function(t){this.realloc(4),this.buf.writeFloatLE(t,this.pos),this.pos+=4},writeDouble:function(t){this.realloc(8),this.buf.writeDoubleLE(t,this.pos),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;e>n;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n,r=127>=i?1:16383>=i?2:2097151>=i?3:268435455>=i?4:Math.ceil(Math.log(i)/(7*Math.LN2));if(r>1){this.realloc(r-1);for(var o=this.pos-1;o>=n;o--)this.buf[o+r-1]=this.buf[o]}this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,i.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){this.writeMessage(t,r,e)},writePackedSVarint:function(t,e){this.writeMessage(t,o,e)},writePackedBoolean:function(t,e){this.writeMessage(t,u,e)},writePackedFloat:function(t,e){this.writeMessage(t,a,e)},writePackedDouble:function(t,e){this.writeMessage(t,s,e)},writePackedFixed32:function(t,e){this.writeMessage(t,l,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,c,e)},writePackedFixed64:function(t,e){this.writeMessage(t,h,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,f,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./buffer":146}],148:[function(t,e,n){"use strict";function i(t,e){this.x=t,this.y=e}e.exports=i,i.prototype={clone:function(){return new i(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,r=n*this.x+e*this.y;return this.x=i,this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t}},{}],149:[function(t,e,n){function i(){c=!1,s.length?l=s.concat(l):h=-1,l.length&&r()}function r(){if(!c){var t=setTimeout(i);c=!0;for(var e=l.length;e;){for(s=l,l=[];++h<e;)s&&s[h].run();h=-1,e=l.length}s=null,c=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function a(){}var s,u=e.exports={},l=[],c=!1,h=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new o(t,e)),1!==l.length||c||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=a,u.addListener=a,u.once=a,u.off=a,u.removeListener=a,u.removeAllListeners=a,u.emit=a,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],150:[function(e,n,i){!function(){"use strict";function e(t,n){return this instanceof e?(this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),n&&this._initFormat(n),void this.clear()):new e(t,n)}function i(t,e){t.bbox=r(t,0,t.children.length,e)}function r(t,e,n,i){for(var r,s=o(),u=e;n>u;u++)r=t.children[u],a(s,t.leaf?i(r):r.bbox);return s}function o(){return[1/0,1/0,-(1/0),-(1/0)]}function a(t,e){return t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t}function s(t,e){return t.bbox[0]-e.bbox[0]}function u(t,e){return t.bbox[1]-e.bbox[1]}function l(t){return(t[2]-t[0])*(t[3]-t[1])}function c(t){return t[2]-t[0]+(t[3]-t[1])}function h(t,e){return(Math.max(e[2],t[2])-Math.min(e[0],t[0]))*(Math.max(e[3],t[3])-Math.min(e[1],t[1]))}function f(t,e){var n=Math.max(t[0],e[0]),i=Math.max(t[1],e[1]),r=Math.min(t[2],e[2]),o=Math.min(t[3],e[3]);return Math.max(0,r-n)*Math.max(0,o-i)}function d(t,e){return t[0]<=e[0]&&t[1]<=e[1]&&e[2]<=t[2]&&e[3]<=t[3]}function p(t,e){return e[0]<=t[2]&&e[1]<=t[3]&&e[2]>=t[0]&&e[3]>=t[1]}function m(t,e,n,i,r){for(var o,a=[e,n];a.length;)n=a.pop(),e=a.pop(),i>=n-e||(o=e+Math.ceil((n-e)/i/2)*i,v(t,e,n,o,r),a.push(e,o,o,n))}function v(t,e,n,i,r){for(var o,a,s,u,l,c,h,f,d;n>e;){for(n-e>600&&(o=n-e+1,a=i-e+1,s=Math.log(o),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(o-u)/o)*(0>a-o/2?-1:1),c=Math.max(e,Math.floor(i-a*u/o+l)),h=Math.min(n,Math.floor(i+(o-a)*u/o+l)),v(t,c,h,i,r)),f=t[i],a=e,d=n,y(t,e,i),r(t[n],f)>0&&y(t,e,n);d>a;){for(y(t,a,d),a++,d--;r(t[a],f)<0;)a++;for(;r(t[d],f)>0;)d--}0===r(t[e],f)?y(t,e,d):(d++,y(t,d,n)),i>=d&&(e=d+1),d>=i&&(n=d-1)}}function y(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!p(t,e.bbox))return n;for(var r,o,a,s,u=[];e;){for(r=0,o=e.children.length;o>r;r++)a=e.children[r],s=e.leaf?i(a):a.bbox,p(t,s)&&(e.leaf?n.push(a):d(t,s)?this._all(a,n):u.push(a));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!p(t,e.bbox))return!1;for(var i,r,o,a,s=[];e;){for(i=0,r=e.children.length;r>i;i++)if(o=e.children[i],a=e.leaf?n(o):o.bbox,p(t,a)){if(e.leaf||d(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;n>e;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data={children:[],height:1,bbox:o(),leaf:!0},this},remove:function(t){if(!t)return this;for(var e,n,i,r,o=this.data,a=this.toBBox(t),s=[],u=[];o||s.length;){if(o||(o=s.pop(),n=s[s.length-1],e=u.pop(),r=!0),o.leaf&&(i=o.children.indexOf(t),-1!==i))return o.children.splice(i,1),s.push(o),this._condense(s),this;r||o.leaf||!d(o.bbox,a)?n?(e++,o=n.children[e],r=!1):o=null:(s.push(o),u.push(e),e=0,n=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:function(t,e){return t[0]-e[0]},compareMinY:function(t,e){return t[1]-e[1]},toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),
t=n.pop();return e},_build:function(t,e,n,r){var o,a=n-e+1,s=this._maxEntries;if(s>=a)return o={children:t.slice(e,n+1),height:1,bbox:null,leaf:!0},i(o,this.toBBox),o;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),o={children:[],height:r,bbox:null,leaf:!1};var u,l,c,h,f=Math.ceil(a/s),d=f*Math.ceil(Math.sqrt(s));for(m(t,e,n,d,this.compareMinX),u=e;n>=u;u+=d)for(c=Math.min(u+d-1,n),m(t,u,c,f,this.compareMinY),l=u;c>=l;l+=f)h=Math.min(l+f-1,c),o.children.push(this._build(t,l,h,r-1));return i(o,this.toBBox),o},_chooseSubtree:function(t,e,n,i){for(var r,o,a,s,u,c,f,d;i.push(e),!e.leaf&&i.length-1!==n;){for(f=d=1/0,r=0,o=e.children.length;o>r;r++)a=e.children[r],u=l(a.bbox),c=h(t,a.bbox)-u,d>c?(d=c,f=f>u?u:f,s=a):c===d&&f>u&&(f=u,s=a);e=s}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t.bbox:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),a(s.bbox,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var a=this._chooseSplitIndex(n,o,r),s={children:n.children.splice(a,n.children.length-a),height:n.height,bbox:null,leaf:!1};n.leaf&&(s.leaf=!0),i(n,this.toBBox),i(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data={children:[t,e],height:t.height+1,bbox:null,leaf:!1},i(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,o,a,s,u,c,h,d;for(c=h=1/0,i=e;n-e>=i;i++)o=r(t,0,i,this.toBBox),a=r(t,i,n,this.toBBox),s=f(o,a),u=l(o)+l(a),c>s?(c=s,d=i,h=h>u?u:h):s===c&&h>u&&(h=u,d=i);return d},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:s,r=t.leaf?this.compareMinY:u,o=this._allDistMargin(t,e,n,i),a=this._allDistMargin(t,e,n,r);a>o&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var o,s,u=this.toBBox,l=r(t,0,e,u),h=r(t,n-e,n,u),f=c(l)+c(h);for(o=e;n-e>o;o++)s=t.children[o],a(l,t.leaf?u(s):s.bbox),f+=c(l);for(o=n-e-1;o>=e;o--)s=t.children[o],a(h,t.leaf?u(s):s.bbox),f+=c(h);return f},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)a(e[i].bbox,t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children,e.splice(e.indexOf(t[n]),1)):this.clear():i(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return [a"+t.join(", a")+"];")}},"function"==typeof t&&t.amd?t("rbush",function(){return e}):"undefined"!=typeof n?n.exports=e:"undefined"!=typeof self?self.rbush=e:window.rbush=e}()},{}],151:[function(e,n,i){void function(e,r){"function"==typeof t&&t.amd?t(r):"object"==typeof i?n.exports=r():e.resolveUrl=r()}(this,function(){function t(){var t=arguments.length;if(0===t)throw new Error("resolveUrl requires at least one argument; got none.");var e=document.createElement("base");if(e.href=arguments[0],1===t)return e.href;var n=document.getElementsByTagName("head")[0];n.insertBefore(e,n.firstChild);for(var i,r=document.createElement("a"),o=1;t>o;o++)r.href=arguments[o],i=r.href,e.href=i;return n.removeChild(e),i}return t})},{}],152:[function(t,e,n){"use strict";function i(t,e){this.width=t,this.height=e,this.shelves=[],this.stats={},this.count=function(t){this.stats[t]=(0|this.stats[t])+1}}function r(t,e,n){this.y=t,this.x=0,this.width=this.free=e,this.height=n}e.exports=i,i.prototype.allocate=function(t,e){for(var n,i,o=0,a={shelf:-1,waste:1/0},s=0;s<this.shelves.length;s++){if(n=this.shelves[s],o+=n.height,e===n.height&&t<=n.free)return this.count(e),n.alloc(t,e);e>n.height||t>n.free||e<n.height&&t<=n.free&&(i=n.height-e,i<a.waste&&(a.waste=i,a.shelf=s))}return-1!==a.shelf?(n=this.shelves[a.shelf],this.count(e),n.alloc(t,e)):e<=this.height-o&&t<=this.width?(n=new r(o,this.width,e),this.shelves.push(n),this.count(e),n.alloc(t,e)):{x:-1,y:-1}},i.prototype.resize=function(t,e){if(t<this.width||e<this.height)return!1;this.height=e,this.width=t;for(var n=0;n<this.shelves.length;n++)this.shelves[n].resize(t);return!0},r.prototype={alloc:function(t,e){if(t>this.free||e>this.height)return{x:-1,y:-1};var n=this.x;return this.x+=t,this.free-=t,{x:n,y:this.y,w:t,h:e}},resize:function(t){return t<this.width?!1:(this.free+=t-this.width,this.width=t,!0)}}},{}],153:[function(t,e,n){"use strict";function i(t){return new r(t)}function r(t){this.options=y(Object.create(this.options),t),this._initTrees()}function o(t){return[t.x,t.y,t.x,t.y]}function a(t,e){return t.x-e.x}function s(t,e){return t.y-e.y}function u(t,e){return{x:t,y:e,wx:t,wy:e,zoom:1/0,point:null,numPoints:1}}function l(t){var e=t.geometry.coordinates,n=u(f(e[0]),d(e[1]));return n.point=t,n}function c(t){return t.point?t.point:{type:"Feature",properties:h(t),geometry:{type:"Point",coordinates:[p(t.wx),m(t.wy)]}}}function h(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return{cluster:!0,point_count:e,point_count_abbreviated:n}}function f(t){return t/360+.5}function d(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return 0>n?0:n>1?1:n}function p(t){return 360*(t-.5)}function m(t){var e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function v(t,e){var n=t.wx-e.wx,i=t.wy-e.wy;return n*n+i*i}function y(t,e){for(var n in e)t[n]=e[n];return t}var g=t("rbush");e.exports=i,r.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:16,log:!1},load:function(t){var e=this.options.log;e&&console.time("total time");var n="prepare "+t.length+" points";e&&console.time(n);var i=t.map(l);e&&console.timeEnd(n);for(var r=this.options.maxZoom;r>=this.options.minZoom;r--){var o=+Date.now();this.trees[r+1].load(i),i=this._cluster(i,r),e&&console.log("z%d: %d clusters in %dms",r,i.length,+Date.now()-o)}return this.trees[this.options.minZoom].load(i),e&&console.timeEnd("total time"),this},getClusters:function(t,e){var n=[f(t[0]),d(t[3]),f(t[2]),d(t[1])],i=Math.max(this.options.minZoom,Math.min(e,this.options.maxZoom+1)),r=this.trees[i].search(n);return r.map(c)},getTile:function(t,e,n){var i=Math.pow(2,t),r=this.options.extent,o=this.options.radius/r,a=this.trees[t].search([(e-o)/i,(n-o)/i,(e+1+o)/i,(n+1+o)/i]);if(!a.length)return null;for(var s={features:[]},u=0;u<a.length;u++){var l=a[u],c={type:1,geometry:[[Math.round(r*(l.wx*i-e)),Math.round(r*(l.wy*i-n))]],tags:l.point?l.point.properties:h(l)};s.features.push(c)}return s},_initTrees:function(){this.trees=[];for(var t=0;t<=this.options.maxZoom+1;t++)this.trees[t]=g(this.options.nodeSize),this.trees[t].toBBox=o,this.trees[t].compareMinX=a,this.trees[t].compareMinY=s},_cluster:function(t,e){for(var n=[],i=this.options.radius/(this.options.extent*Math.pow(2,e)),r=[0,0,0,0],o=0;o<t.length;o++){var a=t[o];if(!(a.zoom<=e)){a.zoom=e,r[0]=a.wx-i,r[1]=a.wy-i,r[2]=a.wx+i,r[3]=a.wy+i;for(var s=this.trees[e+1].search(r),l=!1,c=a.numPoints,h=a.wx*c,f=a.wy*c,d=0;d<s.length;d++){var p=s[d];e<p.zoom&&v(a,p)<=i*i&&(l=!0,p.zoom=e,h+=p.wx*p.numPoints,f+=p.wy*p.numPoints,c+=p.numPoints)}if(l){var m=u(a.x,a.y);m.numPoints=c,m.wx=h/c,m.wy=f/c,n.push(m)}else n.push(a)}}return n}}},{rbush:150}],154:[function(t,e,n){function i(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}e.exports=i,i.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},i.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},i.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},i.prototype.solveCurveX=function(t,e){"undefined"==typeof e&&(e=1e-6);var n,i,r,o,a;for(r=t,a=0;8>a;a++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var s=this.sampleCurveDerivativeX(r);if(Math.abs(s)<1e-6)break;r-=o/s}if(n=0,i=1,r=t,n>r)return n;if(r>i)return i;for(;i>n;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r},i.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}},{}],155:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],156:[function(t,e,n){(function(e,i){function r(t,e){var i={seen:[],stylize:a};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),m(e)?i.showHidden=e:e&&n._extend(i,e),b(i.showHidden)&&(i.showHidden=!1),b(i.depth)&&(i.depth=2),b(i.colors)&&(i.colors=!1),b(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=o),u(i,t,i.depth)}function o(t,e){var n=r.styles[e];return n?"["+r.colors[n][0]+"m"+t+"["+r.colors[n][1]+"m":t}function a(t,e){return t}function s(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function u(t,e,i){if(t.customInspect&&e&&T(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(i,t);return _(r)||(r=u(t,r,i)),r}var o=l(t,e);if(o)return o;var a=Object.keys(e),m=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),E(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(e);if(0===a.length){if(T(e)){var v=e.name?": "+e.name:"";return t.stylize("[Function"+v+"]","special")}if(w(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(M(e))return t.stylize(Date.prototype.toString.call(e),"date");if(E(e))return c(e)}var y="",g=!1,x=["{","}"];if(p(e)&&(g=!0,x=["[","]"]),T(e)){var b=e.name?": "+e.name:"";y=" [Function"+b+"]"}if(w(e)&&(y=" "+RegExp.prototype.toString.call(e)),M(e)&&(y=" "+Date.prototype.toUTCString.call(e)),E(e)&&(y=" "+c(e)),0===a.length&&(!g||0==e.length))return x[0]+y+x[1];if(0>i)return w(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var S;return S=g?h(t,e,i,m,a):a.map(function(n){return f(t,e,i,m,n,g)}),t.seen.pop(),d(S,y,x)}function l(t,e){if(b(e))return t.stylize("undefined","undefined");if(_(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return g(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,i,r){for(var o=[],a=0,s=e.length;s>a;++a)k(e,String(a))?o.push(f(t,e,n,i,String(a),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(f(t,e,n,i,r,!0))}),o}function f(t,e,n,i,r,o){var a,s,l;if(l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]},l.get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),k(i,r)||(a="["+r+"]"),s||(t.seen.indexOf(l.value)<0?(s=v(n)?u(t,l.value,null):u(t,l.value,n-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),b(a)){if(o&&r.match(/^\d+$/))return s;a=JSON.stringify(""+r),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function d(t,e,n){var i=0,r=t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function p(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function v(t){return null===t}function y(t){return null==t}function g(t){return"number"==typeof t}function _(t){return"string"==typeof t}function x(t){return"symbol"==typeof t}function b(t){return void 0===t}function w(t){return S(t)&&"[object RegExp]"===I(t)}function S(t){return"object"==typeof t&&null!==t}function M(t){return S(t)&&"[object Date]"===I(t)}function E(t){return S(t)&&("[object Error]"===I(t)||t instanceof Error)}function T(t){return"function"==typeof t}function D(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function I(t){return Object.prototype.toString.call(t)}function z(t){return 10>t?"0"+t.toString(10):t.toString(10)}function A(){var t=new Date,e=[z(t.getHours()),z(t.getMinutes()),z(t.getSeconds())].join(":");return[t.getDate(),F[t.getMonth()],e].join(" ")}function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var L=/%[sdj%]/g;n.format=function(t){if(!_(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(r(arguments[n]));return e.join(" ")}for(var n=1,i=arguments,o=i.length,a=String(t).replace(L,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return t}}),s=i[n];o>n;s=i[++n])a+=v(s)||!S(s)?" "+s:" "+r(s);return a},n.deprecate=function(t,r){function o(){if(!a){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),a=!0}return t.apply(this,arguments)}if(b(i.process))return function(){return n.deprecate(t,r).apply(this,arguments)};if(e.noDeprecation===!0)return t;var a=!1;return o};var C,P={};n.debuglog=function(t){if(b(C)&&(C=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!P[t])if(new RegExp("\\b"+t+"\\b","i").test(C)){var i=e.pid;P[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,i,e)}}else P[t]=function(){};return P[t]},n.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=p,n.isBoolean=m,n.isNull=v,n.isNullOrUndefined=y,n.isNumber=g,n.isString=_,n.isSymbol=x,n.isUndefined=b,n.isRegExp=w,n.isObject=S,n.isDate=M,n.isError=E,n.isFunction=T,n.isPrimitive=D,n.isBuffer=t("./support/isBuffer");var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",A(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!S(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":155,_process:149,inherits:119}],157:[function(t,e,n){e.exports.VectorTile=t("./lib/vectortile.js"),e.exports.VectorTileFeature=t("./lib/vectortilefeature.js"),e.exports.VectorTileLayer=t("./lib/vectortilelayer.js")},{"./lib/vectortile.js":158,"./lib/vectortilefeature.js":159,"./lib/vectortilelayer.js":160}],158:[function(t,e,n){"use strict";function i(t,e){this.layers=t.readFields(r,{},e)}function r(t,e,n){if(3===t){var i=new o(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}var o=t("./vectortilelayer");e.exports=i},{"./vectortilelayer":160}],159:[function(t,e,n){"use strict";function i(t,e,n,i,o){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=o,t.readFields(r,this,e)}function r(t,e,n){1==t?e._id=n.readVarint():2==t?o(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function o(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var i=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[i]=r}}var a=t("point-geometry");e.exports=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,r=0,o=0,s=0,u=[];t.pos<n;){if(!r){var l=t.readVarint();i=7&l,r=l>>3}if(r--,1===i||2===i)o+=t.readSVarint(),s+=t.readSVarint(),1===i&&(e&&u.push(e),e=[]),e.push(new a(o,s));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&u.push(e),u},i.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,i=0,r=0,o=0,a=1/0,s=-(1/0),u=1/0,l=-(1/0);t.pos<e;){if(!i){var c=t.readVarint();n=7&c,i=c>>3}if(i--,1===n||2===n)r+=t.readSVarint(),o+=t.readSVarint(),a>r&&(a=r),r>s&&(s=r),u>o&&(u=o),o>l&&(l=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,u,s,l]},i.prototype.toGeoJSON=function(t,e,n){for(var r=this.extent*Math.pow(2,n),o=this.extent*t,a=this.extent*e,s=this.loadGeometry(),u=i.types[this.type],l=0;l<s.length;l++)for(var c=s[l],h=0;h<c.length;h++){var f=c[h],d=180-360*(f.y+a)/r;c[h]=[360*(f.x+o)/r-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}"Point"===u&&1===s.length?s=s[0][0]:"Point"===u?(s=s[0],u="MultiPoint"):"LineString"===u&&1===s.length?s=s[0]:"LineString"===u&&(u="MultiLineString");var p={type:"Feature",geometry:{type:u,coordinates:s},properties:this.properties};return"_id"in this&&(p.id=this._id),p}},{"point-geometry":148}],160:[function(t,e,n){"use strict";function i(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(r,this,e),this.length=this._features.length}function r(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(o(n))}function o(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}var a=t("./vectortilefeature.js");e.exports=i,i.prototype.feature=function(t){if(0>t||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,e,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":159}],161:[function(t,e,n){var i=arguments[3],r=arguments[4],o=arguments[5],a=JSON.stringify;e.exports=function(t){for(var e,n=Object.keys(o),s=0,u=n.length;u>s;s++){var l=n[s],c=o[l].exports;if(c===t||c["default"]===t){e=l;break}}if(!e){e=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var h={},s=0,u=n.length;u>s;s++){var l=n[s];h[l]=l}r[e]=[Function(["require","module","exports"],"("+t+")(self)"),h]}var f=Math.floor(Math.pow(16,8)*Math.random()).toString(16),d={};d[e]=e,r[f]=[Function(["require"],"var f = require("+a(e)+");(f.default ? f.default : f)(self);"),d];var p="("+i+")({"+Object.keys(r).map(function(t){return a(t)+":["+r[t][0]+","+a(r[t][1])+"]"}).join(",")+"},{},["+a(f)+"])",m=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(m.createObjectURL(new Blob([p],{type:"text/javascript"})))}},{}]},{},[14])(14)}),mapboxgl.accessToken="pk.eyJ1IjoiZ2JpZiIsImEiOiJjaW0xeXU1c3gwMG04dm1tNXB3cjJ3Zm12In0.8A2pUP_lgL19w4G5L0fDNw";var gb={},key,minYear=minYear||1968,maxYear=maxYear||2002,mapType=$("#mapType").val(),hexRadius=$("#hexRadius").val(),yearThreshold=$("#yearThreshold").val(),lastClickedPoint,map;map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/light-v8",center:[10,50],zoom:3,bearing:0,pitch:0,maxZoom:7.9}),map.addControl(new mapboxgl.Navigation),map.on("style.load",function(){key=$("#SpeciesSelect").val(),initMap()}),map.on("click",function(t){lastClickedPoint=t,selectFeatureAtPoint(lastClickedPoint)}),map.on("mousemove",function(t){map.getLayer("regression-fill-hover")&&map.featuresAt(t.point,{radius:0,layer:"regression"},function(t,e){map.getCanvas().style.cursor=!t&&e.length?"pointer":"",!t&&e.length?map.setFilter("regression-fill-hover",["==","id",e[0].properties.id]):map.setFilter("regression-fill-hover",["==","id",""])})}),noUiSlider.create(slider,{start:[minYear,maxYear],step:1,connect:!0,range:{min:1900,max:2016}}),slider.noUiSlider.on("update",function(t){document.getElementById("years").innerText=Math.floor(t[0])+" - "+Math.floor(t[1])}),slider.noUiSlider.on("change",function(t){minYear=Math.floor(t[0]),maxYear=Math.floor(t[1]),initMap(map)}),map.boxZoom.disable(),map.on("load",function(){function t(t){var e=l.getBoundingClientRect(),n=new mapboxgl.Point(t.clientX-e.left-l.clientLeft,t.clientY-e.top-l.clientTop);return n}function e(e){e.shiftKey&&0===e.button&&(map.dragPan.disable(),document.addEventListener("mousemove",n),document.addEventListener("mouseup",i),document.addEventListener("keydown",r),a=t(e))}function n(e){s=t(e),console.log(JSON.stringify(e.lngLat)),u||(u=document.createElement("div"),u.classList.add("boxdraw"),l.appendChild(u));var n=Math.min(a.x,s.x),i=Math.max(a.x,s.x),r=Math.min(a.y,s.y),o=Math.max(a.y,s.y),c="translate("+n+"px,"+r+"px)";u.style.transform=c,u.style.WebkitTransform=c,u.style.width=i-n+"px",u.style.height=o-r+"px"}function i(e){o([a,t(e)])}function r(t){27===t.keyCode&&o()}function o(t){document.removeEventListener("mousemove",n),document.removeEventListener("keydown",r),document.removeEventListener("mouseup",i),u&&(u.parentNode.removeChild(u),u=null),t&&customQuery(t),map.dragPan.enable()}var a,s,u,l=map.getCanvasContainer();l.addEventListener("mousedown",e,!0),map.on("mousemove",function(t){})}),$(".media").on("click",function(t){var e=$(this).data().key;e&&(key=e,$(".media").removeClass("isActive"),$(this).addClass("isActive"),initMap(map))});var species=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("canonicalName"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:"http://tiletest.gbif.org/autocomplete?prefix=a",remote:{url:"http://tiletest.gbif.org/autocomplete?prefix=%QUERY",wildcard:"%QUERY"}});$("#speciesTypeahead .typeahead").typeahead(null,{name:"species",display:function(t){return t.scientificName},source:species}),$("#speciesTypeahead .typeahead").bind("typeahead:select",function(t,e){key=e.speciesKey,$(".media").removeClass("isActive"),$("#speciesTypeahead").addClass("isActive"),$("#speciesTypeahead").data("key",key),initMap(map)}),$(".blanket__close").on("click",function(t){$(".blanket").hide(),t.preventDefault()}),$(".blanket__open").on("click",function(t){$(".blanket").show(),t.preventDefault()}),$(".storyline__close").on("click",function(t){$("main").addClass("mapFocus"),map.resize(),t.preventDefault()});
//# sourceMappingURL=script.js.map
